{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4f60\u597d~","text":"<p>\u8fd9\u91cc\u662f oldkingOK \u7684\u535a\u5ba2</p>"},{"location":"#_2","title":"\u5173\u4e8e","text":"<p>\u672c\u535a\u5ba2\u4f7f\u7528 jobindjohn/obsidian-publish-mkdocs \u6a21\u677f\u6784\u5efa</p> <p>\u56fe\u7247\u6765\u81ea pixiv by \u6797\u6a8e\u9162\u03c0</p>"},{"location":"#_3","title":"\u672c\u4ed3\u5e93","text":""},{"location":"#_4","title":"\u8bbe\u7f6e","text":"<ul> <li>\u2705 <code>Settings</code> - <code>Files &amp; links</code> - <code>Detect all file extensions</code> </li> <li><code>mkdocs.yml</code> - <code>markdown_extensions</code> - \u6dfb\u52a0 <code>- attr_list</code></li> </ul>"},{"location":"#_5","title":"\u4f7f\u7528\u7684\u63d2\u4ef6","text":"\u540d\u79f0 \u7528\u9014 \u5f00\u6e90\u534f\u8bae obsidian-omnisearch \u9ad8\u7ea7\u641c\u7d22 GPL-3.0 advanced-tables-obsidian \u7f16\u8f91\u8868\u683c GPL-3.0 obsidian-custom-attachment-location \u7ba1\u7406\u9644\u4ef6 \u65e0 denolehov/obsidian-git \u7248\u672c\u7ba1\u7406 MIT"},{"location":"#todo-list","title":"TODO List","text":"<ul> <li>TEA XTEA XXTEA \u7b97\u6cd5</li> <li>ELF\u76f8\u5173</li> <li>VMProtect</li> <li>Rust\u2014\u2014\u56fd\u8d5b\u9898\u76ee</li> <li>Go\u2014\u2014\u56fd\u8d5b\u9898\u76ee</li> <li>\u5b89\u5353\u2014\u2014\u914d\u7f6eJeb\u548c\u4e00\u952e\u5de5\u5177</li> <li>Frida+idapython\u89e3\u51b3\u63a7\u5236\u6d41\u5e73\u5766\u5316\u548cVM</li> </ul>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/","title":"\u73af\u5883\u914d\u7f6e","text":"<ul> <li>win10/11\u4e0bwsl2\u5b89\u88c5gpu\u7248\u7684pytorch\uff08\u907f\u5751\u6307\u5357\uff09 - \u77e5\u4e4e (zhihu.com)</li> <li>WSL2 \u5b89\u88c5 CUDA + PyTorch - \u77e5\u4e4e (zhihu.com)</li> </ul>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#-1-nvidia","title":"-1 Nvidia\u9a71\u52a8","text":"<p>Official Drivers | NVIDIA</p> <p>\u578b\u53f7\u8981\u5bf9\u5e94\u4e0a\uff0c\u4e0b\u8f7d\u9ed8\u8ba4 Game Ready Driver \u9a71\u52a8\u5373\u53ef</p>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#0-wsl","title":"0 WSL","text":"<pre><code>wsl --install Ubuntu-20.04\nsudo passwd\nsu\n/usr/lib/wsl/lib/nvidia-smi # \u67e5\u770b\u663e\u5361\u60c5\u51b5\n</code></pre> <p>\u7f16\u8f91 <code>~/.bashrc</code>\uff0c\u6dfb\u52a0 </p> <pre><code>export PATH=/usr/lib/wsl/lib:$PATH\n</code></pre>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#1-docker","title":"1 (\u53ef\u9009)Docker","text":"<pre><code>docker pull pytorch/pytorch\ndocker run -it -v E:\\Docker\\Chatglm:/chatglm pytorch/pytorch\napt update\napt install wget vim -y\n</code></pre> <p>docker\u914d\u7f6e\u6587\u4ef6\u5b58\u5728 <code>wsl$\\\\docker-desktop-data\\data\\docker\\containers</code></p>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#2-cuda","title":"2 CUDA","text":"<pre><code>wget https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-keyring_1.1-1_all.deb\ndpkg -i cuda-keyring_1.1-1_all.deb\napt update\napt install cuda-toolkit-12-4\n</code></pre> <p>\u7f16\u8f91 <code>~/.bashrc</code>\uff0c\u6dfb\u52a0</p> <pre><code>export PATH=/usr/local/cuda/bin:$PATH\nexport LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PAT\n</code></pre> <p>\u8fd0\u884c <code>nvcc -V</code> \u4f1a\u6709CUDA\u7248\u672c\u7684\u8f93\u51fa</p>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#3-pytorch","title":"3 PyTorch","text":"<pre><code>pip install python3-pip\npip install torch torchtext torchvision sentencepiece psutil future torchserve torch-model-archiver\n</code></pre>"},{"location":"AI/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/#4","title":"4 \u6a21\u578b","text":"<ul> <li>THUDM/chatglm3-6b-128k \u00b7 Hugging Face</li> <li>\u5982\u4f55\u4f7f\u7528\ud83e\udd17hugging face\u7684\u6a21\u578b\u5e93? - \u6398\u91d1 (juejin.cn)</li> </ul> <pre><code>pip install protobuf transformers==4.30.2 cpm_kernels torch&gt;=2.0 gradio mdtex2html sentencepiece accelerate\n</code></pre> <p>\u6ce8\uff1a\u53ef\u80fd\u547d\u4ee4\u592a\u957f\u4e86\uff0c\u76f4\u63a5\u6254\u8fdb\u53bb\u4f1a\u5361\u4f4f\uff0c\u53ef\u4ee5\u624b\u52a8\u5206\u4e00\u4e0b</p> <p>\u8f93\u5165 <code>python3</code> \u8fdb\u5165\u4ea4\u4e92\u6a21\u5f0f <pre><code>from transformers import AutoTokenizer, AutoModel\ntokenizer = AutoTokenizer.from_pretrained(\"THUDM/chatglm3-6b-128k\", trust_remote_code=True)\nmodel = AutoModel.from_pretrained(\"THUDM/chatglm3-6b-128k\", trust_remote_code=True) \nmodel.save_pretrained('./chatglm3') # \u5b58\u653e\nmodel = model.half().cuda()\nmodel = model.eval()\nresponse, history = model.chat(tokenizer, \"\u4f60\u597d\", history=[])\nprint(response)\n\u4f60\u597d\ud83d\udc4b!\u6211\u662f\u4eba\u5de5\u667a\u80fd\u52a9\u624b ChatGLM-6B,\u5f88\u9ad8\u5174\u89c1\u5230\u4f60,\u6b22\u8fce\u95ee\u6211\u4efb\u4f55\u95ee\u9898\u3002\nresponse, history = model.chat(tokenizer, \"\u665a\u4e0a\u7761\u4e0d\u7740\u5e94\u8be5\u600e\u4e48\u529e\", history=history)\nprint(response)\n</code></pre></p> <p>\u52a0\u8f7d\u6a21\u578b</p> <pre><code>model = AutoModel.from_pretrained('./chatglm3')\n</code></pre>"},{"location":"Topic%201/Note%201/","title":"Note 1","text":"<p>Example: link to Mermaid Diagrams under <code>Features</code></p>"},{"location":"Topic%201/Note%202/","title":"Note 2","text":""},{"location":"blog/","title":"Hi~","text":"<p>\u2764\ufe0f</p> <p></p>"},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/","title":"Hello obsidian","text":"","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_1","title":"\u4ece\u6a21\u677f\u521b\u5efa\u4ed3\u5e93","text":"<p>jobindjohn/obsidian-publish-mkdocs: A Template to Publish Obsidian/Foam Notes on Github Pages (uses MkDocs)</p>","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_2","title":"\u5e38\u89c1\u95ee\u9898","text":"","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_3","title":"\u5982\u4f55\u672c\u5730\u6784\u5efa\uff1f","text":"<p>Instructions to build locally using mkdocs \u00b7 Issue #1 \u00b7 jobindjohn/obsidian-publish-mkdocs (github.com)</p> <pre><code>python -m venv okblog\n./okblog/Scripts/activate\npip install -r requirements.txt\nmkdocs serve\n</code></pre>","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#requirementstxt","title":"requirements.txt","text":"<pre><code>mkdocs\nmkdocs-material\nmkdocs-mermaid2-plugin\nmkdocs-ezlinked-plugin\nmkdocs-awesome-pages-plugin\nmdx_breakless_lists\nmkdocs-preview-links-plugin\nmkdocs-embed-file-plugins\nMarkdown\nobs2mk\nmkdocs-roamlinks-plugin\nPyYAML\nsetuptools\n</code></pre>","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_4","title":"\u535a\u5ba2\u5fc5\u987b\u4ece\u6a21\u677f\u521b\u5efa","text":"<p>\u5373 <code>/blog/posts</code> \u91cc\u9762\u7684\u6587\u4ef6\u5fc5\u987b\u5e26\u6709 <code>Properties</code></p>","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_5","title":"\u5982\u4f55\u4fee\u6539\u9875\u9762\u5185\u5bb9","text":"<p>Customization - Material for MkDocs (squidfunk.github.io)</p>","tags":["how-to"]},{"location":"blog/2023/04/21/%E6%90%AD%E5%BB%BAObsidian%E5%8D%9A%E5%AE%A2%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/#_6","title":"\u5df2\u77e5\u95ee\u9898","text":"<ol> <li>\u56fe\u7247\u65e0\u6cd5\u8bbe\u5b9a\u5927\u5c0f<ul> <li>\u4f7f\u7528\u4ee3\u7801 <code>![PunalaJam](&lt;../Pulana2.jpg&gt;){ width=\"220\"; height=\"400\" }</code> \u672c\u5730\u53ef\u4ee5\u663e\u793a</li> <li>\u4f46\u662f\u90e8\u7f72\u4e4b\u540e\u4f1a\u663e\u793a <code>{ width=\"220\"; height=\"400\" }</code></li> <li>\u7136\u540e\u5927\u5c0f\u548c\u9875\u9762\u4e00\u6837\u5927</li> </ul> </li> </ol> <p>\u89e3\u51b3\u529e\u6cd5 python - mkdocs: how to attach a downloadable file - Stack Overflow</p> <p>\u5373\u4fee\u6539 <code>mkdocs.yml</code>,</p> <pre><code>markdown_extensions:\n  - attr_list\n</code></pre> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u7528\u4e86</p> <p>\u540c\u6837\u89e3\u51b3\u7684\u8fd8\u6709 <code>[file.ext](../static/file.ext){:download=\"\u6587\u4ef6\u540d.txt\"}</code> \u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u6587\u4ef6\u4e86</p> <p>\u4f8b\u5982\uff1a<code>[\u6837\u672c](./static/DebugMe.apk){:download=\"DebugMe.apk\"}</code></p> <p>\u8fd9\u91cc\u4f7f\u7528\u4e86 Python-Markdown \u7684\u7279\u6027</p>","tags":["how-to"]},{"location":"blog/2024/05/07/%E9%80%86%E5%90%91%E5%B7%A5%E4%BD%9C%E6%B5%81/","title":"\u5de5\u4f5c\u6d41","text":"<ol> <li><code>exp.py</code> \u7528\u4e8e\u542f\u52a8\u7a0b\u5e8f\u548c\u81ea\u52a8\u8f93\u5165\u6587\u672c</li> <li><code>ida_.py</code> \u7528\u4e8e\u6267\u884cida\u811a\u672c</li> </ol> <p>\u5728 <code>ida_.py</code> \u524d\u9762\u52a0\u4e0a\uff1a</p> <pre><code>import site; site.addsitedir('D:\\\\Program Files\\\\IDA_Pro_v8.3_Portable\\\\python\\\\3')\n</code></pre> <p>\u5c31\u53ef\u4ee5\u6709\u4ee3\u7801\u63d0\u793a\u4e86</p>","tags":["Reverse"]},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Compile/","title":"\u7f16\u8bd1","text":"<pre><code>gcc foo.c -o foo.o # \u9ed8\u8ba4\u2014\u2014\u52a8\u6001\u94fe\u63a5\u5e93\u7f16\u8bd1\ng++ test.cpp --static -o test # \u9759\u6001\u94fe\u63a5\u7f16\u8bd1\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Compile/#gcc","title":"gcc \u53bb\u6389\u7b26\u53f7\u8868","text":"<ul> <li>-s\uff1a\u53bb\u6389\u7b26\u53f7\u8868\u548c\u8c03\u8bd5\u4fe1\u606f\u3002</li> <li>-g\uff1a\u53ea\u53bb\u6389\u8c03\u8bd5\u4fe1\u606f\uff0c\u4fdd\u7559\u7b26\u53f7\u8868\u3002</li> <li>-N &lt;\u7b26\u53f7\u540d\u79f0&gt;\uff1a\u53bb\u6389\u6307\u5b9a\u7684\u7b26\u53f7</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Elang/","title":"\u6613\u8bed\u8a00","text":"<p>\u5206\u6790\u4e00\u822c\u9700\u8981\uff1a - E-decompiler IDA\u63d2\u4ef6#\u6613\u8bed\u8a00 - \u6613\u8bed\u8a00\u5728\u7ebf\u5e2e\u52a9\u624b\u518c \u6613\u8bed\u8a00\u77e5\u8bc6\u5e93 - \u6700\u65b0\u6613\u8bed\u8a00\u5728\u7ebf\u5e2e\u52a9\u624b\u518c (125.la)</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/FirmwareReverse/","title":"\u56fa\u4ef6\u9006\u5411","text":"<p>\u4e00\u822c\u4f1a\u7ed9\u50cf\u4e0b\u9762\u4e00\u6837\u7684\u56fa\u4ef6\u4e8c\u8fdb\u5236\u4fe1\u606f\u2014\u2014Intel hex\u6587\u4ef6</p> <p>Intel Hex\u6587\u4ef6\u662f\u4e00\u79cd\u7f16\u7801\u683c\u5f0f\uff0c\u7528\u4e8e\u5c06\u4e8c\u8fdb\u5236\u4fe1\u606f\u8f6c\u6362\u4e3a\u6587\u672c\u8bb0\u5f55\uff0c\u8fd9\u4e9b\u8bb0\u5f55\u53ef\u4ee5\u901a\u8fc7\u4e32\u884c\u901a\u4fe1\u6216\u5176\u4ed6\u63a5\u53e3\u4f20\u8f93\u5230\u5fae\u63a7\u5236\u5668\u7b49\u8bbe\u5907\u4e0a\u3002</p> <pre><code>:020000040000FA\n:100000000C9434000C9446000C9446000C9446006A\n:100010000C9446000C9446000C9446000C94460048\n:100020000C9446000C9446000C9446000C944F002F\n:100030000C9446000C9446000C9446000C94460028\n:100040000C9446000C9446000C9446000C94460018\n:100050000C9446000C9446000C9446000C94460008\n...\n:107FA0009093C60008958091C00087FFFCCF809118\n:107FB000C00084FD01C0A8958091C6000895E0E648\n:107FC000F0E098E1908380830895EDDF803219F02E\n:107FD00088E0F5DFFFCF84E1DECF1F93182FE3DFCA\n:107FE0001150E9F7F2DF1F91089580E0E8DFEE27F6\n:047FF000FF270994CA\n:027FFE00040479\n:00000001FF\n</code></pre> <p>DIE\u662f\u65e0\u6cd5\u67e5\u5230\u7684\uff0c\u76f4\u63a5\u62d6\u8fdbIDA\u53ef\u4ee5\u770b\u5230\u662f <code>Intel Hex</code>\uff0cIDA\u53ef\u4ee5\u53cd\u6c47\u7f16\u5927\u591a\u6570\u7684\u82af\u7247\u67b6\u6784\uff0c\u6240\u4ee5\u96be\u70b9\u5728\u4e8e\u8bc6\u522b\u51fa\u662f\u4ec0\u4e48\u67b6\u6784</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/FirmwareReverse/#0c94","title":"\u51fa\u73b0\u91cd\u590d\u7684 <code>0C94</code>","text":"<p><code>0C94</code> \u662fAVR\u67b6\u6784\u7684\u8df3\u8f6c\u6307\u4ee4</p> <p>IDA\u4e2d\u5bf9\u5e94 <code>Atmel AVR</code></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/FirmwareReverse/#stm32","title":"\u5982\u679c\u9898\u76ee\u63d0\u793a\u662fstm32","text":"<p>\u5c31\u662f ARMv7-M\uff08\u53c2\u8003\uff1aSTM32\u2014\u2014IDA\u53cd\u7f16\u8bd1 Hex/Bin\u6587\u4ef6\u6210C\u4ee3\u7801\uff09</p> <p></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/FirmwareReverse/#microbit","title":"\u4e5f\u6709\u53ef\u80fd\u662f Micro:bit","text":"<p>\u6254\u8fdb\u5b98\u65b9\u7684\u7f51\u7ad9\uff08\u53c2\u8003\uff1aGalaxians CTF | LEDs (shiltemann.github.io)\uff09</p> <ul> <li>\u56fe\u5f62\u5316\u7f16\u7a0b Microsoft MakeCode for micro:bit (microbit.org)</li> <li>MicroPython\u7f16\u7a0b micro:bit Python Editor (microbit.org)</li> </ul> <p>\u4e24\u4e2a\u90fd\u53ef\u4ee5\u8bd5\u8bd5</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/FirmwareReverse/#_2","title":"\u53e6\u5916","text":"<p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u5355\u7247\u673a\u6a21\u62df\u5668\uff0c\u770b\u8d77\u6765\u5f88\u4e0d\u9519</p> <p>Wokwi - Online ESP32, STM32, Arduino Simulator</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/","title":"Linux\u7684\u4e00\u4e9b\u77e5\u8bc6","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#_2","title":"\u7f51\u7edc","text":"<pre><code>tcpdump # \u6293\u5305\u5de5\u5177\niptables # \u914d\u7f6e\u7f51\u7edc\uff0c\u6bd4\u5982\u8bbe\u7f6e\u6d41\u91cf\u8f6c\u53d1\nss -up # netstat\u7684\u5347\u7ea7\u7248\uff0c\u67e5\u770b\u7aef\u53e3\u4f7f\u7528\u60c5\u51b5\uff0cu\u662fudp\uff0cp\u662f\u67e5\u770b\u8fdb\u7a0b\ntraceroute # \u8ffd\u8e2a\u6570\u636e\u5305\u5728\u7f51\u7edc\u4e0a\u7684\u4f20\u8f93\u8def\u5f84\nip addr # \u67e5\u770b\u672c\u673aip\n\napt install ncat # \u7528\u6765\u7b80\u5355\u6d4b\u8bd5tcp\u3001udp\u7684\u8fde\u63a5\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#_3","title":"\u6587\u4ef6","text":"<pre><code>file &lt;\u6587\u4ef6&gt; # \u7528\u6765\u8bc6\u522b\u6587\u4ef6\u7c7b\u578b\uff0c\u4e5f\u53ef\u7528\u6765\u8bc6\u522b\u6587\u4ef6\u7684\u7f16\u7801\u683c\u5f0f\nreadelf &lt;\u6587\u4ef6&gt; # \u7528\u6765\u663e\u793a\u4e00\u4e2a\u6216\u8005\u591a\u4e2aelf\u683c\u5f0f\u7684\u76ee\u6807\u6587\u4ef6\u7684\u4fe1\u606f\nstat &lt;\u6587\u4ef6&gt; # \u67e5\u770b\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\ntail -f &lt;\u6587\u4ef6&gt; # \u4e00\u822c\u7528\u6765\u770b\u65e5\u5fd7\uff0c\u8ddf\u968f\u6587\u4ef6\u7684\u66f4\u65b0\nless &lt;\u6587\u4ef6&gt; # \u4ece\u5934\u5f00\u59cb\u770b\u6587\u4ef6\uff0c\u4ee5vim\u7684\u64cd\u4f5c\u65b9\u5f0f\nmore &lt;\u6587\u4ef6&gt; # \u4e5f\u662f\u4ece\u5934\u5f00\u59cb\u770b\u6587\u4ef6\uff0c\u4f46\u53ea\u80fd\u4ece\u4e0a\u5f80\u4e0b\u770b\uff0c\u770b\u5b8c\u4e86\u81ea\u52a8\u9000\u51fa\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#lsof","title":"lsof","text":"<p>\uff08List open files\uff09\u7528\u4e8e\u5217\u51fa\u5f53\u524d\u7cfb\u7edf\u4e2d\u8fdb\u7a0b\u6253\u5f00\u7684\u6240\u6709\u6587\u4ef6\u7684\u547d\u4ee4</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#find","title":"find","text":"<pre><code>find / -mtime +3 -type f -print # \u4e09\u5929\u201c\u4ee5\u524d\u201d\u6539\u8fc7\u7684\u6587\u4ef6\nfind / -mtime -3 -type f -print # \u4e09\u5929\u201c\u5185\u201d\u6539\u8fc7\u7684\u6587\u4ef6\nfind / -type f -newermt '2024-2-10' ! -newermt '2024-04-25' # \u6307\u5b9a\u65f6\u95f4\n</code></pre> <ul> <li><code>-type f</code> \u6307\u6587\u4ef6</li> <li><code>ctime</code> c:change</li> <li>ctime\u53c2\u6570\u6307\u6587\u4ef6\u65e5\u671f\u7b49\u72b6\u6001\u6027\u53c2\u6570\u4fee\u6539\uff0cmtime\u53c2\u6570\u6307\u5185\u5bb9\u6539\u53d8</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#_4","title":"\u4e8c\u8fdb\u5236\u5206\u6790","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#strace","title":"strace","text":"<pre><code>strace -o xx.log &lt;\u547d\u4ee4&gt; # \u8ffd\u8e2a\u7cfb\u7edf\u8c03\u7528\u8fc7\u7a0b\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#_5","title":"\u5b9a\u65f6\u4efb\u52a1","text":"<pre><code>cron\ncrontab\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#xargs","title":"xargs","text":"<p>\u6709\u4e9b\u547d\u4ee4\u4e0d\u652f\u6301\u7ba1\u9053\u7b26\u8f93\u5165\uff0c\u5c31\u53ef\u4ee5\u7528 xargs \u628a\u7ba1\u9053\u7b26\u5de6\u8fb9\u7684\u5185\u5bb9\u5f53\u4f5c\u53c2\u6570\u8f93\u5165\u5230\u53f3\u8fb9\u7684\u547d\u4ee4</p> <pre><code>find . -name \"*.txt\" | xargs file\nfind . -type f | xargs grep \"wisher_GUI\" # type f \u6587\u4ef6\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Linux/#linux_1","title":"Linux\u54f2\u5b66","text":"<p>\u4e00\u5207\u7686\u6587\u4ef6 Everything is a file</p> <p>Linux\u5185\u6838\uff1a\u8fdb\u7a0b\u7ba1\u7406\u2014\u2014\u8fdb\u7a0b\u6587\u4ef6\u7cfb\u7edf /proc\u8be6\u89e3 - \u77e5\u4e4e (zhihu.com)</p> <p>\u6bd4\u5982\u6bcf\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u5c31\u4f1a\u663e\u793a\u4e3a <code>/proc</code> \u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u4ee5\u8fdb\u7a0b\u7684 <code>pid</code> \u547d\u540d\uff0c\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\uff08\u8fde\u63a5\u4e5f\u4f1a\u8868\u793a\u4e3a\u6587\u4ef6\uff09\u4f1a\u653e\u5728 <code>/proc/&lt;pid&gt;/fd</code>\uff0c\u8f6f\u94fe\u63a5\u5230\u771f\u6b63\u7684\u6587\u4ef6</p> <p></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/","title":"\u7f16\u8bd1\u5668\u5bf9\u53d6\u4f59\u548c\u9664\u6cd5\u8fd0\u7b97\u7684\u4f18\u5316","text":"<p>2024-04-11</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#_2","title":"\u73af\u5883","text":"<ul> <li>CompilerExplorer</li> <li>x64 msvc v19.35</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#_3","title":"\u6982\u8ff0","text":"<p>\u770b\u5230\u5947\u602a\u7684\u4f4d\u8fd0\u7b97\u3001\u9b54\u6570\uff0c\u5c31\u8003\u8651\u6c42\u4f59\u548c\u9664\u6cd5</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#_4","title":"\u77e5\u8bc6\u70b9","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#1","title":"1. \u7b97\u6570\u53f3\u79fb\u548c\u903b\u8f91\u53f3\u79fb","text":"<p>\u53c2\u8003</p> <p>\u6c47\u7f16\u8bed\u8a00\u4e2dSAR\u548cSHR\u6307\u4ee4\u90fd\u662f\u53f3\u79fb\u6307\u4ee4\uff0cSAR\u662f\u7b97\u6570\u53f3\u79fb\u6307\u4ee4\uff08shift arithmetic right\uff09\uff0c\u800cSHR\u662f\u903b\u8f91\u53f3\u79fb\u6307\u4ee4\uff08shift logical right\uff09\u3002</p> <p>\u4e24\u8005\u7684\u533a\u522b\u5728\u4e8eSAR\u53f3\u79fb\u65f6\u4fdd\u7559\u64cd\u4f5c\u6570\u7684\u7b26\u53f7\uff0c\u5373\u7528\u7b26\u53f7\u4f4d\u6765\u8865\u8db3\uff0c\u800cSHR\u53f3\u79fb\u65f6\u603b\u662f\u75280\u6765\u8865\u8db3\u3002</p> <p>\u4f8b\u598210000000\u7b97\u6570\u53f3\u79fb\u4e00\u4f4d\u662f11000000\uff0c\u800c\u903b\u8f91\u53f3\u79fb\u4e00\u4f4d\u662f01000000\u3002</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#2-cint","title":"2. C\u6807\u51c6\u7684int","text":"<p><code>#include&lt;stdint.h&gt;</code> \u5c31\u53ef\u4ee5\u4f7f\u7528\u5404\u79cdint\u7c7b\u578b</p> <p>\u6ce8\u610f\uff1a<code>long long int</code> \u624d\u662f64\u4f4d\u7684\uff0c <code>long int</code> \u548c <code>int</code>\u76f8\u540c\uff0c\u5373 <code>%lld</code> \u624d\u662f64\u4f4d</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#3-magic-number","title":"3. \u6c42\u4f59\u7684\u4f18\u5316\u2014\u2014\u751f\u6210Magic Number","text":"<p>\u5c0f\u77e5\u8bc6\uff1a\u53d6\u6a21!=\u53d6\u4f59</p> <p>\u4e3b\u8981\u533a\u522b\u4e8e\u8d1f\u6570Mod</p> <p>\u8fdb\u884c\u6c42\u6a21\u8fd0\u7b97\u65f6\uff1a<code>c = [a/b] = -7 / 4 = -2</code>\uff08\u5411\u8d1f\u65e0\u7a77\u65b9\u5411\u820d\u5165\uff09\uff0c</p> <p>\u8fdb\u884c\u6c42\u4f59\u8fd0\u7b97\u65f6\uff1a<code>c = [a/b] = -7 / 4 = -1</code>\uff08\u54110\u65b9\u5411\u820d\u5165\uff09\uff1b</p> <p>\u6c42\u6a21\u65f6\uff1ar = a - cb =-7 - (-2)4 = 1\uff0c</p> <p>\u6c42\u4f59\u65f6\uff1ar = a - cb = -7 - (-1)4 =-3\u3002</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#12n","title":"1\uff09\u5f53\u6a21\u6570\u4e3a2\u7684N\u6b21\u5e42","text":"<p>\u65e0\u7b26\u53f7\u6570\u5f88\u7b80\u5355\uff0c\u53f3\u79fbN\u4f4d\u5373\u53ef</p> <p>\u6709\u7b26\u53f7\u6570\u6bd4\u8f83\u590d\u6742</p> <ol> <li> <p>\u903b\u8f91\u4e0e\u2014\u2014\u4fdd\u7559N\u4e2a\u4f4e\u4f4d\u548c\u7b26\u53f7\u4f4d     \u6bd4\u5982 Mod 4     <pre><code>int tmp = i &amp; 0x8000000C\n</code></pre></p> </li> <li> <p>\u81ea\u51cf\u4e00</p> </li> <li>\u903b\u8f91\u6216\u2014\u2014\u4fdd\u7559N\u4e2a\u4f4e\u4f4d\u7684\u503c\uff0c\u5176\u4ed6\u90fd\u8d4b\u503c1</li> <li>\u81ea\u52a0\u4e00</li> </ol> <p>\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>int mod(int a)\n{\n    int tmp = a &amp; 0x80000003;\n    if (tmp &gt;= 0) return tmp;\n    tmp--;\n    tmp = tmp | -4;\n    tmp++;\n    return tmp;\n}\n</code></pre> <p>\u8fd9\u91cc\u548c\u674e\u5e08\u5085\u8ba8\u8bba\u4e86\u4e00\u4e0b\uff0c\u3010\u81ea\u51cf\u4e00\u3011\u548c\u3010\u81ea\u52a0\u4e00\u3011\u53ea\u4f1a\u5f71\u54cd\u8fb9\u7f18\u503c\uff0c\u6bd4\u5982 <code>-4 Mod -4</code></p> <p><code>-4</code> \u662f <code>0b11...1100</code>\uff0c\u3010\u51cf\u51cf\u3011\u548c\u3010\u6216\u3011\u4e4b\u540e\uff0c\u4f1a\u53d8\u6210 <code>0b11...1111</code>\uff0c</p> <p>\u6b64\u65f6\u3010\u52a0\u52a0\u3011\u5c31\u4f1a\u5f97\u52300</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/ModAndDiv/#22","title":"2\uff09\u975e2\u6b21\u5e42","text":"<p>\u6c47\u7f16\u8bed\u8a00IMUL\u6307\u4ee4\uff1a\u6709\u7b26\u53f7\u6570\u4e58\u6cd5</p> <p>\u3010PDF\u3011DivcMore\u2014\u2014\u6765\u6e90</p> <p>\u3010\u77e5\u4e4e\u3011\u3010\u7f16\u8bd1\u7b14\u8bb0\u3011\u53d8\u91cf\u9664\u4ee5\u5e38\u91cf\u7684\u4f18\u5316\uff08\u4e00\uff09\u2014\u2014\u65e0\u7b26\u53f7\u9664\u6cd5</p> <p>\u77e5\u4e4e\u6709\u4e2a\u5f88\u7cbe\u5f69\u7684\u5b9a\u7406\u8bc1\u660e\uff0c\u9700\u8981\u518d\u6b21\u7ec6\u770b</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Python/","title":"Python\u6c99\u7bb1\u9003\u9038","text":"<ol> <li>inspect</li> <li>frame</li> <li>dis.dis</li> <li>sys</li> <li>object</li> </ol> <pre><code>popen = object.__subclasses__()[351]\ndef run_cmd(cmd):\n    print(popen(cmd,shell=True,stdout=-1).communicate()[0].decode())\n\n__builtins__ = popen.__init__.__globals__.get('__builtins__')\nopen = __builtins__.get('open')\n__import__ = __builtins__.get('__import__')\n\nsys = __import__('sys')\napp_main = sys.modules['__main__']\n\ncompile = __builtins__.get('compile')\nStringIO = __import__('io').StringIO\ndis = __import__('dis')\ninspect = __import__('inspect')\nthreading = __import__('threading')\n\ndef print_f_code(f_code):\n    i = StringIO()\n    dis.dis(f_code, file=i)\n    print(i.getvalue())\n\ndef get_top_frame(frame):\n    while frame.f_back:\n        print(frame)\n        frame = frame.f_back\n    return frame.f_code\n\nmain_thread = threading.enumerate()[0]\nframe = sys._current_frames().get(main_thread.ident, None)\nprint(print_f_code(get_top_frame(frame)))\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/PythonMD5/","title":"Python \u7248\u672c\u5dee\u5f02\u5bfc\u81f4\u7684MD5\u4e0d\u540c","text":"<p>python\u7248\u672c\u5751:md5\u4f8b\u5b50(python2\u4e0epython3\u4e2dmd5\u533a\u522b) / \u5f20\u751f\u8363 (zhangshengrong.com)</p> <pre><code>\"aaa\".encode(\"latin1\")\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Shell/","title":"\u58f3","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/Shell/#upx","title":"upx\u58f3","text":"<p>\u4e00\u822c\u53ef\u4ee5\u76f4\u63a5 <code>upx -d</code>\uff0c\u5982\u679c\u4e0d\u884c\uff0c\u5c31\u627e\u4e2a\u6b63\u5e38\u7684\u7a0b\u5e8f</p> <pre><code>upx hello.exe -o hello_upx.exe\n</code></pre> <p>\u6bd4\u8f83\u4e00\u4e0b\uff0c\u76ee\u524d\u53d1\u73b0\u7684\u9898\u76ee\u6709\uff1a</p> <ul> <li>\u628a\u6bb5\u540d\u6539\u6210VMP0\u548cVMP1</li> <li>\u628aUPX\u6539\u6210upx</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/SomeAsm/","title":"\u5e38\u89c1\u7591\u96be\u6742\u6c47\u7f16\u6307\u4ee4","text":"<p>2024-04-13</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/SomeAsm/#imul-mul","title":"imul \u548c mul","text":"<p>\u6c47\u7f16\u8bed\u8a00IMUL\u6307\u4ee4\uff1a\u6709\u7b26\u53f7\u6570\u4e58\u6cd5</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/SomeAsm/#idiv-div","title":"idiv \u548c div","text":"<p>\u5355\u64cd\u4f5c\u6570\uff0c\u53ea\u80fd\u4f20\u5165\u5bc4\u5b58\u5668</p> <ul> <li>\u9664\u6570\u662fBYTE,\u88ab\u9664\u6570\u5b58\u4e8eAX,\u5546\u5b58\u653e\u5728AL,\u4f59\u6570\u653e\u5728AH</li> <li>\u9664\u6570\u662fWORD,\u88ab\u9664\u6570\u5b58\u4e8eDX:AX,\u5546\u5b58\u653e\u5728AX,\u4f59\u6570\u653e\u5728DX</li> <li>\u9664\u6570\u662fDWORD,\u88ab\u9664\u6570\u5b58\u4e8eEDX:EAX,\u5546\u5b58\u653e\u5728EAX,\u4f59\u6570\u653e\u5728EDX</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/SomeAsm/#_2","title":"\u6c47\u7f16\u6d4b\u8bd5","text":"<pre><code>lea     rax, [rbp+var_4] ; Load Effective Address\nmov     rdx, rax\nlea     rax, Format     ; Load Effective Address\nmov     rcx, rax        ; Format\ncall    scanf           ; Call Procedure\nmov     eax, [rbp+var_4]\nmov     edx, eax\nmov     ecx, 3\nidiv    ecx             ; Signed Divide\n</code></pre> <p>\u6267\u884c\u7a0b\u5e8f\uff0c\u8f93\u5165\u5b57\u7b26\uff0c\u56de\u8f66\u2014\u2014\u7a0b\u5e8f\u5361\u6b7b</p> <p>\u4f7f\u7528ida\u8c03\u8bd5\uff0c\u8fd0\u884c\u5230 <code>idiv</code> \u7684\u65f6\u5019\u62a5\u9519\uff1aInteger overflow</p> <p>\u67e5\u9605\u8d44\u6599\uff1a</p> <p>You're actually dividing a 128-bit number in RDX:RAX by RCX. So if RDX is uninitialized the result will likely be larger than 64-bits, resulting in an overflow exception. Try adding a CQO before the division to sign-extend RAX into RDX.</p> <p>\u6765\u6e90</p> <p>\u610f\u601d\u662f\u505a\u9664\u6cd5\u4e4b\u524d\uff0c\u8981\u5148\u7b26\u53f7\u6269\u5c55</p> <p>\u53c2\u8003\uff1a\u3010CSDN\u3011\u6c47\u7f16\u8bed\u8a00\u7b26\u53f7\u6269\u5c55\u6307\u4ee4\u53ca\u5e94\u7528\u793a\u4f8b</p> <p>\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u89c2\u5bdf\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u53d1\u73b0 <code>idiv ecx</code> \u7684\u65f6\u5019\uff0c<code>edx = 3</code>, <code>eax = 3 ; \u5c31\u662f\u8f93\u5165\u7684\u503c</code></p> <p>\u7531\u4e8e\u8ba1\u7b97\u673a\u8fd0\u7b97\u7684\u662f <code>EDX:EAX / ECX</code>\uff0c\u5373 <code>0x300000003 / 3 = 0x100000001</code>\uff0c\u5df2\u7ecf\u8d85\u8fc7\u4e86 <code>EAX</code> \u8303\u56f4\uff0c\u6240\u4ee5\u5bfc\u81f4\u6ea2\u51fa</p> <p>\u6240\u4ee5\u8981\u5148\u521d\u59cb\u5316\u9ad8\u4f4d\u5bc4\u5b58\u5668\uff0c\u5373\u201c\u7b26\u53f7\u6269\u5c55\u201d\u2014\u2014\u6b63\u6570\u5c31\u586b\u5145\u9ad8\u4f4d\u5bc4\u5b58\u5668\u4e3a0\uff1b\u8d1f\u6570\u5c31\u586b\u51451</p> <p>\u7b26\u53f7\u6269\u5c55\u6307\u4ee4\u8868</p> <ol> <li> <p>CBW\uff08Convert Byte to Word\uff09</p> <p>AL \u6269\u5c55\u5230 AX 2. CWD\uff08Convert Word to Doubleword\uff09</p> <p>AX \u6269\u5c55\u5230 DX:AX 3. CDQ\uff08Convert Doubleword to Quadword\uff09</p> <p>EAX \u6269\u5c55\u5230 EDX:EAX 4. CQO\uff08Convert Quadword to \uff09</p> <p>RAX \u6269\u5c55\u5230 RDX:RDX \uff0864\u4f4d\u673a\u5668\u4e13\u7528\uff09 5. CWDE\uff08Convert Word to Doubleword\uff09</p> <p>\u8fd9\u4e2a <code>E(Extension)</code> \u6307\u76f8\u5bf9\u4e8eCWD\u7684\u6269\u5c55\uff0c\u5c06AX\u6269\u5c55\u5230EAX 6. CDQE\uff08Convert Doubleword to Quadword\uff09</p> <p>EAX\u6269\u5c55\u5230RAX 7. MOVZX</p> <p>\u6307\u4ee4\u5c06\u6e90\u64cd\u4f5c\u6570\u7684\u5185\u5bb9\u590d\u5236\u5230\u76ee\u7684\u64cd\u4f5c\u6570\u4e2d\uff0c\u5e76\u5c06\u8be5\u503c\u96f6\u6269\u5c55\u81f316\u4f4d\u621632\u4f4d\u3002\u8be5\u6307\u4ee4\u4ec5\u9002\u7528\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\u3002</p> <p>\u56e0\u4e3aMOV\u6307\u4ee4\u4e0d\u80fd\u5c06\u4e00\u4e2a\u8f83\u5c0f\u7684\u64cd\u4f5c\u6570\u590d\u5236\u5230\u4e00\u4e2a\u8f83\u5927\u7684\u64cd\u4f5c\u6570\u3002 8. MOVSX</p> <p>\u6307\u4ee4\u5c06\u6e90\u64cd\u4f5c\u6570\u7684\u5185\u5bb9\u590d\u5236\u5230\u76ee\u7684\u64cd\u4f5c\u6570\u4e2d\uff0c\u5e76\u5c06\u8be5\u503c\u7b26\u53f7\u6269\u5c55\u81f316\u4f4d\u621632\u4f4d\u3002\u8be5\u6307\u4ee4\u4ec5\u9002\u7528\u4e8e\u6709\u7b26\u53f7\u6574\u6570\u3002</p> </li> </ol>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/WebAssembly/","title":"WebAssembly\u9006\u5411","text":"<p>\u76f8\u5f53\u4e8e\u76f4\u63a5\u8fd0\u884c\u5b57\u8282\u7801</p> <pre><code>...\n(local $var86 i64)\n(local $var87 i64)\n(local $var88 i64)\n(local $var89 i64)\n(local $var90 i64)\n(local $var91 i64)\n(local $var92 i64)\nlocal.get $var0\ni32.const 36\ni32.add\nlocal.tee $var8\n...\n</code></pre> <p>\u5d4c\u5165\u5728\u7f51\u9875\u4e2d\u7684\u5b57\u8282\u7801\uff0c\u7528F12\u5c31\u53ef\u4ee5\u770b\u5230 <code>*.wasm</code></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/WebAssembly/#flag","title":"\u5230\u8fbe\u6307\u5b9a\u5206\u6570\u7ed9flag","text":"<p>\u7528 Cetus \u626b\u5185\u5b58\uff0c\u7c7b\u4f3c\u4e8e CheatEngine\uff08\u641c\u7d22 <code>cheatengine for wasm</code> \u641c\u5230\u7684 \uff09</p> <p>\u9488\u5bf9 Wasm \u7684\u641c\u5185\u5b58\u5de5\u5177</p> <p></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/WebAssembly/#_1","title":"\u9700\u8981\u5206\u6790\u4ee3\u7801\u903b\u8f91","text":"<p>Webassembly\u9006\u5411\u624b\u6cd5 - \u5148\u77e5\u793e\u533a (aliyun.com)</p> <p>wat\u662f\u6587\u672c\u6587\u4ef6\uff0cwasm\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6d4f\u89c8\u5668\u53ef\u4ee5\u76f4\u63a5\u770b wasm \u662f\u56e0\u4e3a\u81ea\u5e26 wasm2wat\uff0c\u5373WebAssembly/wabt: The WebAssembly Binary Toolkit (github.com) \u4e2d\u7684\u7a0b\u5e8f</p> <ul> <li>wat2wasm: translate from\u00a0WebAssembly text format\u00a0to the\u00a0WebAssembly binary format</li> <li>wasm2wat: the inverse of wat2wasm, translate from the binary format back to the text format (also known as a .wat)</li> <li>wasm-objdump: print information about a wasm binary. Similiar to objdump.</li> <li>wasm-interp: decode and run a WebAssembly binary file using a stack-based interpreter</li> <li>wasm-decompile: decompile a wasm binary into readable C-like syntax.</li> <li>wat-desugar: parse .wat text form as supported by the spec interpreter (s-expressions, flat syntax, or mixed) and print \"canonical\" flat format</li> <li>wasm2c: convert a WebAssembly binary file to a C source and header</li> <li>wasm-strip: remove sections of a WebAssembly binary file</li> <li>wasm-validate: validate a file in the WebAssembly binary format</li> <li>wast2json: convert a file in the wasm spec test format to a JSON file and associated wasm binary files</li> <li>wasm-stats: output stats for a module</li> <li>spectest-interp: read a Spectest JSON file, and run its tests in the interpreter</li> </ul>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/WebAssembly/#_2","title":"\u9006\u5411","text":"<ol> <li>\u7528 wasm2c\uff0c\u53d8\u6210c\u4ee3\u7801\u4e4b\u540e\uff0c\u518dgcc\u7f16\u8bd1\uff0c\u6254\u8fdbida\u5206\u6790</li> <li>\u628awasm\u62d6\u8fdbJeb\u91cc\u5206\u6790</li> <li>\u7528\u6d4f\u89c8\u5668\u81ea\u5e26\u7684\u52a8\u6001\u8c03\u8bd5</li> </ol>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E5%8F%8D%E8%B0%83%E8%AF%95/","title":"\u53cd\u53cd\u8c03\u8bd5","text":"<p>\u67e5\u770b <code>exit()</code> \u7684\u4ea4\u53c9\u5f15\u7528</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L1.%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","title":"L1.\u4ec0\u4e48\u662f\u64cd\u4f5c\u7cfb\u7edf","text":"<p>2024-04-22</p> <p></p> <p></p> <p>\\</p> <p></p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L1.%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#_1","title":"\u64cd\u4f5c\u7cfb\u7edf\u8981\u5b66\u4ec0\u4e48\uff1f","text":"<p> \u7ed9\u4e00\u4e2a\u786c\u4ef6\u624b\u518c\uff0c\u914d\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L1.%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#_2","title":"\u8bfe\u7a0b\u76ee\u6807\uff1a\u80fd\u6539\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u8fd9\u516b\u4e2a\u5b9e\u9a8c\u4e00\u5b9a\u8981\u8ba4\u771f\u505a</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L1.%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#_3","title":"\u522b\u7684\u5b66\u751f\u5728\u5e72\u4ec0\u4e48","text":"<p>\u8fd9\u56db\u4e2a\u5b9e\u9a8c\u867d\u7136\u73b0\u5728\u770b\u4e0d\u61c2\uff0c\u5e0c\u671b\u672a\u6765\u53ef\u4ee5\u89e3\u51b3</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L1.%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#_4","title":"\u4e3b\u65e8\uff1a\u52a8\u624b\u5b9e\u8df5\u4e00\u4e2a\u771f\u5b9e\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u7edd\u77e5\u6b64\u4e8b\u8981\u8eac\u884c</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/","title":"L2.\u63ed\u5f00\u94a2\u7434\u7684\u76d6\u5b50","text":"<p>2024-04-22</p> <p>Open the OS!</p> <pre><code>graph LR\n    A[APP] --&gt; B[OS];\n    B --&gt; C[\u786c\u4ef6];</code></pre> <p>printf\u80cc\u540e\u7684\u539f\u7406\u662f\u4ec0\u4e48\uff1f</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#_1","title":"\u4ece\u54ea\u91cc\u5f00\u59cb","text":"<p>\u5b9e\u9a8c\u4e00\uff1a\u5982\u4f55\u63a7\u5236\u8fd9\u4e2a\u753b\u9762\uff1f</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#_2","title":"\u4ece\u767d\u7eb8\u5230\u56fe\u7075\u673a","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#_3","title":"\u4ece\u56fe\u7075\u673a\u5230\u901a\u7528\u56fe\u7075\u673a","text":"<p>\u6838\u5fc3\uff1a\u8bbe\u7f6e\u63a7\u5236\u5668\u52a8\u4f5c\u7684\u4e1c\u897f\u2014\u2014\u7f16\u7801\u2014\u2014\u83dc\u8c31\u2014\u2014\u89c4\u5b9a\u83dc\u600e\u4e48\u505a\u51fa\u6765</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#_4","title":"\u4ece\u901a\u7528\u56fe\u7075\u673a\u5230\u8ba1\u7b97\u673a","text":"<p>Instruction Pointer \u6307\u4ee4\u6307\u9488</p> <p></p> <p>\u5f88\u91cd\u8981\u7684\u4e00\u5f20\u56fe\uff0c\u8d2f\u7a7f\u64cd\u4f5c\u7cfb\u7edf</p> <p>\u8ba1\u7b97\u673a\u662f\u600e\u4e48\u5de5\u4f5c\u7684\uff1f\u53d6\u6307\u6267\u884c</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#ip","title":"\u6253\u5f00\u7535\u6e90\uff0cIP=\uff1f","text":"<p>BIOS: Basic Input Output System</p> <pre><code>CS &lt;&lt; 4 + IP\n</code></pre> <p>\u4e00\u4e2a\u6247\u533a 512 \u4e2a\u5b57\u8282\uff0c\u8bfb\u5165 <code>0x7c00</code></p> <p>0\u78c1\u90530\u6247\u533a\u662f\u5f15\u5bfc\u6247\u533a\u2014\u2014\u7b2c\u4e00\u6bb5\u4ee3\u7801</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#0x7c00","title":"0x7c00\u5904\u5b58\u653e\u7684\u4ee3\u7801","text":"<p>C\u8bed\u8a00\u4e0d\u80fd\u51b3\u5b9a\u5185\u5b58\u7684\u5177\u4f53\u4f4d\u7f6e</p> <p>\u800c\u6c47\u7f16\u53ef\u4ee5\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u5b8c\u6574\u7684\u63a7\u5236</p> <pre><code>mov ax, #BOOTSEG\nmov ds, ax ; ds=7c0h\nmov ax, #INITSEG\nmov es, ax ; es=9000h\nmov cx, #256\nsub si, si ; = 0, ds:si = 7c00h\nsub di, di ; = 0, es:di = 9000h\nrep movw ; \u5c06 0x07c00 \u5904\u7684256\u4e2a\u5b57\u79fb\u52a8\u52300x90000\u5904\uff0c\u817e\u51fa\u7a7a\u95f4\u7528\u6765\uff1f\njmpi go, INITSEG ; cs:ip\n</code></pre>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#jmpi-go-initseg","title":"jmpi go, INITSEG","text":"<p>\u4e00\u5b9a\u8981==\u6293\u4f4f\u4e3b\u7ebf==\u2014\u2014\u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u7684\u4ee3\u7801\u592a\u8fc7\u5e9e\u5927</p> <p><code>es:bx</code> \u5c31\u51b3\u5b9a\u4e86\u8bfb\u5230\u54ea\u91cc</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#setupok_load_setup","title":"\u8bfb\u5165setup\u6a21\u5757\u540e\uff1aok_load_setup","text":"<p><code>call read_it</code> \u4e0d\u5c55\u5f00\uff0c\u8bfb\u53d6system\u6a21\u5757\uff0c\u8fd8\u6709\u505a\u4e00\u4e9b\u522b\u7684\u4e8b</p> <p>\u5b9e\u9a8c\u4e00\uff1a\u628a\"Loading system\"\u6539\u6210\"Okos is Loading...\"</p> <p><code>cx</code> \u6539\u6210\u5b57\u7b26\u6570</p>"},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/HIT%E8%AF%BE%E7%A8%8B/L2.%E6%8F%AD%E5%BC%80%E9%92%A2%E7%90%B4%E7%9A%84%E7%9B%96%E5%AD%90/#read_it-system","title":"read_it \u8bfb\u5165system\u6a21\u5757","text":""},{"location":"%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%9C%8B%E4%B9%A6/%E7%BB%AA%E8%AE%BA/","title":"\u7eea\u8bba","text":"<p>https://github.com/scriptwang/30DaysMakeOS</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/","title":"2024 04 03","text":"<p>2024-04-03</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/#misc","title":"Misc","text":""},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/#zipcrypto","title":"ZipCrypto","text":"<p>bkcrack\u53ef\u4ee5\u660e\u6587\u653b\u51fb\u52a0\u5bc6\u538b\u7f29\u7684\u538b\u7f29\u5305</p> <p>\u53ea\u9700\u8981\u77e5\u9053\u201c\u4ec5\u5b58\u50a8\u201d\u7684\u6587\u4ef6\u768412\u4e2a\u5b57\u8282\u2014\u2014\u6bd4\u5982JPG\u7684\u56fa\u5b9a\u6587\u4ef6\u5934</p> <p>\u63a8\u8350\u516c\u4f17\u53f7\uff1a\u5c0f\u4e91\u4e91\u7684\u6f5c\u671b\u955c</p> <p>\u63a8\u8350\u8bba\u575b\uff1a\u5361\u996d\u8bba\u575b</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/#reverse","title":"Reverse","text":""},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/#idaf5","title":"IDA\u7684\u5947\u602aF5","text":"<p>\u5f62\u5982 <code>(*fastcall)(*char)(*char) &amp;sub_xxxx + 1</code> \u7684F5\u4ee3\u7801\uff0c\u610f\u5473\u7740IDA Pro\u5206\u6790\u51fa\u73b0\u4e86\u95ee\u9898\uff0c</p> <p>\u8981\u627e\u5230\u771f\u6b63\u7684\u51fd\u6570\u5730\u5740\uff0c\u5c31\u76f4\u63a5\u770b\u6c47\u7f16\u4ee3\u7801\u5c31\u884c</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-03/#android","title":"Android","text":"<p>\u5173\u4e8eXYCTF\u7684\u4e24\u9053\u9898\uff1a</p> <ul> <li> <p>DebugMe\u7528Jeb\u8c03\u8bd5</p> </li> <li> <p>TrustMe\u7528JustTrustMe\u8c03\u8bd5</p> </li> </ul>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-10/","title":"2024-04-10","text":"<p>\u521d\u8d5b\u4e00\u822c\u6bcf\u4e2a\u65b9\u5411\u4f1a\u51fa4-6\u9898</p> <p>\u968f\u6ce2\u9010\u6d41\u5de5\u4f5c\u5ba4\u7684CTF\u8f6f\u4ef6\u592a\u795e\u5947\u4e86</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/","title":"2024-04-17","text":""},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#reverse","title":"Reverse","text":"<ol> <li> <p>upx\u52a0\u58f3\uff0c\u770b\u4e8c\u8fdb\u5236\uff0c\u4f1a\u5305\u542b\u5f88\u591a <code>UPX</code>\uff0c\u800c\u4e0d\u662f <code>upx</code>\uff0c</p> <p><code>upx -d</code> \u65e0\u6cd5\u8131\u58f3\uff0c\u5982\u679c\u7a0b\u5e8f\u4e2d\u7684 <code>UPX</code> \u88ab\u6539\u6210\u4e86 <code>upx</code></p> </li> <li> <p>\u76f4\u63a5\u6539EIP\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u7ed5\u8fc7\u53cd\u8c03\u8bd5</p> </li> <li> <p>\u5982\u679c\u662fRC4\u52a0\u5bc6\uff0c\u8f93\u5165 <code>aaaaaaaaaaaaaaaaaaaaaa</code>\uff0c\u7136\u540e\u628a\u52a0\u5bc6\u540e\u7684\u7ed3\u679c <code>enc</code> \u5f02\u6216 <code>aaa...</code>\uff0c\u5373\u53ef\u5f97\u5230\u5bc6\u94a5\u6d41</p> </li> <li> <p>TEA \u52a0\u5bc6\u548c XTEA XXTEA</p> </li> <li> <p>\u53ef\u4ee5\u5199\u5199NSSCTF\u4e0a\u5f80\u5e74\u56fd\u8d5b\u7684\u9898\u76ee\uff0c\u5173\u952e\u8bcd\uff1aCISCN</p> </li> <li> <p>\u4e0b\u5468\u5230\u6211\u4eec\u5206\u4eab\u4e86qwq</p> </li> </ol>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#_1","title":"\u5e94\u6025\u54cd\u5e94","text":""},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#1","title":"1. \u770b\u770b\u6709\u6ca1\u6709\u540e\u95e8\u7528\u6237\uff1f","text":"<ul> <li><code>net user</code> \u770b\u770b</li> </ul> <p>\u5728\u6ce8\u518c\u8868\u770b\u770b lusrmgr.msc</p> <p>\u53d1\u73b0\u6709\u4e2a <code>hack887$</code></p> <p>\u5220\u6389</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#2","title":"2. \u67e5\u7aef\u53e3","text":"<p>netstat -ano</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#3","title":"3. \u67e5\u8fdb\u7a0b","text":"<p>tasklist</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#4","title":"4. \u67e5\u81ea\u542f\u52a8\u540e\u95e8","text":"<p>\u67e5 \u8ba1\u5212\u4efb\u52a1</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#5","title":"5. \u67e5\u81ea\u542f\u52a8\u7684\u670d\u52a1","text":"<p><code>services.msc</code></p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#6","title":"6. \u67e5\u5947\u602a\u7684\u7a0b\u5e8f","text":"<p>\u770b\u4e00\u4e9b\u7a0b\u5e8f\u7684Log\u65e5\u5fd7\u6587\u4ef6</p>"},{"location":"%E5%88%86%E4%BA%AB%E4%BC%9A/2024-04-17/#7-windows","title":"7. \u67e5Windows\u7cfb\u7edf\u65e5\u5fd7","text":"<p>\u4e8b\u4ef6\u67e5\u770b\u5668</p> <p>4624 \u767b\u5f55\u6210\u529f</p> <p>4720 \u521b\u5efa\u7528\u6237</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/","title":"Debug-x64dbg\u8131\u58f3","text":"<p>\u6587\u4ef6</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#_1","title":"\u66f4\u65b0","text":"<p>\u53c2\u8003\uff1aWindows\u5e73\u53f0\u53cd\u8c03\u8bd5\u6280\u672f\u5b66\u4e60-\u770b\u96ea</p> <p>\u8fd9\u91cc\u4ecb\u7ecd\u4e86\u5404\u79cd\u53cd\u8c03\u8bd5\u7684\u65b9\u6cd5\uff0c\u672c\u9898\u7528\u5230\u4e86\uff1a</p> <ol> <li>\u65f6\u949f\u68c0\u6d4b\u2014\u2014\u68c0\u6d4b\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4\u6233\uff0c\u5982\u679c\u8fc7\u6162\uff0c\u8bf4\u660e\u662f\u5728\u8c03\u8bd5</li> <li>TLS\u56de\u8c03\u51fd\u6570\u2014\u2014\u5728\u7a0b\u5e8f\u5165\u53e3\u4e4b\u524d\u5c31\u53ef\u4ee5\u6267\u884c</li> </ol>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#1","title":"\u53cd\u8c031","text":"<p>\u7528 x64dbg \u6253\u5f00\uff0c\u8c03\u8bd5\u5230\u8fd9\u91cc\u7684\u65f6\u5019\u6309F7\u6216\u8005F8\u90fd\u4f1a\u8dd1\u98de\uff0c\u76f4\u63a5\u7ec8\u6b62</p> <p></p> <p>\u67e5\u9605\u4e86\u4e00\u4e0b\u8d44\u6599\uff0c\u8fd9\u4e2a\u662f\u53cd\u8c03\u8bd5\u7684\u4e00\u79cd\uff0c\u76f8\u5f53\u4e8ejmp\uff0c\u4f46\u662f\u53ef\u4ee5\u963b\u6b62\u8c03\u8bd5\u5668\u8ffd\u8e2a</p> <pre><code>NTSTATUS NTAPI \nNtContinue (\n  IN PCONTEXT ThreadContext,\n  IN BOOLEAN  RaiseAlert\n);\n</code></pre> <p>\u5176\u4e2d <code>PCONTEXT</code> \u662f\u4e2a\u5305\u542b\u76ee\u6807 <code>rip</code> \u7684\u7ed3\u6784\u4f53\uff0c\u53ea\u9700\u8981\u5728\u8fd9\u4e2a\u5730\u5740\u6253\u4e2a\u65ad\u70b9\u7136\u540eF9\u5373\u53ef</p> <p>\u8be2\u95eeai\u53ef\u77e5\uff0c\u662f\u5728\u5934\u6587\u4ef6 <code>winternl.h</code> \u4e2d\u6709 PCONTEXT \u7684\u5b9a\u4e49\uff0c\u65b0\u5efa <code>ok.h</code></p> <pre><code>// file ok.h\nstruct PCONTEXT {\n    unsigned long long P1Home;\n    unsigned long long P2Home;\n    unsigned long long P3Home;\n    unsigned long long P4Home;\n    unsigned long long P5Home;\n    unsigned long long P6Home;\n    unsigned long ContextFlags;\n    unsigned long MxCsr;\n    unsigned short SegCs;\n    unsigned short SegDs;\n    unsigned short SegEs;\n    unsigned short SegFs;\n    unsigned short SegGs;\n    unsigned short SegSs;\n    unsigned long EFlags;\n    unsigned long long Dr0;\n    unsigned long long Dr1;\n    unsigned long long Dr2;\n    unsigned long long Dr3;\n    unsigned long long Dr6;\n    unsigned long long Dr7;\n    unsigned long long Rax;\n    unsigned long long Rcx;\n    unsigned long long Rdx;\n    unsigned long long Rbx;\n    unsigned long long Rsp;\n    unsigned long long Rbp;\n    unsigned long long Rsi;\n    unsigned long long Rdi;\n    unsigned long long R8;\n    unsigned long long R9;\n    unsigned long long R10;\n    unsigned long long R11;\n    unsigned long long R12;\n    unsigned long long R13;\n    unsigned long long R14;\n    unsigned long long R15;\n    unsigned long long Rip;\n};\n</code></pre> <p></p> <p>\u5148\u8c03\u8bd5\u5230\u8fd9\uff0c\u7136\u540e\u70b9 Struct\uff0c\u53f3\u952e - Parse header\uff0c\u9009\u62e9\u521a\u521b\u5efa\u7684\u6587\u4ef6</p> <p>\u8f93\u5165\u547d\u4ee4 <code>EnumTypes</code> \u5c31\u53ef\u4ee5\u5728 <code>Log</code> \u6807\u7b7e\u770b\u5230\u6240\u6709\u7684\u7c7b\u578b\u5b9a\u4e49</p> <p></p> <p>\u7136\u540e\u56de\u5230 Struct \u6807\u7b7e\uff0c\u53f3\u952e - Visit type\uff0c\u8f93\u5165 <code>PCONTEXT</code> \u56de\u8f66 \u2014\u2014 \u8f93\u5165 <code>RCX</code> \u6216\u8005 <code>RBX</code> \u56de\u8f66</p> <p></p> <p>\u5c31\u53ef\u4ee5\u770b\u5230\u76ee\u6807 rip \u4e86</p> <p></p> <p>\u53f3\u952e \u2014\u2014 Follow value in disassembler\uff0c\u7136\u540eF2\u6253\u4e2a\u65ad\u70b9\uff0c\u7136\u540eF9\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u8c03\u8bd5\u4e86</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>\u901a\u8fc7NtContinue\u4fee\u65393\u73af\u7a0b\u5e8f\u6267\u884c\u6d41\u7a0b-\u770b\u96ea</li> <li>assembly - How to bypass ZwContinue? - Reverse Engineering Stack Exchange</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#esp","title":"esp\u5b9a\u5f8b","text":"<p>\u8c03\u5230\u8fd9\uff0c\u8c03\u8bd5\u5668\u4f1a\u65ad\u5f00\uff0c\u6b65\u8fdb\u770b\u770b</p> <p></p> <p>\u8fd9\u91cc\u4e5f\u662f</p> <p></p> <p>\u7ee7\u7eed\u6df1\u5165</p> <p></p> <p>\u8fd9\u91cc\u6709\u5f88\u591a\u4e2a push \u7c7b\u4f3c x32 \u7684 pushad\uff0c\u53ef\u4ee5\u4e0aesp\u5927\u6cd5\u4e86\uff0c\u5728 <code>push rdi</code> \u4e4b\u540e\u7684esp\u5904\u4e0b\u4e2a\u786c\u4ef6\u65ad\u70b9\uff08\u5b9e\u6d4b\u5728push rbp\u4e0b\u65ad\u70b9\u66f4\u597d\uff09</p> <p></p> <p>\u8fd9\u91cc\u6709\u4e2a\u5927\u8df3\uff0c\u628a\u65ad\u70b9\u53d6\u6d88\u6389\u4e4b\u540e\uff0c\u76f4\u63a5F4\uff0c\u518dF8\u4e00\u4e0b\uff0c\u5c31\u8fdb\u5165OEP\u4e86</p> <p>\u7136\u540e\u7528 Scylla \u63d2\u4ef6\uff0cIAT\u81ea\u52a8\u641c\u7d22\u2014\u2014\u83b7\u53d6\u5bfc\u5165\u2014\u2014\u8f6c\u50a8 \u4fdd\u5b58\u5230<code>Debug_dump.exe</code>\u2014\u2014\u4fee\u590d\u8f6c\u50a8 \u9009\u62e9 <code>Debug_dump.exe</code> \u2014\u2014 \u5c31\u4f1a\u751f\u6210 <code>Debug_dump_SCY.exe</code> </p> <p>\u8fd0\u884c\u6b63\u5e38\uff0c\u8131\u58f3\u6210\u529f</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#2","title":"\u53cd\u8c032","text":"<p>\u65e0\u8bba\u600e\u4e48\u6253\u65ad\u70b9\uff0c\u5728 start \u6253\u65ad\u70b9\u4e5f\u597d\uff0c\u4e5f\u65ad\u4e0d\u4e86\uff0c\u7a0b\u5e8f\u8fd0\u884c2-3\u79d2\u5c31\u4f1a\u81ea\u52a8\u5173\u95ed\u2014\u2014\u56e0\u4e3a\u62a5\u5f02\u5e38\u4e86</p> <p></p> <p>\u6ca1\u529e\u6cd5\u7528frida\uff0c\u56e0\u4e3a\u6709SMC\uff0c\u5c31\u7b97\u5b9a\u4f4d\u5230\u4e86\u7a0b\u5e8f\uff0c\u52a8\u8c03\u4e0d\u4e86\u4e5f\u53ea\u662f\u4e00\u5768\u52a0\u5bc6\u6570\u636e</p> <p>\u5728\u6808\u91cc\u5f80\u4e0a\u7ffb\u7ffb\uff0c\u7a0b\u5e8f\u5df2\u7ecf\u8c03\u7528exit\u4e86</p> <p></p> <p>\u8bf4\u660e\u8fd8\u6ca1 <code>start</code> \u5c31\u5df2\u7ecf\u88ab\u53cd\u8c03\u4e86\uff0c\u518d\u7ffb\u7ffb</p> <p></p> <p></p> <p>\u627e\u5230\u4e86\uff0c\u5728\u8fd9\uff0c\u53f3\u952e\u2014\u2014Force jump</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#3","title":"\u53cd\u8c033","text":"<p>\u76f4\u63a5\u5728 <code>exit</code> \u4e0b\u65ad\u70b9</p> <p></p> <p>\u8fd9\u91cc\u4e5f\u85cf\u4e86\u4e00\u4e2a <code>IsDebuggerPresent</code> \uff0cforce jump\u6389</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#4","title":"\u53cd\u8c034","text":"<p>\u8c03\u7528\u5b8c\u8fd9\u884c\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u9000\u51fa</p> <p></p> <p></p> <p></p> <p>\u8fd9\u662f\u6839\u636e\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4\u957f\u5ea6\u6765\u51b3\u5b9a\u662f\u5426\u9000\u51fa\u7a0b\u5e8f\uff0c</p> <p></p> <p>Force jump \u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/2024DragonCtf/Debug/#_2","title":"\u7a0b\u5e8f\u5206\u6790","text":"<p>\u8bfb\u53d6 <code>myflag.txt</code> \u5230\u8fd9</p> <p>\u7136\u540e\u8fdb\u5165\u7b2c\u4e00\u4e2a\u51fd\u6570\uff0c\u52a8\u8c03\u4e00\u4e0b\uff0c\u662f\u4e2aSMC\uff0c\u52a8\u6001\u52a0\u8f7d\u51fa\u4ee3\u7801\uff0c\u8c03\u5b8c\u4e4b\u540eF5\u5c31\u53ef\u4ee5\u770b\u5230\u52a0\u5bc6\u6d41\u7a0b\u4e86</p> <p></p> <p>\u662f\u4e2a\u7b80\u5355\u7684\u52a0\u52a0\u51cf\u51cf\u5f02\u6216\u52a0\u5bc6</p> <pre><code>enc = [\n  0xCF, 0xD9, 0xC0, 0xC8, 0xDF, 0xCD, 0x0C, 0xD2, 0x43, 0x98, \n  0x10, 0xC0, 0x83, 0x43, 0x9A, 0x10, 0xCD, 0x42, 0x8C, 0x4A, \n  0x10, 0xC8, 0x82, 0x83, 0x4A, 0x9F, 0x8C, 0xDF, 0x98, 0x42, \n  0x8C, 0xDF, 0x84, 0x82, 0x83, 0x46, 0x52, 0x52, 0x52, 0x0E\n]\n\nr = []\n\nfor i in range(len(enc)):\n    try1 = (enc[i] ^ 0x51) + 30\n    try2 = (enc[i] ^ 0xCD) + 32\n    try3 = (enc[i] ^ 0xAB) - 32\n    if try1 in range(0, 0x7E) and (try1 &lt;= 0x60 or try1 &gt;= 0x7B) and (try1 &lt;= 0x40 or try1 &gt;= 0x5B):\n        r += [try1]\n    if try2 in range(0, 0x7E) and (not (try2 &lt;= 0x60 or try2 &gt;= 0x7B)) and (try2 &lt;= 0x40 or try2 &gt;= 0x5B):\n        r += [try2]\n    if try3 in range(0, 0x7E) and (not (try3 &lt;= 0x40 or try3 &gt;= 0x5B)):\n        r += [try3]\n\nprint(bytes(r))\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-28/","title":"babyre","text":"<p>\u3010CISCN 2023 \u521d\u8d5b\u3011babyRE</p> <p>\u6587\u4ef6</p> <p>xml\u6587\u4ef6\u91cc\u6709\u4e2a\u7f51\u7ad9\uff1aSnap! re4baby22 (berkeley.edu)</p> <p>\u7c7b\u4f3cScratch\u7684\u53ef\u89c6\u5316\u7f16\u7a0b\uff0c\u5bfc\u5165xml</p> <p></p> <p>\u8f93\u5165flag\u4e4b\u540e\u62a5\u9519\uff0c\u201c\u9700\u8981\u5f00\u542fJavaScript\u201d</p> <p>\u70b9\u5de6\u4e0a\u89d2\u9f7f\u8f6e\uff0cEnable Js\uff0c\u5c31\u8fd0\u884c\u6b63\u5e38\u4e86</p> <p>\u6bcf\u4e2a\u5143\u7d20\u90fd\u70b9\u4e00\u4e0b\uff0c\u627e\u627e\u52a0\u5bc6\u811a\u672c</p> <p></p> <p>\u590d\u5236\u4e00\u4e0b\u6a21\u5757\uff0c\u6539\u6210 <code>say secret for 600 secs</code> \uff0c\u53f3\u952e\u663e\u793a\u7684\u6570\u7ec4 export\uff0c\u5c31\u53ef\u4ee5\u62ff\u5230 secret</p> <pre><code>enc = [102,10,13,6,28,74,3,1,3,7,85,0,4,75,20,92,92,8,28,25,81,83,7,28,76,88,9,0,29,73,0,86,4,87,87,82,84,85,4,85,87,30]\n\nr = [enc[0]]\nfor i in range(1, len(enc)):\n    r.append(enc[i] ^ r[i - 1])\nprint(''.join([chr(c) for c in r]))\n</code></pre> <p>\u7528z3\u4e5f\u53ef\u4ee5\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cz3\u53ea\u6709BitVec\u80fd\u8fdb\u884c\u4f4d\u8fd0\u7b97\uff0cInt\u4f4d\u8fd0\u7b97\u4f1a\u62a5\u9519</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-28/#babybc","title":"Babybc","text":"<p>\u6587\u4ef6</p> <p>\u63d0\u4ea4\u7684flag\u4e3aNSSCTF{md5(your_input)}</p> <p>\u901a\u8fc7\u641c\u7d22\u540e\u7f00\u540d\uff0c\u662f LLVM Bitcode \u683c\u5f0f</p> <p>\u5b89\u88c5 llvm</p> <pre><code>sudo apt install llvm\nlli baby.bc # \u8fd0\u884c\nllvm-dis baby.bc -o baby.ll # \u53cd\u6c47\u7f16\nllc baby.ll # \u751f\u6210 baby.s\nas baby.s -o baby # \u751f\u6210 baby\n</code></pre> <p>\u5176\u5b9e\u4e00\u6761\u547d\u4ee4\u5c31\u5b8c\u4e8b</p> <p>Windows\u5b89\u88c5 LLVM Snapshot Builds</p> <pre><code>clang baby.bc -o baby\n</code></pre> <p>\u5c31\u53ef\u4ee5\u628ababy\u6254\u8fdbIDA\u91cc\u5206\u6790\u4e86\uff0c\u4e0d\u8fc7\u4e0d\u80fd\u76f4\u63a5\u8fd0\u884c</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-28/#_1","title":"\u5206\u6790\u9519\u4e86","text":"<pre><code>v28 = 0;\nv27 = 0;\nv2 = *(v0 - 4);\nif ( *((_BYTE *)&amp;v27 + v2) )\n  break;\n*((_BYTE *)&amp;v27 + v2) = 1;\nv3 = *(v0 - 3);\nif ( *((_BYTE *)&amp;v27 + v3) )\n  break;\n*((_BYTE *)&amp;v27 + v3) = 1;\nv4 = *(v0 - 2);\nif ( *((_BYTE *)&amp;v27 + v4) )\n  break;\n*((_BYTE *)&amp;v27 + v4) = 1;\nv5 = *(v0 - 1);\nif ( *((_BYTE *)&amp;v27 + v5) )\n  break;\n*((_BYTE *)&amp;v27 + v5) = 1;\nif ( *((_BYTE *)&amp;v27 + *v0) )\n  break;\n++v1;\nv0 += 5;\n</code></pre> <p>\u8fd9\u91cc\u7684\u4ee3\u7801\u6211\u4ee5\u4e3a\u662f\u521d\u59cb\u5316\uff0c\u5b9e\u9645\u4e0a\u662f\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u4e00\u884c\u7684\u5143\u7d20\u90fd\u4e0d\u80fd\u76f8\u540c</p> <p>\u4e0b\u9762\u7684\u4ee3\u7801\u662f\u4fdd\u8bc1\u4e86\u6bcf\u4e00\u5217\u4e2d\u7684\u5143\u7d20\u4e0d\u80fd\u76f8\u540c\u2014\u2014\u5c31\u662f\u6570\u72ec</p> <pre><code>map = [[0] * 5, [0] * 5, [0,0,4,0,0], [0,0,0,3,0], [0] * 5]\nrow = [[0,0,0,1],[1,0,0,0],[2,0,0,1], [0] * 4, [1,0,1,0]]\ncol = [[0,0,2,0,2], [0]* 5, [0,0,0,1,0], [0,1,0,0,1]]\n\nfrom z3 import *\n\nsolver = Solver()\nflag = []\nfor i in range(25):\n    if i == (2 * 5 + 2) or i == (3 * 5 + 3):\n        flag.append(b'0')\n    else:\n        v = Int(f\"a_{i}\")\n        flag.append(v)\n        solver.add(v &gt;= ord('0'))\n        solver.add(Not(v - ord('0') &gt; 5))\n\nprint(flag)\n\n# \u521d\u59cb\u5316\n# \u5fc5\u987b\u521a\u597d\u662f25\uff0c\u800c\u4e14\u6307\u5b9a\u4f4d\u7f6e\u7684\u5b57\u7b26\u5fc5\u987b\u662f0\nfor i in range(5):\n    for j in range(5):\n        tmp = flag[i*5 + j]\n        if map[i][j] != 0:\n            continue\n        else:\n            map[i][j] = tmp - ord('0')\n\nfor i in range(5): # \u904d\u5386\u884c\n    for j in range(5): # \u904d\u5386\u54a7\n        for k in range(5): # \u518d\u904d\u5386\u5217/\u884c\n            if j != k:\n                solver.add(map[i][j] != map[i][k])\n            if i != k:\n                solver.add(map[i][j] != map[k][j])\n\n# \u8fd9\u91cc\u662f\u628arow/col\u5f53\u505a\u6307\u4ee4\uff0c\u6839\u636e\u6307\u4ee4\u6765\u5bf9map\u8fdb\u884c\u64cd\u4f5c\nfor i in range(5):\n    for j in range(4):\n        match row[i][j]:\n            case 2:\n                solver.add(Not(map[i][j] &gt; map[i][j+1]))\n            case 1:\n                solver.add(Not(map[i][j] &lt; map[i][j+1]))\n\nfor i in range(4):\n    for j in range(5):\n        match col[i][j]:\n            case 2:\n                solver.add(Not(map[i][j] &lt; map[i+1][j]))\n            case 1:\n                solver.add(Not(map[i][j] &gt; map[i+1][j]))\n\nprint(solver.check())\nm = solver.model()\n\nr = ''\nfor i in range(25):\n    if i == (2 * 5 + 2) or i == (3 * 5 + 3):\n        r += '0'\n    else:\n        r += chr(m[flag[i]].as_long())\nprint(r)\n\nimport hashlib\nprint(hashlib.md5(r.encode()).hexdigest())\n</code></pre> <pre><code>CISCN{MD5(0524332051230104010251324)}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-29/","title":"2024 04 29","text":"<p>\u5982\u4f55\u4f18\u96c5\u7684\u4f7f\u7528\u5b57\u8282\u7801\u5462\uff1f</p> <p>\u3010CISCN 2023 \u521d\u8d5b\u3011ezbyte</p> <p>\u8d85\u7eb2\u4e86TwT</p> <ul> <li>2023 CTF\u56fd\u8d5b\u521d\u8d5b\uff08CISCN\uff09 re- ez_byte_[ciscn 2023 \u521d\u8d5b]ezbyte-CSDN\u535a\u5ba2</li> <li>\u901a\u8fc7DWARF Expression\u5c06\u4ee3\u7801\u9690\u85cf\u5728\u6808\u5c55\u5f00\u8fc7\u7a0b\u4e2d-\u8f6f\u4ef6\u9006\u5411-\u770b\u96ea-\u5b89\u5168\u793e\u533a|\u5b89\u5168\u62db\u8058|kanxue.com</li> </ul> <p>\u8fd0\u884c\uff0c\u8981\u6c42\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u8f93\u5165\u4e86\u4e4b\u540e\uff0c\u4f1a\u590d\u8bfb\u4e00\u6b21\uff0c\u7136\u540e\u9000\u51fa\u7a0b\u5e8f</p> <p></p> <p>\u5728 sub_404D25 \u627e\u5230scanf</p> <p></p> <p>\u8fd9\u91cc\u7684a2\u662fscanf\u5230\u7684\u5b57\u7b26\u4e32\u6307\u9488\uff0c\u8fd9\u91cc\u7684if else\u5224\u65ad\u662f\u5426\u5408\u6cd5</p> <p>v2 = sub_401200(a2) \u731c\u6d4b\u662fstrlen\uff0c\u5c1d\u8bd5\u4e86\u51e0\u4e2a\u5b57\u7b26\u4e32\uff0c\u786e\u5b9e\u662f</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-29/#_1","title":"\u6062\u590d\u7b26\u53f7\u8868","text":"<p>IDA\u63d2\u4ef6#IDA\u7b26\u53f7\u8868\u6062\u590d</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-29/#_2","title":"\u6293","text":"<p>\u4ece\u5934\u5f00\u59cb\u9006\u6709\u70b9\u56f0\u96be\uff0c\u4eceprintf/putchar\u5165\u624b</p> <p>\u641c\u7d22 <code>printf</code> <code>putc</code> \u51fd\u6570\uff0c\u5168\u90e8\u6253\u4e0a\u65ad\u70b9</p> <p>\u5728 <code>_IO_sputbackc</code> \u65ad\u5230\u4e86</p> <p>\u6309 <code>&lt;Ctrl+F7&gt;</code> \u56de\u6eaf\uff0c\u627e\u5230\u4e00\u4e2a\u5730\u72f1\u7ed8\u56fe</p> <p></p> <p>\u4e0d\u8fc7\u8fd9\u770b\u8d77\u6765\u662flibc\u91cc\u7684\u51fd\u6570\uff0c\u770b\u4e86\u51fd\u6570\u5934\u4e4b\u540e <code>_vfscanf_internal</code></p> <p></p> <p>\u7ee7\u7eed\u56de\u6eaf\uff0c\u6ca1\u4e8b\u4e86\uff0c\u5c31\u662fmain\u51fd\u6570\u91cc\u7684\u7b2c\u4e00\u6b21 scanf</p> <p>\u91cd\u65b0\u7ed9putc\u6253\u4e0a\u65ad\u70b9</p> <p><code>_IO_new_file_xsputn</code> \u65ad\u5230\u4e86</p> <pre><code>_IO_new_file_xsputn\n-&gt; _IO_new_file_xsputn\n-&gt; _IO_fwrite\n-&gt; call qword ptr [rax+60h]\n</code></pre> <p>\u6ca1\u4e8b\u4e86\uff0c\u8fd9\u4e2a\u662f\u52a0\u5bc6\u7684\u51fd\u6570\uff0c\u7ee7\u7eedF8</p> <p><code>_IO_putc_0</code> \u65ad\u5230\u4e86</p> <pre><code>_IO_putc_0\n-&gt; sub_46EB90\u4e0b\u7684call  qword ptr [rax+68h]\n</code></pre> <p>\u6253\u5370\u51fa\u6765\u4e86 aaaaa</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-30/","title":"2024-04-30","text":""},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024-04-30/#baby_tree","title":"baby_tree","text":"<p>Swift\u5e95\u5c42\u8fdb\u9636--001\uff1aSwift\u7f16\u8bd1 &amp; SIL\u5206\u6790 - \u7b80\u4e66 (jianshu.com)</p> <pre><code>docker pull swift\ndocker run -it -v .\\swift_docker:/swift_docker swift\n</code></pre> <pre><code>swiftc -emit-ir baby_tree.ast -o baby_tree.ll\n</code></pre> <p></p> <p><code>brace_stmt</code> \u8868\u793a\u82b1\u62ec\u53f7 <code>{}</code> \u4e2d\u7684\u8bed\u53e5\u5757</p> <p><code>pattern_binding_decl</code> \u8868\u793a\u6a21\u5f0f\u7ed1\u5b9a\u58f0\u660e\uff0c\u7528\u4e8e\u58f0\u660e\u53d8\u91cf\u5e76\u5c06\u5176\u4e0e\u7279\u5b9a\u6a21\u5f0f\u5339\u914d\u7684\u503c\u7ed1\u5b9a\u5728\u4e00\u8d77\u3002</p> <p><code>binary_expr</code> \u8868\u793a\u4e8c\u5143\u8868\u8fbe\u5f0f</p> <pre><code>(binary_expr\n  (operand)\n  (operator_token)\n  (operand)\n)\n</code></pre> <p><code>dot_syntax_call_expr</code> \u8868\u793a\u901a\u8fc7\u70b9\u8bed\u6cd5\u8c03\u7528\u7684\u8868\u8fbe\u5f0f\uff0c\u901a\u5e38\u7528\u4e8e\u8bbf\u95ee\u7c7b\u578b\u7684\u5c5e\u6027\u6216\u8c03\u7528\u7c7b\u578b\u7684\u65b9\u6cd5\u3002</p> <pre><code>(dot_syntax_call_expr\n  (base_expr)      // \u57fa\u7840\u8868\u8fbe\u5f0f\uff0c\u8868\u793a\u8c03\u7528\u7684\u5bf9\u8c61\u6216\u7c7b\u578b\n  (dot_token)      // \u70b9\u53f7\uff08.\uff09\u6807\u8bb0\uff0c\u7528\u4e8e\u8868\u793a\u70b9\u8bed\u6cd5\u8c03\u7528\n  (name)           // \u6210\u5458\u540d\u79f0\uff0c\u8868\u793a\u88ab\u8c03\u7528\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\u540d\n  (argument_list)  // \u53c2\u6570\u5217\u8868\uff0c\u8868\u793a\u65b9\u6cd5\u8c03\u7528\u65f6\u7684\u53c2\u6570\n)\n</code></pre> <p>\u6709\u4e2aforeach</p> <p>\u5206\u6790\u51fa\u6765\u7b97\u6cd5\u4e86\uff0c\u4f46\u662f\u53d1\u73b0\u65e0\u6cd5\u7528z3\u89e3\u51fa\u6765\u2014\u2014\u8fd9\u91cc\u8981\u752816\u4f4d\uff0c\u4e0d\u80fd\u75288\u4f4d\uff0c\u56e0\u4e3a8\u4f4d\u4f1a\u6709\u7cbe\u5ea6\u635f\u5931</p> <pre><code>data = [88,35,88,225,7,201,57,94,77,56,75,168,72,218,64,91,16,101,32,207,73,130,74,128,76,201,16,248,41,205,103,84,91,99,79,202,22,131,63,255,20,16]\n\nfrom z3 import *\nsolver = Solver()\n\nflag = [BitVec(f\"bv_{i}\", 16) for i in range(len(data))]\n\nsave = [f for f in flag]\n[solver.add(And(f &lt;= 0x7E, f &gt;= 0x20)) for f in save]\n\nk = b\"345y\"\n\nfor i in range(len(flag) - 3):\n    r0 = flag[i]\n    r1 = flag[i+1]\n    r2 = flag[i+2]\n    r3 = flag[i+3]\n\n    flag[i+0] = r2 ^ ((k[0] + (r0 &gt;&gt; 4)) &amp; 0xff)\n    flag[i+1] = r3 ^ ((k[1] + (r1 &gt;&gt; 2)) &amp; 0xff)\n    flag[i+2] = r0 ^ k[2]\n    flag[i+3] = r1 ^ k[3]\n\n    k = bytes([k[1],k[2],k[3],k[0]])\n\nfor i in range(len(data)):\n    solver.add(flag[i] == data[i])\n\nif solver.check() == sat:\n    m = solver.model()\n    print(''.join(chr(m[save[i]].as_long()) for i in range(len(data))))\nelse:\n    print(\"Damn!\")\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%902023%E5%88%9D%E8%B5%9B%E3%80%91ezbyte/","title":"\u30102023\u521d\u8d5b\u3011ezbyte","text":"<ul> <li>gaoyucan - \u535a\u5ba2\u56ed (cnblogs.com)</li> <li>ezbyte-CSDN\u535a\u5ba2 \u2014\u2014 \u4e3b\u8981\u601d\u8def</li> <li>C++\u5f02\u5e38\u5904\u7406\u673a\u5236\uff08throw\u3001try\u3001catch\u3001finally\uff09 - \u77e5\u9053\u4e86\u5440~ - \u535a\u5ba2\u56ed (cnblogs.com)</li> <li>c++ \u5f02\u5e38\u5904\u7406\uff081\uff09 - twoon - \u535a\u5ba2\u56ed (cnblogs.com)</li> <li>c++ \u5f02\u5e38\u5904\u7406\uff082\uff09 - twoon - \u535a\u5ba2\u56ed (cnblogs.com)</li> </ul> <p>\u5206\u6790\u4e86\u4e24\u5e74\u534a\u7684\u7a0b\u5e8f\uff0c\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\uff1a</p> <pre><code>std::cin &gt;&gt; str;\nstd::cout &lt;&lt; str &lt;&lt; std::endl;\n</code></pre> <p>\u901a\u8fc7\u5bf9\u6bd4\u6b63\u5e38\u7a0b\u5e8f\u548c\u53bb\u9664\u4e86\u7b26\u53f7\u8868\u7684\u7a0b\u5e8f</p> <p>\u6b63\u5e38\u7a0b\u5e8f\u7684 <code>std::cout &lt;&lt; str</code>\uff1a</p> <p></p> <p>\u53bb\u9664\u7b26\u53f7\u8868\u4e4b\u540e\uff1a</p> <p></p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%902023%E5%88%9D%E8%B5%9B%E3%80%91ezbyte/#_1","title":"\u7a0b\u5e8f\u5206\u6790","text":"<pre><code>sub_4D1840((unsigned int)\"%100s\", (unsigned int)v7, (unsigned int)v8, 0, v3, v4);\n// std:cin &gt;&gt; v7\nv5 = sub_46F4F0(&amp;unk_5D5520, v7);\nZNSirsEPFRSiS_E_1(v5, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_);\n// std::cout &lt;&lt; v7 &lt;&lt; endl\nsub_404C21((unsigned __int8 *)v7);\n// \u68c0\u9a8c\u51fd\u6570\n</code></pre> <p>\u8fd9\u4e2a\u51fd\u6570\u662f\u5bf9\u90e8\u5206\u4f4d\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u5fc5\u987b\u4e3a <code>flag{________________________________3861}</code></p> <p>\u7136\u540e\u6709\u4e00\u90e8\u5206\u6c47\u7f16\u6307\u4ee4\u6ca1\u6709\u751f\u6210\u4f2a\u4ee3\u7801\uff1a</p> <pre><code>.text:0000000000404CDB mov     rax, [rbp+var_28]\n.text:0000000000404CDF mov     rax, [rax+5]\n.text:0000000000404CE3 mov     [rbp+var_20], rax ; \u610f\u601d\u662fvar_20 = flag[5:5+8]\n.text:0000000000404CE7 mov     rax, [rbp+var_28]\n.text:0000000000404CEB mov     rax, [rax+0Dh]\n.text:0000000000404CEF mov     [rbp+var_18], rax ; var_18 = flag[5+8:5+8*2]\n.text:0000000000404CF3 mov     rax, [rbp+var_28]\n.text:0000000000404CF7 mov     rax, [rax+15h]\n.text:0000000000404CFB mov     [rbp+var_10], rax ; var_10 = flag[5+8*2:5+8*3]\n.text:0000000000404CFF mov     rax, [rbp+var_28]\n.text:0000000000404D03 mov     rax, [rax+1Dh]\n.text:0000000000404D07 mov     [rbp+var_8], rax ; var_18 = flag[5+8*3:5+8*4]\n.text:0000000000404D0B mov     r15, [rbp+var_8]\n.text:0000000000404D0F mov     r14, [rbp+var_10]\n.text:0000000000404D13 mov     r13, [rbp+var_18]\n.text:0000000000404D17 mov     r12, [rbp+var_20]\n.text:0000000000404D1B call    sub_404BF5      ; Call Procedure\n</code></pre> <p>\u628a\u4e2d\u95f4\u768432\u4e2a\u5b57\u7b26\u5206\u62104\u7ec4\uff0c\u5206\u522b\u5b58\u8fdb <code>r12 r13 r14 r15</code></p> <p>\u7136\u540e\u8fd9\u4e2a <code>sub_404BF5</code> \u5c31\u4f1a\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\uff0c\u68c0\u67e5main\u51fd\u6570</p> <p></p> <p>\u53f3\u4e0a\u89d2\u6709\u4e00\u4e9b\u4ee3\u7801\uff0c\u901a\u8fc7\u5224\u65adr12\u6765\u8f93\u51fa\u201dYes!\u201c\uff0c\u4f46\u662f\u4ee3\u7801\u91cc\u9762\u90fd\u6ca1\u6709\u63d0\u5230r12\uff0c\u770b\u6765\u662f\u85cf\u8d77\u6765\u4e86</p> <p>\u901a\u8fc7DWARF Expression\u5c06\u4ee3\u7801\u9690\u85cf\u5728\u6808\u5c55\u5f00\u8fc7\u7a0b\u4e2d-\u8f6f\u4ef6\u9006\u5411-\u770b\u96ea-\u5b89\u5168\u793e\u533a|\u5b89\u5168\u62db\u8058|kanxue.com \u85cf\u5230\u4e86\u4e00\u4e2a\u865a\u62df\u673a\u91cc\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>readelf -w ezbyte_patch &gt; output.txt</code> \u83b7\u53d6</p> <p>\u7136\u540e\u641c\u7d22 <code>r12</code></p> <pre><code>(DW_OP_constu: 2616514329260088143; \nDW_OP_constu: 1237891274917891239; \nDW_OP_constu: 1892739; \nDW_OP_breg12 (r12): 0; \nDW_OP_plus; \nDW_OP_xor; \nDW_OP_xor; \nDW_OP_constu: 8502251781212277489; \nDW_OP_constu: 1209847170981118947; \nDW_OP_constu: 8971237; \nDW_OP_breg13 (r13): 0; \nDW_OP_plus; \nDW_OP_xor; \nDW_OP_xor; \nDW_OP_or; \nDW_OP_constu: 2451795628338718684; \nDW_OP_constu: 1098791727398412397; \nDW_OP_constu: 1512312; \nDW_OP_breg14 (r14): 0; \nDW_OP_plus; \nDW_OP_xor; \nDW_OP_xor; \nDW_OP_or; \nDW_OP_constu: 8722213363631027234; \nDW_OP_constu: 1890878197237214971; \nDW_OP_constu: 9123704; \nDW_OP_breg15 (r15): 0; \nDW_OP_plus; \nDW_OP_xor; \nDW_OP_xor; \nDW_OP_or)\n</code></pre> <p>\u8336\u56ed\u5b98\u65b9\u6587\u6863 https://dwarfstd.org/doc/DWARF5.pdf</p> <pre><code>DW_OP_constu: 8722213363631027234\uff1a\u5c06\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_constu: 1890878197237214971\uff1a\u5c06\u53e6\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_constu: 9123704\uff1a\u5c06\u7b2c\u4e09\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_breg15 (r15): 0\uff1a\u4ece r15 \u8fd9\u4e2a\u5bc4\u5b58\u5668\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u503c\uff0c\u5e76\u5c06\u5176\u52a0\u4e0a\u504f\u79fb\u91cf 0\u3002\nDW_OP_plus\uff1a\u4ece\u5806\u6808\u4e2d\u5f39\u51fa\u4e24\u4e2a\u503c\uff0c\u76f8\u52a0\u540e\u518d\u5c06\u7ed3\u679c\u538b\u5165\u5806\u6808\u3002\nDW_OP_xor\uff1a\u4ece\u5806\u6808\u4e2d\u5f39\u51fa\u4e24\u4e2a\u503c\uff0c\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\u540e\u518d\u5c06\u7ed3\u679c\u538b\u5165\u5806\u6808\u3002\nDW_OP_xor\uff1a\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u518d\u8fdb\u884c\u4e00\u6b21\u5f02\u6216\u8fd0\u7b97\u3002\nDW_OP_constu: 2451795628338718684\uff1a\u5c06\u53e6\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_constu: 1098791727398412397\uff1a\u5c06\u53e6\u4e00\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_constu: 1512312\uff1a\u5c06\u7b2c\u4e09\u4e2a\u65e0\u7b26\u53f7\u6574\u6570\u538b\u5165\u5806\u6808\u3002\nDW_OP_breg14 (r14): 0\uff1a\u4ece r14 \u8fd9\u4e2a\u5bc4\u5b58\u5668\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u503c\uff0c\u5e76\u5c06\u5176\u52a0\u4e0a\u504f\u79fb\u91cf 0\u3002\nDW_OP_plus\uff1a\u4ece\u5806\u6808\u4e2d\u5f39\u51fa\u4e24\u4e2a\u503c\uff0c\u76f8\u52a0\u540e\u518d\u5c06\u7ed3\u679c\u538b\u5165\u5806\u6808\u3002\nDW_OP_xor\uff1a\u4ece\u5806\u6808\u4e2d\u5f39\u51fa\u4e24\u4e2a\u503c\uff0c\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\u540e\u518d\u5c06\u7ed3\u679c\u538b\u5165\u5806\u6808\u3002\nDW_OP_xor\uff1a\u91cd\u590d\u524d\u9762\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/","title":"\u3010CISCN2021\u534e\u5357\u3011ezre","text":"<p>ELF64     \u64cd\u4f5c\u7cfb\u7edf: Ubuntu Linux(20.04,ABI: 3.2.0)[AMD64, 64 \u4f4d, EXEC]     \u7f16\u8bd1\u5668: GCC(9.3.0)     \u8bed\u8a00: C/C++</p> <p>CISCN 2021\u534e\u5357 ezre | NSSCTF</p> <p>ptrace\u51fd\u6570\u6df1\u5165\u5206\u6790 - \u9ed1\u7bb1 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>ps\uff1a\u53f3\u952e\u53ef\u4ee5\u76f4\u63a5\u81ea\u52a8\u751f\u6210\u7ed3\u6784\u4f53</p> <p></p> <p>\u5a01\u529b\u5de8\u5927\u7684\u7cfb\u7edf\u8c03\u7528\u2014\u2014ptrace - \u77e5\u4e4e (zhihu.com)</p> <p>\u795e\u5947\uff0c\u5f53<code>v4=0</code>\u7684\u65f6\u5019\uff0c\u662f\u5b50\u8fdb\u7a0b\uff0c<code>v4!=0</code> \u5c31\u662f\u7236\u8fdb\u7a0b</p> <p>wait ()\u4f1a\u6682\u65f6\u505c\u6b62\u76ee\u524d\u8fdb\u7a0b\u7684\u6267\u884c, \u76f4\u5230\u6709\u4fe1\u53f7\u6765\u5230\u6216\u5b50\u8fdb\u7a0b\u7ed3\u675f</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_1","title":"\u7ecf\u5e38\u8c03\u7740\u8c03\u7740\u7a0b\u5e8f\u505c\u4e86","text":"<p>\u5728\u5f00\u5934\u5b9a\u4e86\u4e2a\u95f9\u949f\uff0c\u6539\u5927\u4e00\u70b9\u5c31\u884c</p> <p>\u662f\u4e00\u4e2a\u865a\u62df\u673a</p> \u5730\u5740 v8 \u4f5c\u7528 \u5bf9\u5e94 401780h 3 \u672a\u77e5 qword0 = 0 0 \u8df3\u8f6cbase\u5230q2 nop #### case 2 \u548c case 4 \u662f\u4e00\u4e2a\u76f8\u53cd\u7684\u64cd\u4f5c <p>2\u662f\uff1aret \u8df3\u8f6c\u5230 <code>base = v13[...]</code> <code>v12 += 8</code></p> <pre><code>pop loc1\njmp loc1\n</code></pre> <p>4\u662f\uff1acall <code>v13[...] = base-&gt;q0</code> \uff0c <code>__iptr++</code> <code>v12 -= 8</code> <code>base = base-&gt; q1</code></p> <pre><code>push loc1\njmp loc2\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#pfunc0-0-v8-0","title":"\u5f53 pfunc0 = 0 \u6216 v8 = 0","text":"<p>\u90fd\u50cf\u662fjmp</p> <pre><code>pfunc0 == 0 -&gt; jmp base-&gt;q1\nv8 == 0 -&gt; jmp base-&gt;q0\nv8 == 1 -&gt; jmp base-&gt;q1\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_2","title":"\u6539\u6539\u7c7b\u578b","text":"<pre><code>ptrace(PTRACE_GETREGS, a1, 0LL, v10);\n</code></pre> <p><code>PTRACE_PEEKDATA</code> </p> <p>\u8fd9\u91cc\u7684v10\u9ed8\u8ba4\u662f<code>char v10[128]</code> 128\u4e2a8\u4f4d=16\u4e2a64\u4f4d\uff0c\u5e94\u8be5\u662f <code>__int64 v10[16]</code></p> <p>\u901a\u8fc7chatgpt\uff0c\u7ed9\u51fa\u4e86v10\u7684\u7ed3\u6784\u4f53\uff1auser_regs_struct</p> <p>\u7136\u540e\u67e5\u6e90\u7801\uff0c\u5f97\u5230\u4e0b\u9762\u7ed3\u6784\u4f53\uff0c\u5bfc\u5165IDA\uff08\u4e0d\u80fd\u91cd\u540d\uff0c\u6240\u4ee5\u7528ok\uff09</p> <pre><code>struct ok_regs_struct\n{\n   unsigned long long int r15;\n   unsigned long long int r14;\n   unsigned long long int r13;\n   unsigned long long int r12;\n   unsigned long long int rbp;\n   unsigned long long int rbx;\n   unsigned long long int r11;\n   unsigned long long int r10;\n   unsigned long long int r9;\n   unsigned long long int r8;\n   unsigned long long int rax;\n   unsigned long long int rcx;\n   unsigned long long int rdx;\n   unsigned long long int rsi;\n   unsigned long long int rdi;\n   unsigned long long int orig_rax;\n   unsigned long long int rip;\n   unsigned long long int cs;\n   unsigned long long int eflags;\n   unsigned long long int rsp;\n   unsigned long long int ss;\n   unsigned long long int fs_base;\n   unsigned long long int gs_base;\n   unsigned long long int ds;\n   unsigned long long int es;\n   unsigned long long int fs;\n   unsigned long long int gs;\n};\n</code></pre> <p>\u5f88\u591a\u4e1c\u897f\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u6bd4\u5982</p> <p></p> <p>\u8fd9\u91cc\u5c31\u662f\u8ba9\u5b50\u8fdb\u7a0b\u8df3\u8f6c\u5230 <code>base-&gt;q1</code> \uff0c\u7136\u540e\u628a <code>base-&gt;q3</code> push\u5230\u5b50\u8fdb\u7a0b\u7684\u6808\u4e2d\uff0c\u5c31\u662f <code>call</code> </p> <p>\u7b2c\u4e00\u6b213\u5c31\u662f <code>puts</code> \uff0c\u6b63\u786e</p> <p>\u8fd9\u91cc\u7684 <code>base-&gt;q3</code> \u662f <code>4012CB</code> </p> <p></p> <p></p> <p>CC \u5c31\u662f <code>int 3</code> \u7528\u4e8e\u89e6\u53d1\u5f02\u5e38\u7684</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_3","title":"\u5927\u6982\u77e5\u9053\u4e86\uff0c\u6709\u4ee5\u4e0b\u96be\u70b9\uff1a","text":"<ol> <li>\u63a7\u5236\u6d41\u5e73\u5766\u5316\u2014\u2014\u7531\u7236\u8fdb\u7a0b\u7edf\u4e00\u8fdb\u884c\u4ee3\u7801\u6d41\u7a0b\u5206\u53d1</li> <li>\u865a\u62df\u673a\u5206\u6790\u2014\u2014jmp\u3001call\u3001push\u3001pop\u5747\u7531\u7236\u8fdb\u7a0b\u64cd\u4f5c</li> <li>\u591a\u7ebf\u7a0b\u4ea4\u4e92\u2014\u2014\u5b50\u8fdb\u7a0b\u7684\u90e8\u5206\u6808\u64cd\u4f5c\uff0c\u7528\u7236\u8fdb\u7a0b\u6a21\u62df</li> </ol> <p>\u76ee\u524d\u60f3\u5230\u7684\u65b9\u6848\u662f\u7528frida hook\u6bcf\u4e00\u4e2a\u6d41\u7a0b\uff0c\u7136\u540e\u628a\u7a0b\u5e8f\u7684\u6d41\u7a0b\u7528\u6b63\u5e38\u7684\u6c47\u7f16\u8868\u793a</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#frida","title":"Frida\u5b66\u4e60","text":"<p>\u5b98\u65b9\u4ed3\u5e93\uff1afrida/frida: Clone this repo to build Frida (github.com)</p> <p>\u5b98\u65b9\u6587\u6863\uff1aQuick-start guide | Frida \u2022 A world-class dynamic instrumentation toolkit</p> <pre><code>pip install frida-tools # CLI tools\npip install frida       # Python bindings\nnpm install frida       # Node.js bindings\n</code></pre> <p>Release Frida 16.2.1 \u00b7 frida/frida (github.com)</p> <p>\u4e0b\u8f7d frida-server-16.2.1-linux-x86_64.xz</p> <p>\u5982\u4f55hook\u51fd\u6570\uff1aFunctions | Frida \u2022 A world-class dynamic instrumentation toolkit</p> <pre><code>-f TARGET # \u8fd0\u884c\u5e76\u9644\u52a0\n</code></pre> <p>frida \u5e38\u7528\u7684\u4e00\u4e9bdemo \u6253\u5370native \u51fd\u6570\u7684\u5806\u6808 \u53c2\u6570,\u8fd4\u56de\u503c \u7b49_frida \u6253\u5370\u8c03\u7528\u5806\u6808-CSDN\u535a\u5ba2</p> <p>\u7a81\u7136\u53d1\u73b0\uff0c\u7236\u8fdb\u7a0b\u7684\u5806\u6808\u64cd\u4f5c\u548c\u5b50\u8fdb\u7a0b\u6ca1\u5173\u7cfb\uff0c\u53ea\u6709 <code>v10.rip</code> \u7684\u4f5c\u7528\u6700\u5927\uff0c\u53ea\u7528\u5206\u6790 <code>call</code> \u548c <code>jmp</code> \u5c31\u884c</p> <pre><code>frida -f ezre -l frida_hi.js -o frida_hi.log\n</code></pre> <pre><code>// frida\u63d2\u6869\uff0c\u6bcf\u6267\u884c\u5230 0x401AA5 \u4e00\u6b21\u5c31\u8f93\u51fa\u4e00\u6b21hi\nInterceptor.attach(ptr(\"0x401AA5\"), {\n    onEnter: function(args) {\n        console.log(\"call \", this.context.rax);\n    }\n});\n</code></pre> <pre><code>\u276f frida -f ezre -l frida_hi.js -o frida_hi.log\n     ____\n    / _  |   Frida 16.2.1 - A world-class dynamic instrumentation toolkit\n   | (_| |\n    &gt; _  |   Commands:\n   /_/ |_|       help      -&gt; Displays the help system\n   . . . .       object?   -&gt; Display information about 'object'\n   . . . .       exit/quit -&gt; Exit\n   . . . .\n   . . . .   More info at https://frida.re/docs/home/\n   . . . .\n   . . . .   Connected to Local System (id=local)\nSpawned `ezre`. Resuming main thread!                                   \nInput your flag:\ncall  0x4010c0\ncall  0x4010f0\n[Local::ezre ]-&gt; Error!\ncall  0x4010c0\nProcess terminated\n[Local::ezre ]-&gt;\nWARNING: your terminal doesn't support cursor position requests (CPR).\n\nThank you for using Frida!\n</code></pre> <p>\u770b\u4e86\u4e0b\uff0c <code>0x4010c0</code> \u662f <code>puts</code> \uff0c <code>0x4010f0</code> \u662f <code>read</code> \uff0c\u6b63\u786e\u7684</p> <p>\u7a0b\u5e8f\u4f1a\u7531\u4e8e\u6ca1\u6709read\u5230\u4e1c\u897f\u800c\u6b7b\u5faa\u73af+\u505c\u4e0b\u6765\uff0c\u6240\u4ee5\u8fd9\u91cc\u770b\u770b\u80fd\u4e0d\u80fdhook read\u51fd\u6570</p> <p>\u4e0d\u592a\u597dhook\uff0c\u56e0\u4e3aread\u51fd\u6570\u6267\u884c\u903b\u8f91\u53d1\u751f\u5728\u5b50\u8fdb\u7a0b\uff0c\u53ea\u80fdpatch\u4e86</p> <ul> <li>\u4f7f\u7528frida\u6765spawn Fork \u7684\u5b50\u8fdb\u7a0b - \u300e\u8f6f\u4ef6\u8c03\u8bd5\u533a\u300f - \u543e\u7231\u7834\u89e3 - LCG - LSG |\u5b89\u5353\u7834\u89e3|\u75c5\u6bd2\u5206\u6790|www.52pojie.cn</li> <li>frida-python/examples/child_gating.py at main \u00b7 frida/frida-python (github.com)</li> <li>FRIDA-API\u4f7f\u7528\u7bc7\uff1arpc\u3001Process\u3001Module\u3001Memory\u4f7f\u7528\u65b9\u6cd5\u53ca\u793a\u4f8b - \u77e5\u4e4e (zhihu.com)</li> <li>Frida basics - Frida HandBook (learnfrida.info)</li> </ul> <p>\u627e\u5230\u4e86hook\u5b50\u8fdb\u7a0b\u7684\u8d44\u6599\uff0c\u6210\u529fhook\u5230read</p> <pre><code>on read( 0x0 , 0x7ffed821f9a0 , 0x2b )\n</code></pre> <p>\u957f\u5ea6\u662f0x2b - 43\uff0c0x0\u5e94\u8be5\u662f\u6807\u51c6\u8f93\u5165\u6d41</p> <pre><code>buf_ptr = ptr(args[1]); // \u5f80 read \u7684 buf \u4e2d\u5199\u5165\u6570\u636e\nbuf_ptr.writeUtf8String(\"aaaaaaaa\");\n</code></pre> <p>\u6253\u5370\u6307\u5b9a\u5730\u5740\u7684\u5185\u5b58\u72b6\u51b5</p> <pre><code>console.log(hexdump(ptr(0x401123), {\n            offset: 0,\n            length: 8,\n            header: true,\n            ansi: false\n        }));\n</code></pre> <p>\u53d1\u73b0\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8fd9\u90e8\u5206\u4ee3\u7801\u88ab\u4fee\u6539\u4e86</p> <p></p> <p></p> <p>\u76f4\u63a5\u628a\u4fee\u6539\u540e\u7684bytes patch\u4e4b\u540e\uff0c\u6c47\u7f16\u662f\uff1a</p> <p></p> <p>\u76f4\u63a5\u88ab\u6539\u6210jmp\u4e86\uff0c\u5f97\u60f3\u529e\u6cd5\u76f4\u63a5ret</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_4","title":"\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5","text":"<p>\u5728call read \u4e4b\u524dhook\u4e00\u4e0b\uff0c\u62ff\u5230\u65e5\u5fd7\uff0c\u7136\u540e\u6b63\u5e38\u8fd0\u884c\u7a0b\u5e8f\uff0c\u7406\u8bba\u4e0a\u6765\u8bf4\u4f1a\u5361\u5728read\uff0c\u8fd9\u65f6\u5019\u518dhook\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u62ff\u5230\u4e4b\u540e\u7684\u65e5\u5fd7\u4e86</p> <pre><code>frida -l frida_hi.js -o hook_part1.log\n./ezre\n</code></pre> <pre><code>\u276f frida -n ezre\n     ____\n    / _  |   Frida 16.2.1 - A world-class dynamic instrumentation toolkit\n   | (_| |\n    &gt; _  |   Commands:\n   /_/ |_|       help      -&gt; Displays the help system\n   . . . .       object?   -&gt; Display information about 'object'\n   . . . .       exit/quit -&gt; Exit\n   . . . .\n   . . . .   More info at https://frida.re/docs/home/\n   . . . .\n   . . . .   Connected to Local System (id=local)\nFailed to spawn: ambiguous name; it matches: ezre (pid: 21768), ezre (pid: 21769)\n</code></pre> <p>\u8fd9\u6837\u53ef\u4ee5\u770b\u4e24\u4e2apid\uff0c\u7b2c\u4e8c\u4e2a\u662f\u5b50\u8fdb\u7a0b\u7684\uff0c\u8fd9\u91cchook\u7b2c\u4e00\u4e2a</p> <p>\u62ff\u5230\u4e86\uff0c\u5176\u5b9e\u5173\u952e\u90e8\u5206\u5c31\u662f part2\uff0c\u7b2c\u4e00\u90e8\u5206\u53ea\u8c03\u7528\u4e86 call puts \u548c call read</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_5","title":"\u81ea\u52a8\u5316\u8df3\u8f6c\u4ee3\u7801","text":"<pre><code>import ida_kernwin\n\n# \u8df3\u8f6c\u5230\u6307\u5b9a\u5730\u5740\nida_kernwin.jumpto(0x40130d)\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_6","title":"\u6b63\u5411\u5206\u6790\u6709\u70b9\u96be","text":"<p>\u4ece <code>Error</code> \u53cd\u63a8</p> <pre><code>jmp  0x4013ec\njmp  0x401458\njmp  0x401486\njmp  0x4014e9\njmp  0x401266\njmp  0x401410   // cmp\njmp  0x4012b2   // Error\ncall  0x4010c0  // puts\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#401410","title":"401410","text":"<pre><code>.text:0000000000401410\n.text:0000000000401410             loc_401410:\n.text:0000000000401410 8B 45 AC    mov     eax, [rbp+var_54]\n.text:0000000000401413 48 98       cdqe                    ; EAX -&gt; RAX (with sign)\n.text:0000000000401415 48 8D 15 64 lea     rdx, byte_405880 ; Load Effective Address\n.text:0000000000401415 44 00 00\n.text:000000000040141C 0F B6 14 10 movzx   edx, byte ptr [rax+rdx] ; Move with Zero-Extend\n.text:0000000000401420 8B 45 AC    mov     eax, [rbp+var_54]\n.text:0000000000401423 48 98       cdqe                    ; EAX -&gt; RAX (with sign)\n.text:0000000000401425 0F B6 44 05 movzx   eax, [rbp+rax+var_40] ; Move with Zero-Extend\n.text:0000000000401425 C0\n.text:000000000040142A 38 C2       cmp     dl, al          ; Compare Two Operands\n.text:000000000040142C CC          int     3 \n</code></pre> <p>\u5f88\u50cf\u4e86\uff0c\u8fd9\u91cc\u7684 <code>cmp dl, al</code> \u5c31\u662f\u6838\u5fc3\u6bd4\u8f83\u6c47\u7f16\u4ee3\u7801\uff0c\u76f4\u63a5hook\u7136\u540e\u6253\u5370</p> <p>Python\u91cc\u7684spawn\u53ef\u4ee5\u8bbe\u7f6estdin\u4e3a<code>inherit</code> \uff0c\u5c31\u53ef\u4ee5\u7ee7\u627f sys.stdin</p> <pre><code>pid = self._device.spawn(argv, env=env, stdio=\"inherit\")\n</code></pre> <p>\u8fd9\u91cc\u7684dl\u662f\u6052\u5b9a\u7684\uff0c\u548cdx\u7684\u503c\u4e00\u6837\uff0c\u662f1f\uff0c\u6240\u4ee5\u5bc6\u6587\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f <code>1f</code></p> <pre><code>Interceptor.attach(ptr(\"0x401AA5\"), {\n    onEnter: function(args) {\n        console.log(\"call \", this.context.rax);\n    }\n});\n\n/*\n.text:0000000000401903             loc_401903:\n.text:0000000000401903 48 8D 95 80 lea     rdx, [rbp+var_280] ; \u4ece\u5b50\u8fdb\u7a0b\u83b7\u53d6\u5bc4\u5b58\u5668\n.text:0000000000401903 FD FF FF\n.text:000000000040190A 8B 85 4C FD mov     eax, [rbp+var_2B4]\n.text:000000000040190A FF FF\n*/\nInterceptor.attach(ptr(\"0x40190A\"), {\n    onEnter: function(args) {\n        base_v10 = ptr(this.context.rdx);\n    }\n});\nvar base_v10 = ptr(0);\n\n// ptrace(PTRACE_GETREGS, a1, 0LL, &amp;v10);\nInterceptor.attach(ptr(\"0x401929\"), {\n    onEnter: function(args) {\n        regs = {\n            r15: base_v10.add(0x00).readULong(),\n            r14: base_v10.add(0x08).readULong(),\n            r13: base_v10.add(0x10).readULong(),\n            r12: base_v10.add(0x18).readULong(),\n            rbp: base_v10.add(0x20).readULong(),\n            rbx: base_v10.add(0x28).readULong(),\n            r11: base_v10.add(0x30).readULong(),\n            r10: base_v10.add(0x38).readULong(),\n            r9: base_v10.add(0x40).readULong(),\n            r8: base_v10.add(0x48).readULong(),\n            rax: base_v10.add(0x50).readULong(),\n            rcx: base_v10.add(0x58).readULong(),\n            rdx: base_v10.add(0x60).readULong(),\n            rsi: base_v10.add(0x68).readULong(),\n            rdi: base_v10.add(0x70).readULong(),\n            orig_ra: base_v10.add(0x78).readULong(),\n            rip: base_v10.add(0x80).readULong(),\n            cs: base_v10.add(0x88).readULong(),\n            eflags: base_v10.add(0x90).readULong(),\n            rsp: base_v10.add(0x98).readULong(),\n            ss: base_v10.add(0xA0).readULong(),\n            fs_base: base_v10.add(0xA8).readULong(),\n            gs_base: base_v10.add(0xB0).readULong(),\n            ds: base_v10.add(0xB8).readULong(),\n            es: base_v10.add(0xC0).readULong(),\n            fs: base_v10.add(0xC8).readULong(),\n            gs: base_v10.add(0xD0).readULong(),\n        }\n    } \n})\nvar regs = {\n    r15: 0,\n    r14: 0,\n    r13: 0,\n    r12: 0,\n    rbp: 0,\n    rbx: 0,\n    r11: 0,\n    r10: 0,\n    r9: 0,\n    r8: 0,\n    rax: 0,\n    rcx: 0,\n    rdx: 0,\n    rsi: 0,\n    rdi: 0,\n    orig_ra: 0,\n    rip: 0,\n    cs: 0,\n    eflags: 0,\n    rsp: 0,\n    ss: 0,\n    fs_base: 0,\n    gs_base: 0,\n    ds: 0,\n    es: 0,\n    fs: 0,\n    gs: 0,\n};\n\n// /**\n//  * v10.rip = base_qword-&gt;q3;\n//  */\n// Interceptor.attach(ptr(\"0x401C7D\"), {\n//     onEnter: function(args) {\n//         console.log(\"jmp \", this.context.rax);\n//     }\n// });\n\nInterceptor.attach(ptr(\"0x401930\"), {\n    onEnter: function(args) {\n        if (this.context.rdx == '0x40142d') {\n            console.log(\"\u627e\u5230cmp dl, al\u5728\", this.context.rdx);\n            console.log(\"\u6b64\u65f6 ax = \", regs.rax.toString(16), \" dx = \", regs.rdx.toString(16));\n            console.log(JSON.stringify(regs, null, 2));\n        }\n        // console.log(\"sub p rip = \", this.context.rdx);\n    }\n});\n</code></pre> <pre><code>.text:0000000000401410\n.text:0000000000401410             loc_401410:\n.text:0000000000401410 8B 45 AC    mov     eax, [rbp+var_54]\n.text:0000000000401413 48 98       cdqe                    ; EAX -&gt; RAX (with sign)\n.text:0000000000401415 48 8D 15 64 lea     rdx, byte_405880 ; Load Effective Address\n.text:0000000000401415 44 00 00\n.text:000000000040141C 0F B6 14 10 movzx   edx, byte ptr [rax+rdx] ; Move with Zero-Extend\n.text:0000000000401420 8B 45 AC    mov     eax, [rbp+var_54]\n.text:0000000000401423 48 98       cdqe                    ; EAX -&gt; RAX (with sign)\n.text:0000000000401425 0F B6 44 05 movzx   eax, [rbp+rax+var_40] ; Move with Zero-Extend\n.text:0000000000401425 C0\n.text:000000000040142A 38 C2       cmp     dl, al          ; Compare Two Operands\n.text:000000000040142C CC          int     3\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>mov  eax, [rbp+var_54]</code> <code>[rbp+rax+var_40]</code> \u5c31\u662f\u52a0\u5bc6\u540e\u7684\u6570\u636e\u6240\u5728\uff0c</p> <p><code>var_54</code> \u662f\u4e0b\u6807\uff0c <code>var_40</code> \u662f\u7b2c\u4e00\u4e2a\u5143\u7d20</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#dump","title":"\u5148\u628a\u6240\u6709\u5bc6\u6587dump\u51fa\u6765\u5427","text":"<pre><code>unsigned char ida_chars[] =\n{\n  0x1F, 0x18, 0x0F, 0xA9, 0xE4, 0x3D, 0x7A, 0x3A, 0x4D, 0x17, \n  0xD1, 0x18, 0x10, 0x68, 0x1C, 0x4D, 0x79, 0x19, 0x03, 0x41, \n  0x4B, 0x60, 0x1C, 0x67, 0x5C, 0x38, 0x23, 0x1F, 0x53, 0x00, \n  0x14, 0x4D, 0x19, 0x7A, 0x7B, 0x5D, 0x71, 0x42, 0x3E, 0x37, \n  0x9C, 0x8E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xDD, 0xCC, \n  0xBB, 0xAA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \n  0x00, 0x00, 0x00, 0x00\n};\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#flag","title":"\u7136\u540e\u770b\u770b\u662f\u4ece\u54ea\u91cc\u5199\u5165\u52a0\u5bc6\u540e\u7684flag\u7684","text":"<p>\u53ea\u6709 0x4014cd \u7a0b\u5e8f\u5757\u662f\u5f80 rbp+rax+var_40 \u5199\u4e1c\u897f\u7684\uff0c\u6240\u4ee5hook\u4e00\u4e0b\u8fd9\u91cc\uff08\u5730\u5740\u662f\u4e0b\u4e00\u4e2a\u7a0b\u5e8f\u5757\u7684\u9996\u5730\u5740\uff0c\u5373 0x4014e9 \uff09\uff0c\u8bfb\u53d6\u51fa\u4e0b\u6807\u548c\u5185\u5bb9</p> <p></p> <p>\u662f rax \u548c dl</p> <p>\u6ca1\u4e8b\u4e86\uff0c eax &lt;&lt; 2 \u5c31\u662f\u4e3a\u4e86\u8bbf\u95ee qword \u6570\u7ec4</p> <p>\u5927\u6982\u80fd\u770b\u51fa\u89c4\u5f8b\uff0c\u662f\u628a\u5927\u4e8e 0xF \u7684\u6570\u5148\u52a0\u5bc6+\u538b\u7f29\u5230 0xF \u4ee5\u4e0b\uff0c\u7136\u540e\u518d \u52a0\u5bc6+\u89e3\u538b\u5230 0xF \u4ee5\u4e0a</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_7","title":"\u592a\u96be\u5206\u6790\u4e86","text":"<p>frida\u4fa7\u4fe1\u9053\u7206\u7834</p> <p>\u56e0\u4e3a\u5927\u6982\u770b\u4e86\u4e0b\uff0c\u662f\u5bf9\u5b57\u7b26\u8fdb\u884c\u5355\u4e2a\u52a0\u5bc6\uff0c\u90a3\u5c31\u4e00\u4f4d\u4e00\u4f4d\u7684\u7206\u7834</p> <p>\u7206\u7834\u4e0d\u4e86\uff0c\u904d\u5386\u7b2c\u4e00\u4f4d printable \u90fd\u6ca1\u627e\u5230</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_8","title":"\u6f0f\u5206\u6790\u4e86","text":"<p>\u8fd9\u91cc\u4e5f\u4f1a\u5bfc\u81f4 jmp</p> <p>EFLAGS\u5bc4\u5b58\u5668\uff08\u6807\u5fd7\u5bc4\u5b58\u5668\uff09 - Reverse-xiaoyu - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p></p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#dump_1","title":"Dump\u662f\u6b63\u5e38\u7684","text":"<p>\u5c31\u662f\u5982\u679c\u8f93\u5165\u4e0d\u591f0x29\u4f4d\uff0c\u5c31\u4f1a\u7528\u5230\u672a\u521d\u59cb\u5316\u7684\u5185\u5b58\uff0c\u5bfc\u81f4\u7ed3\u679c\u968f\u673a</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_9","title":"\u601d\u8def","text":"<ol> <li>\u7528idapython\u4eceIDA\u4e2d\u5bfc\u51fa\u6240\u6709\u5b50\u7a0b\u5e8f\u7a0b\u5e8f\u8282\u70b9\u7684\u9996\u5730\u5740\uff0c\u505a\u6210 <code>\u5730\u5740-\u6c47\u7f16</code> \u7684\u5f62\u5f0f</li> <li>hook\u6240\u6709\u8282\u70b9\uff0c\u5728\u5173\u952e\u8282\u70b9\u6253\u5370\u4e00\u4e9b\u6d88\u606f\uff0c\u7136\u540e\u6267\u884c\u4e00\u6b21\u7a0b\u5e8f</li> </ol>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_10","title":"\u6709\u4e2a\u795e\u5947\u7684\u52a0\u5bc6","text":"<p>\u8f93\u51650123456789abcdefghijklmnopqrstuvwxyzABCDE</p> <p>\u6bcf\u8d4b\u503c\u4e00\u6b21flag\uff0c\u5c31\u4ecemap\u4e2d\u62ff\u4e00\u4e2a\u6570\u636e</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_11","title":"\u662f","text":"<p>\u6839\u636e <code>var_44</code> \u6765\u51b3\u5b9a\u4e0b\u4e00\u6b21\u5206\u53d1\uff1a</p> <pre><code>.text:000000000040130D             loc_40130D:\n.text:000000000040130D 8B 45 B0    mov     eax, [rbp+var_50] ; \u4eceqword\u9009\u5230\u76840\n.text:0000000000401310 48 8D 55 A8 lea     rdx, [rbp+var_58] ; [rbp+var_58]\u662f-1\n.text:0000000000401314 8B 4D BC    mov     ecx, [rbp+var_44] ; \u4eceqword\u9009\u5230\u76841\n.text:0000000000401317 89 CE       mov     esi, ecx\n.text:0000000000401319 89 C7       mov     edi, eax\n.text:000000000040131B CC          int     3               ; Trap to Debugger\n</code></pre> <pre><code>.text:0000000000401442 55          push    rbp\n.text:0000000000401443 48 89 E5    mov     rbp, rsp\n.text:0000000000401446 89 7D EC    mov     [rbp+var_14], edi\n.text:0000000000401449 89 75 E8    mov     [rbp-18h], esi ; \u4e3b\u8981\u770b\u8fd9\u4e2a\n.text:000000000040144C 48 89 55 E0 mov     [rbp+var_20], rdx\n.text:0000000000401450 81 7D EC E7 cmp     [rbp+var_14], 3E7h ; Compare Two Operands; 03 E7 \u662f\u5728 qword \u7684\u672b\u7aef\uff0c\u8fd9\u91cc\u662f\u5224\u65ad\u662f\u5426\u7ed3\u5c3e\n\n.text:000000000040126B 48 8B 45 E0 mov     rax, [rbp+var_20]\n.text:000000000040126F 8B 00       mov     eax, [rax]; eax = -1\n\n.text:0000000000401434 48 8B 45 E0 mov     rax, [rbp+var_20]\n.text:0000000000401438 8B 00       mov     eax, [rax]; eax = -1\n.text:000000000040143A 83 F8 06    cmp     eax, 6\n\n.text:0000000000401330 48 8B 45 E0 mov     rax, [rbp+var_20]\n.text:0000000000401334 8B 00       mov     eax, [rax] ;eax = -1\n.text:0000000000401336 8B 55 EC    mov     edx, [rbp+var_14] ; = 3E7h\n.text:0000000000401339 89 C1       mov     ecx, eax  ; -1 FFFFFFFF\n.text:000000000040133B D3 EA       shr     edx, cl ;0        ; Shift Logical Right\n.text:000000000040133D 89 D0       mov     eax, edx \n.text:000000000040133F 83 E0 01    and     eax, 1          ; Logical AND\n.text:0000000000401342 85 C0       test    eax, eax        ; Logical Compare\n\n.text:0000000000401296 48 8B 45 E0 mov     rax, [rbp+var_20]\n.text:000000000040129A 8B 00       mov     eax, [rax] ; -1\n.text:000000000040129C 89 45 FC    mov     dword ptr [rbp+var_8+4], eax ; -1\n\n.text:00000000004013E3 8B 45 FC    mov     eax, dword ptr [rbp+var_8+4]\n\n.text:0000000000401361 5D          pop     rbp\n</code></pre> <pre><code>.text:0000000000401359 89 45 B8    mov     [rbp+var_48], eax\n.text:000000000040135C 83 7D B8 08 cmp     [rbp+var_48], 8 ; Compare Two Operands\n</code></pre> <p>0</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre/#_12","title":"\u53d1\u73b0","text":"<pre><code>jmp 0x40126b  // \n            mov     rax, [rbp+var_20]\n            mov     eax, [rax]\n</code></pre> <p>\u5728 <code>var_44 = 0 , var_58 = 6</code> \u7684\u65f6\u5019\uff0c\u4f1a\u76f4\u63a5\u8df3\u5230 </p> <pre><code>jmp 0x4012c2  // \n            movzx   eax, [rbp+var_15] ; Move with Zero-Extend\n            test    al, al          ; Logical Compare\n</code></pre> <p>\u7136\u540e\u53c8\u770b\u61c2\u4e86\uff0c <code>var_15</code> \u5176\u5b9e\u5c31\u662f <code>var_44 + 3</code> \u4e0a\u9762\u8c03\u7528\u7684\uff08\u5173\u952e\uff0c\u56e0\u4e3a\u67e5\u770b\u4ea4\u53c9\u5f15\u7528\u662f\u770b\u4e0d\u5230 <code>var_15</code> \u7684\u201c\u5199\u201d\u8fc7\u7a0b\u7684\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/","title":"\u3010CISCN2021\u534e\u5357\u3011ezre1","text":"<p>\u76f4\u63a5\u641c\u7d22\u5173\u952e\u8bcd <code>Input your flag</code> \uff0c\u6253\u65ad\u70b9\uff0c\u65ad\u4e0d\u4e0b\u6765</p> <p></p> <p><code>fork</code> \u51fd\u6570\u5f00\u4e86\u4e2a\u5b50\u8fdb\u7a0b\uff0cv4\u662f\u8fd4\u56de\u7684pid\uff0c\u6682\u65f6\u6ca1\u627e\u5230IDA\u8c03\u8bd5\u5b50\u8fdb\u7a0b\u7684\u529e\u6cd5\uff0c\u6240\u4ee5\u65ad\u4e0d\u5230\uff0c\u6709\u77e5\u9053\u7684\u5e08\u5085\u8bf7\u8d50\u6559</p> <p></p> <p>\u5212\u7ebf\u7684\u90e8\u5206\u53ef\u4ee5\u53f3\u952e - <code>Create new struct type</code> \u521b\u5efa\u7ed3\u6784\u4f53\uff0c\u4fbf\u4e8e\u5206\u6790</p> <pre><code>struct struct_qword_4060E0\n{\n  _QWORD q0;\n  _QWORD q1;\n  __int64 (__fastcall *pfunc2)(char *);\n  _QWORD q3;\n};\n</code></pre> <p>ptrace \u7684\u4f7f\u7528 ptrace\u51fd\u6570\u6df1\u5165\u5206\u6790 - \u9ed1\u7bb1 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>\u8fd9\u91cc\u610f\u601d\u662f\u4e3b\u8fdb\u7a0b <code>wait()</code> \u7b49\u5f85\u5b50\u8fdb\u7a0b\u4fe1\u53f7</p> <p>\u5b50\u8fdb\u7a0b\uff1a</p> <p></p> <p>\u6bcf\u8fd0\u884c\u4e00\u4e2a\u7a0b\u5e8f\u5757\uff0c\u90fd\u4f1a <code>int 3</code> \u4e2d\u65ad\u4ea7\u751f\u4e00\u4e2a\u8c03\u8bd5\u4fe1\u53f7</p> <p>\u52a8\u8c03\u7684\u65f6\u5019\u4e5f\u4f1a\u4e00\u76f4\u6536\u5230\u5b50\u8fdb\u7a0b\u7684\u4fe1\u53f7</p> <p></p> <p></p> <p>\u8fd9\u91cc\u70b9 <code>change exception definition</code> </p> <p></p> <p>\u52fe\u4e0a <code>Pass to application</code>\uff0c\u7136\u540e <code>OK - Yes(pass to app)</code></p> <p>\u5efa\u8bae\u53d6\u6d88\u6389 <code>Suspend program</code> \uff0c\u4e0d\u7136\u6bcf\u6267\u884c\u4e00\u4e2a\u7a0b\u5e8f\u5757\u90fd\u4f1a\u8df3\u4e00\u4e2a\u63d0\u793a</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#_1","title":"\u83ab\u540d\u5947\u5999\u7a0b\u5e8f\u5173\u4e86","text":"<p>\u89c2\u5bdf\u5230\u8fd9\u91cc\u6709\u4e2a <code>alarm</code> \uff0cnop\u6389\u6216\u8005patch\u4e00\u4e0b\u628a\u65f6\u95f4\u6539\u5927\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#ptrace","title":"\u5206\u6790ptrace","text":"<pre><code>ptrace(PTRACE_GETREGS, a1, 0LL, v10);\n</code></pre> <p>\u8fd9\u91ccv10\u662f\u4e2a\u7ed3\u6784\u4f53\uff0cIDA\u6ca1\u8bc6\u522b\u51fa\u6765\uff0c<code>sys/user.h&gt;</code> \u7684 <code>user_regs_struct</code></p> <pre><code>struct user_regs_struct\n{\n  __extension__ unsigned long long int r15;\n  __extension__ unsigned long long int r14;\n  __extension__ unsigned long long int r13;\n  __extension__ unsigned long long int r12;\n  __extension__ unsigned long long int rbp;\n  __extension__ unsigned long long int rbx;\n  __extension__ unsigned long long int r11;\n  __extension__ unsigned long long int r10;\n  __extension__ unsigned long long int r9;\n  __extension__ unsigned long long int r8;\n  __extension__ unsigned long long int rax;\n  __extension__ unsigned long long int rcx;\n  __extension__ unsigned long long int rdx;\n  __extension__ unsigned long long int rsi;\n  __extension__ unsigned long long int rdi;\n  __extension__ unsigned long long int orig_rax;\n  __extension__ unsigned long long int rip;\n  __extension__ unsigned long long int cs;\n  __extension__ unsigned long long int eflags;\n  __extension__ unsigned long long int rsp;\n  __extension__ unsigned long long int ss;\n  __extension__ unsigned long long int fs_base;\n  __extension__ unsigned long long int gs_base;\n  __extension__ unsigned long long int ds;\n  __extension__ unsigned long long int es;\n  __extension__ unsigned long long int fs;\n  __extension__ unsigned long long int gs;\n};\n</code></pre> <p>\u5bfc\u5165ida\u4e4b\u540e\uff0c\u597d\u770b\u591a\u4e86</p> <p>\u6ce8\u610f\u4e0d\u80fd\u7528 <code>user_regs_struct</code> \u4f5c\u4e3a\u540d\u79f0\uff0c\u4f1a\u51b2\u7a81\uff0c\u8981\u6539\u4e0b\u540d\u79f0</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#_2","title":"\u9759\u6001/\u52a8\u6001\u5206\u6790","text":"<p>\u76f8\u5f53\u4e8e\u8ba9\u5b50\u7ebf\u7a0b <code>call qword_4060E0-&gt;q1</code></p> <p></p> <p>\u76f8\u5f53\u4e8e\u8ba9\u5b50\u7ebf\u7a0b <code>jmp qword_4060E0</code></p> <p>\u5197\u957f\u67af\u71e5\u7684\u4f53\u529b\u6d3b\uff0c\u5bf9\u88ab\u5e73\u5766\u5316\u7684\u63a7\u5236\u6d41\u8fdb\u884c\u5206\u6790\uff0c\u8fd9\u91cc\u8981\u8fd8\u539f\u51fa\u5b50\u7a0b\u5e8f\u6267\u884c\u6d41\u7a0b\uff0c\u624d\u80fd\u8fdb\u4e00\u6b65\u5206\u6790\uff0c\u4f7f\u7528Frida hook\u6bcf\u4e00\u5904 <code>jmp</code> \u548c <code>call</code></p> <pre><code>Interceptor.attach(ptr(\"0x401AA5\"), {\n    onEnter: function(args) {\n        console.log(\"call \", this.context.rax);\n    }\n});\n\n/**\n * v10.rip = base_qword-&gt;q3;\n */\nInterceptor.attach(ptr(\"0x401C7D\"), {\n    onEnter: function(args) {\n        console.log(\"jmp \", this.context.rax);\n    }\n});\n</code></pre> <pre><code>frida -f ezre -l hook_call_jmp.js --stdio pipe -o hook_call_jmp.log\n</code></pre> <ul> <li><code>-f</code> \u6307\u5b9a\u6587\u4ef6</li> <li><code>-l</code> \u6307\u5b9a\u811a\u672c</li> <li><code>--stdio pipe</code> \u5728\u7a0b\u5e8f <code>read</code> \u7684\u65f6\u5019\u6682\u505c\u7a0b\u5e8f\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5c31\u6ca1\u6cd5\u8f93\u5165\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u63a5\u6536\u5230\u7a7a\u5b57\u7b26\u4e32</li> <li><code>-o</code> \u6307\u5b9a\u8f93\u51fa\u65e5\u5fd7</li> </ul> <p>\u8fd9\u91cc\u968f\u4fbf\u5148\u8f93\u4e2a\u4f46\u662f\u8fd9\u91cc\u8fd8\u662f\u6709\u95ee\u9898\uff0c\u4e0d\u77e5\u9053\u600e\u4e48\u5f80PIPE\u91cc\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u54ce</p> <p>\u76f4\u63a5\u4ece\u5b98\u7f51\u6252\u4e86\u4e2a\u73b0\u6210\u811a\u672c</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#exp","title":"EXP","text":""},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#dump","title":"dump\u51fa\u6765\u7684\u6570\u636e","text":"<p>ezre_data.py</p> <pre><code>byte_dword_405080 = [\n  0x7D, 0x03, 0x00, 0x00, 0xC0, 0x00, 0x00, 0x00, 0x09, 0x00, \n  0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, \n  0x81, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0x81, 0x00, \n  0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0xC1, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x3D, 0x02, \n  0x00, 0x00, 0x82, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x83, 0x00, \n  0x00, 0x00, 0xBD, 0x01, 0x00, 0x00, 0x83, 0x00, 0x00, 0x00, \n  0x08, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x83, 0x00, \n  0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xBD, 0x02, 0x00, 0x00, \n  0x44, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0xC6, 0x02, \n  0x00, 0x00, 0xC4, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, \n  0x7D, 0x03, 0x00, 0x00, 0x85, 0x00, 0x00, 0x00, 0x09, 0x00, \n  0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0xC5, 0x00, 0x00, 0x00, \n  0x06, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0x06, 0x00, \n  0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, \n  0xC6, 0x00, 0x00, 0x00, 0xC7, 0x00, 0x00, 0x00, 0xBD, 0x01, \n  0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, \n  0xC6, 0x03, 0x00, 0x00, 0x87, 0x00, 0x00, 0x00, 0x88, 0x00, \n  0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0xC8, 0x00, 0x00, 0x00, \n  0x04, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0x08, 0x00, \n  0x00, 0x00, 0x89, 0x00, 0x00, 0x00, 0x3D, 0x03, 0x00, 0x00, \n  0x89, 0x00, 0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x00, \n  0x00, 0x00, 0xC9, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, \n  0xBD, 0x03, 0x00, 0x00, 0x8A, 0x00, 0x00, 0x00, 0x0C, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x4A, 0x00, 0x00, 0x00, \n  0x0B, 0x00, 0x00, 0x00, 0xBD, 0x02, 0x00, 0x00, 0xCB, 0x00, \n  0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, \n  0x8B, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0x3D, 0x03, \n  0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0xCC, 0x00, 0x00, 0x00, 0xCD, 0x00, \n  0x00, 0x00, 0xBD, 0x01, 0x00, 0x00, 0x8D, 0x00, 0x00, 0x00, \n  0x07, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0x4D, 0x00, \n  0x00, 0x00, 0x4E, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, \n  0x8E, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0xC6, 0x03, \n  0x00, 0x00, 0x8E, 0x00, 0x00, 0x00, 0x4F, 0x00, 0x00, 0x00, \n  0xFD, 0x02, 0x00, 0x00, 0xCF, 0x00, 0x00, 0x00, 0x04, 0x00, \n  0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0xCF, 0x00, 0x00, 0x00, \n  0xD0, 0x00, 0x00, 0x00, 0xBD, 0x02, 0x00, 0x00, 0x10, 0x00, \n  0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0xD0, 0x00, 0x00, 0x00, 0x91, 0x00, 0x00, 0x00, 0xFD, 0x01, \n  0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0x91, 0x00, 0x00, 0x00, 0x92, 0x00, \n  0x00, 0x00, 0xFD, 0x03, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, \n  0x04, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x52, 0x00, \n  0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0xFD, 0x02, 0x00, 0x00, \n  0x93, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0xC6, 0x03, \n  0x00, 0x00, 0x93, 0x00, 0x00, 0x00, 0xD4, 0x00, 0x00, 0x00, \n  0x3D, 0x03, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x03, 0x00, \n  0x00, 0x00, 0xC6, 0x00, 0x00, 0x00, 0x94, 0x00, 0x00, 0x00, \n  0x95, 0x00, 0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, 0xD5, 0x00, \n  0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0x95, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0xFD, 0x02, \n  0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0xD6, 0x00, 0x00, 0x00, 0xD7, 0x00, \n  0x00, 0x00, 0x7D, 0x02, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, \n  0x0D, 0x00, 0x00, 0x00, 0xC6, 0x00, 0x00, 0x00, 0xD7, 0x00, \n  0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x7D, 0x03, 0x00, 0x00, \n  0x98, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xC6, 0x00, \n  0x00, 0x00, 0xD8, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, \n  0xBD, 0x01, 0x00, 0x00, 0xD9, 0x00, 0x00, 0x00, 0x0A, 0x00, \n  0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x99, 0x00, 0x00, 0x00, \n  0xDA, 0x00, 0x00, 0x00, 0x3D, 0x01, 0x00, 0x00, 0xDA, 0x00, \n  0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, \n  0x9A, 0x00, 0x00, 0x00, 0x9B, 0x00, 0x00, 0x00, 0xBD, 0x02, \n  0x00, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0x9B, 0x00, 0x00, 0x00, 0x5C, 0x00, \n  0x00, 0x00, 0xBD, 0x02, 0x00, 0x00, 0x9C, 0x00, 0x00, 0x00, \n  0x02, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0xDC, 0x00, \n  0x00, 0x00, 0x5D, 0x00, 0x00, 0x00, 0x7D, 0x01, 0x00, 0x00, \n  0x9D, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0xC6, 0x01, \n  0x00, 0x00, 0x9D, 0x00, 0x00, 0x00, 0x5E, 0x00, 0x00, 0x00, \n  0x3D, 0x02, 0x00, 0x00, 0xDE, 0x00, 0x00, 0x00, 0x06, 0x00, \n  0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0x9E, 0x00, 0x00, 0x00, \n  0xDF, 0x00, 0x00, 0x00, 0x7D, 0x02, 0x00, 0x00, 0xDF, 0x00, \n  0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, \n  0x5F, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x3D, 0x01, \n  0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0xA0, 0x00, 0x00, 0x00, 0x61, 0x00, \n  0x00, 0x00, 0x7D, 0x03, 0x00, 0x00, 0x21, 0x00, 0x00, 0x00, \n  0x0E, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0xA1, 0x00, \n  0x00, 0x00, 0xE2, 0x00, 0x00, 0x00, 0xFD, 0x02, 0x00, 0x00, \n  0xE2, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0xC6, 0x01, \n  0x00, 0x00, 0x62, 0x00, 0x00, 0x00, 0x23, 0x00, 0x00, 0x00, \n  0x7D, 0x01, 0x00, 0x00, 0x63, 0x00, 0x00, 0x00, 0x08, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x63, 0x00, 0x00, 0x00, \n  0xE4, 0x00, 0x00, 0x00, 0x3D, 0x01, 0x00, 0x00, 0xA4, 0x00, \n  0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, \n  0xE4, 0x00, 0x00, 0x00, 0xA5, 0x00, 0x00, 0x00, 0xFD, 0x00, \n  0x00, 0x00, 0x25, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, \n  0xC6, 0x03, 0x00, 0x00, 0xE5, 0x00, 0x00, 0x00, 0xE6, 0x00, \n  0x00, 0x00, 0xFD, 0x00, 0x00, 0x00, 0xA6, 0x00, 0x00, 0x00, \n  0x0E, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x26, 0x00, \n  0x00, 0x00, 0x27, 0x00, 0x00, 0x00, 0xFD, 0x03, 0x00, 0x00, \n  0xA7, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x03, \n  0x00, 0x00, 0x67, 0x00, 0x00, 0x00, 0xA8, 0x00, 0x00, 0x00, \n  0xBD, 0x03, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x04, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0xA8, 0x00, 0x00, 0x00, \n  0x69, 0x00, 0x00, 0x00, 0xBD, 0x02, 0x00, 0x00, 0x69, 0x00, \n  0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, \n  0x69, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0xBD, 0x02, \n  0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0xC1, 0x00, \n  0x00, 0x00, 0xFD, 0x01, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, \n  0x08, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0xC1, 0x00, \n  0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x7D, 0x02, 0x00, 0x00, \n  0x82, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x03, \n  0x00, 0x00, 0xC2, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, \n  0x3D, 0x01, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x0A, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x83, 0x00, 0x00, 0x00, \n  0x04, 0x00, 0x00, 0x00, 0xFD, 0x03, 0x00, 0x00, 0x44, 0x00, \n  0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, \n  0xC4, 0x00, 0x00, 0x00, 0x85, 0x00, 0x00, 0x00, 0xBD, 0x03, \n  0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0xC5, 0x00, 0x00, 0x00, 0x86, 0x00, \n  0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, \n  0x05, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x86, 0x00, \n  0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, \n  0x07, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x02, \n  0x00, 0x00, 0x87, 0x00, 0x00, 0x00, 0x88, 0x00, 0x00, 0x00, \n  0xFD, 0x00, 0x00, 0x00, 0x88, 0x00, 0x00, 0x00, 0x0D, 0x00, \n  0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, \n  0x89, 0x00, 0x00, 0x00, 0x7D, 0x02, 0x00, 0x00, 0x49, 0x00, \n  0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0x09, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0x3D, 0x01, \n  0x00, 0x00, 0xCA, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0x4A, 0x00, 0x00, 0x00, 0x0B, 0x00, \n  0x00, 0x00, 0xBD, 0x01, 0x00, 0x00, 0x8B, 0x00, 0x00, 0x00, \n  0x07, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x4B, 0x00, \n  0x00, 0x00, 0xCC, 0x00, 0x00, 0x00, 0x7D, 0x01, 0x00, 0x00, \n  0xCC, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0xC6, 0x01, \n  0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0xCD, 0x00, 0x00, 0x00, \n  0xBD, 0x02, 0x00, 0x00, 0x4D, 0x00, 0x00, 0x00, 0x0A, 0x00, \n  0x00, 0x00, 0xC6, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, \n  0x0E, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0x0E, 0x00, \n  0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, \n  0x4E, 0x00, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0xFD, 0x00, \n  0x00, 0x00, 0x4F, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0x8F, 0x00, 0x00, 0x00, 0x50, 0x00, \n  0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, 0xD0, 0x00, 0x00, 0x00, \n  0x0D, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0x10, 0x00, \n  0x00, 0x00, 0x91, 0x00, 0x00, 0x00, 0xFD, 0x00, 0x00, 0x00, \n  0x11, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0xC6, 0x01, \n  0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, \n  0xBD, 0x01, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x05, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0xD2, 0x00, 0x00, 0x00, \n  0x93, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0x93, 0x00, \n  0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0xC6, 0x00, 0x00, 0x00, \n  0x93, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0xBD, 0x03, \n  0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0x94, 0x00, 0x00, 0x00, 0xD5, 0x00, \n  0x00, 0x00, 0xBD, 0x01, 0x00, 0x00, 0x95, 0x00, 0x00, 0x00, \n  0x0D, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0x15, 0x00, \n  0x00, 0x00, 0xD6, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, \n  0x96, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xC6, 0x02, \n  0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, \n  0xBD, 0x02, 0x00, 0x00, 0xD7, 0x00, 0x00, 0x00, 0x0D, 0x00, \n  0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0xD7, 0x00, 0x00, 0x00, \n  0x18, 0x00, 0x00, 0x00, 0x3D, 0x01, 0x00, 0x00, 0x98, 0x00, \n  0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0xD8, 0x00, 0x00, 0x00, 0x99, 0x00, 0x00, 0x00, 0x7D, 0x02, \n  0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0x99, 0x00, 0x00, 0x00, 0x9A, 0x00, \n  0x00, 0x00, 0x3D, 0x03, 0x00, 0x00, 0xDA, 0x00, 0x00, 0x00, \n  0x0A, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x5A, 0x00, \n  0x00, 0x00, 0x9B, 0x00, 0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, \n  0x5B, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0xC6, 0x00, \n  0x00, 0x00, 0x1B, 0x00, 0x00, 0x00, 0x5C, 0x00, 0x00, 0x00, \n  0x7D, 0x03, 0x00, 0x00, 0x5C, 0x00, 0x00, 0x00, 0x09, 0x00, \n  0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0xDC, 0x00, 0x00, 0x00, \n  0x5D, 0x00, 0x00, 0x00, 0x3D, 0x03, 0x00, 0x00, 0xDD, 0x00, \n  0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0x1D, 0x00, 0x00, 0x00, 0x9E, 0x00, 0x00, 0x00, 0x7D, 0x01, \n  0x00, 0x00, 0xDE, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, \n  0xC6, 0x02, 0x00, 0x00, 0x9E, 0x00, 0x00, 0x00, 0x5F, 0x00, \n  0x00, 0x00, 0xFD, 0x01, 0x00, 0x00, 0x9F, 0x00, 0x00, 0x00, \n  0x05, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, 0xDF, 0x00, \n  0x00, 0x00, 0xE0, 0x00, 0x00, 0x00, 0x7D, 0x01, 0x00, 0x00, \n  0xE0, 0x00, 0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x02, \n  0x00, 0x00, 0xE0, 0x00, 0x00, 0x00, 0x21, 0x00, 0x00, 0x00, \n  0xFD, 0x03, 0x00, 0x00, 0xE1, 0x00, 0x00, 0x00, 0x07, 0x00, \n  0x00, 0x00, 0xC6, 0x00, 0x00, 0x00, 0xA1, 0x00, 0x00, 0x00, \n  0x62, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, 0xA2, 0x00, \n  0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, \n  0x62, 0x00, 0x00, 0x00, 0x63, 0x00, 0x00, 0x00, 0xFD, 0x01, \n  0x00, 0x00, 0x63, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, \n  0xC6, 0x01, 0x00, 0x00, 0xA3, 0x00, 0x00, 0x00, 0xE4, 0x00, \n  0x00, 0x00, 0xFD, 0x01, 0x00, 0x00, 0xE4, 0x00, 0x00, 0x00, \n  0x0D, 0x00, 0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0x24, 0x00, \n  0x00, 0x00, 0x25, 0x00, 0x00, 0x00, 0x3D, 0x02, 0x00, 0x00, \n  0x25, 0x01, 0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0xC6, 0x03, \n  0x00, 0x00, 0xA5, 0x00, 0x00, 0x00, 0xE6, 0x00, 0x00, 0x00, \n  0x7D, 0x01, 0x00, 0x00, 0xE6, 0x00, 0x00, 0x00, 0x05, 0x00, \n  0x00, 0x00, 0xC6, 0x02, 0x00, 0x00, 0xA6, 0x00, 0x00, 0x00, \n  0xA7, 0x00, 0x00, 0x00, 0xBD, 0x03, 0x00, 0x00, 0xA7, 0x00, \n  0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0xC6, 0x01, 0x00, 0x00, \n  0x27, 0x00, 0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x3D, 0x01, \n  0x00, 0x00, 0x68, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, \n  0xC6, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0xE9, 0x00, \n  0x00, 0x00, 0x7D, 0x02, 0x00, 0x00, 0xE9, 0x00, 0x00, 0x00, \n  0x0A, 0x00, 0x00, 0x00, 0xC6, 0x03, 0x00, 0x00, 0xE9, 0x00, \n  0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0xE7, 0x03, 0x00, 0x00, \n  0x38, 0x00, 0x00, 0x00, 0x4E, 0x00, 0x00, 0x00\n]\n\nfrom Crypto.Util.number import bytes_to_long\n\ndword_405080 = []\nfor i in range(len(byte_dword_405080)//4):\n    dword_405080.append(bytes_to_long(bytes(byte_dword_405080[i*4:i*4+4][::-1])))\n\nbyte_405880 = [0x1F, 0x18, 0x0F, 0xA9, 0xE4, 0x3D, 0x7A, 0x3A, 0x4D, 0x17, \n  0xD1, 0x18, 0x10, 0x68, 0x1C, 0x4D, 0x79, 0x19, 0x03, 0x41, \n  0x4B, 0x60, 0x1C, 0x67, 0x5C, 0x38, 0x23, 0x1F, 0x53, 0x00, \n  0x14, 0x4D, 0x19, 0x7A, 0x7B, 0x5D, 0x71, 0x42, 0x3E, 0x37, \n  0x9C, 0x8E, \n]\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#_3","title":"\u52a0\u5bc6\u811a\u672c\uff1a","text":"<pre><code>from ezre_data import dword_405080\n\nflag = list(b\"0123456789abcdefghijklmnopqrstuvwxyzABCDEF\")\n\nflag_val = 0\n\"var_59\"\nflag_tmp = 0\n\"var_44\"\ntmp = 0\n\"var_44+1\"\nkey_index = 0\n\nwhile True:\n    opcode = dword_405080[key_index * 3] # var_50\n\n    if opcode == 0x3E7: break\n\n    flag_tmp = dword_405080[key_index * 3 + 1] # var_44\n    tmp = dword_405080[key_index * 3 + 2]\n    i = flag_tmp &amp; 0x3F\n    var_44_3 = 1\n\n    if (opcode &gt;&gt; 0) &amp; 1:\n        flag_tmp = flag[i]\n\n    if (opcode &gt;&gt; 1) &amp; 1:\n        flag_tmp = flag[i]\n        tmp = flag[tmp &amp; 0x3F]\n\n    while True:\n        if (opcode &gt;&gt; 2) &amp; 1:\n            flag_val = flag_tmp ^ tmp\n\n        if (opcode &gt;&gt; 3) &amp; 1:\n            tmp = flag_tmp &amp; tmp\n\n        if (opcode &gt;&gt; 4) &amp; 1:\n            tmp += tmp\n            var_44_3 = tmp\n\n        if (opcode &gt;&gt; 5) &amp; 1:\n            flag[i] = flag_val\n            print(f\"flag[{hex(i)[2:]}] = {hex(flag_val)[2:]}\")\n            flag_tmp = flag_val\n            if var_44_3 == 0: \n                break\n            else:\n                continue\n\n        if (opcode &gt;&gt; 6) &amp; 1:\n            flag[i] = flag_val\n            print(f\"flag[{hex(i)[2:]}] = {hex(flag_val)[2:]}\")\n            break\n\n    key_index += 1\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2021%E5%8D%8E%E5%8D%97%E3%80%91ezre1/#_4","title":"\u5bf9\u5e94\u89e3\u5bc6\u811a\u672c\uff1a","text":"<pre><code>from ezre_data import dword_405080, byte_405880\n\nflag = list(b\"0123456789abcdefghijklmnopqrstuvwxyzABCDEF\")\nflag = byte_405880\nflag_back = [f for f in flag]\n\nflag_val = 0\n\"var_59\"\nflag_tmp = 0\n\"var_44\"\ntmp = 0\n\"var_44+1\"\n\ndef enc_flag(key_index, flag):\n    while True:\n        opcode = dword_405080[key_index * 3] # var_50\n\n        if opcode == 0x3E7: break\n\n        flag_tmp = dword_405080[key_index * 3 + 1] # var_44\n        tmp = dword_405080[key_index * 3 + 2]\n        i = flag_tmp &amp; 0x3F\n        var_44_3 = 1\n\n        if (opcode &gt;&gt; 0) &amp; 1:\n            flag_tmp = flag[flag_tmp &amp; 0x3F]\n\n        if (opcode &gt;&gt; 1) &amp; 1:\n            flag_tmp = flag[flag_tmp &amp; 0x3F]\n            tmp = flag[tmp &amp; 0x3F]\n\n        while True:\n            if (opcode &gt;&gt; 2) &amp; 1:\n                flag_val = flag_tmp ^ tmp\n\n            if (opcode &gt;&gt; 3) &amp; 1:\n                tmp = flag_tmp &amp; tmp\n\n            if (opcode &gt;&gt; 4) &amp; 1:\n                tmp += tmp\n                var_44_3 = tmp\n\n            if (opcode &gt;&gt; 5) &amp; 1:\n                flag[i] = flag_val\n                flag_tmp = flag_val\n                if var_44_3 == 0: \n                    break\n                else:\n                    continue\n\n            if (opcode &gt;&gt; 6) &amp; 1:\n                flag[i] = flag_val\n                break\n\n        key_index += 1\n\n    return flag\n\nkey_index = 168 - 1\nwhile True:\n    if key_index &lt; 0: break\n\n    found = []\n    flag_tmp = dword_405080[key_index * 3 + 1] # var_44\n    index = flag_tmp &amp; 0x3F\n\n    for j in range(256):\n        new_flag = [(flag[i] if i != index else j) for i in range(len(flag))]\n        try:\n            enc_f = enc_flag(key_index=key_index, flag=new_flag)\n        except Exception as e:\n            continue\n\n        if enc_f == flag_back:\n            found += [j]\n\n    if len(found) == 0:\n        key_index -= 1\n        continue\n\n    flag[index] = found[0]\n    print(f\"flag[{hex(index)[2:]}]\", end=\" = \")\n    print([chr(i) for i in found])\n    key_index -= 1\n\nprint(\"\".join(chr(f) for f in flag))\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2022%E4%B8%9C%E5%8C%97%E3%80%91hana/","title":"\u3010CISCN2022\u4e1c\u5317\u3011hana","text":"<p>\u6587\u4ef6</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2022%E4%B8%9C%E5%8C%97%E3%80%91hana/#_1","title":"\u53c2\u8003","text":"<ul> <li>hana \u9898\u89e3\uff08\u6613\u8bed\u8a00\u9006\u5411\uff09 - S1nyer - \u535a\u5ba2\u56ed \u2014\u2014 \u627e\u51faUPX\u52a0\u58f3\u5f02\u5e38\uff0c\u5de7\u8131\u58f3</li> <li>hana-CSDN\u535a\u5ba2 \u2014\u2014 \u786c\u8131\u58f3\uff0c\u5b66\u4e60\u5b66\u4e60</li> </ul> <p>\u3010CISCN 2022 \u4e1c\u5317\u3011hana | NSSCTF</p> <p>\u9700\u8981\u4e24\u4e2a\u5de5\u5177\uff1a</p> <ul> <li>IDA\u6613\u8bed\u8a00\u53cd\u7f16\u8bd1\u63d2\u4ef6E-Decompiler - \u543e\u7231\u7834\u89e3 </li> <li>\u6613\u8bed\u8a00\u77e5\u8bc6\u5e93 - \u6700\u65b0\u6613\u8bed\u8a00\u5728\u7ebf\u5e2e\u52a9\u624b\u518c (125.la)</li> </ul> <p>IDA\u63d2\u4ef6#\u6613\u8bed\u8a00</p> <p>\u6254\u8fdbDIE\uff0c\u53d1\u73b0\u6709UPX\u7684\u7279\u5f81\uff0c\u4f46\u662f\u65e0\u6cd5\u76f4\u63a5 <code>upx -d</code>\uff0c\u5c1d\u8bd5\u7528 ESP\u5b9a\u5f8b \u624b\u52a8\u8131\u58f3\uff0c\u4f46\u662f\u6ca1\u8131\u5e72\u51c0\uff0c\u6709\u4e9b\u6613\u8bed\u8a00\u51fd\u6570\u8bc6\u522b\u4e0d\u51fa\u6765</p> <p>\u56fd\u8d5b\u8003\u70b9\u91cd\u70b9\u4e00\u822c\u4e0d\u4f1a\u5728\u58f3\u4e0a\uff0c\u53ef\u80fd\u662f\u6539\u51e0\u4e2a\u5b57\u7b26upx\u5c31\u6ca1\u529e\u6cd5\u8bc6\u522b\u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u6b63\u5e38\u7684upx\u6253\u5305\u6587\u4ef6\u5bf9\u6bd4\u4e00\u4e0b</p> <p>\u8fd9\u91cc\u5bf9\u6bd4\u51fa\u6765\uff0c\u4e24\u4e2a\u6bb5\u7684\u540d\u79f0\u662fVMP0\u548cVMP1\uff0c\u6b63\u5e38UPX\u58f3\u5e94\u8be5\u662fUPX0\u548cUPX1\uff0c\u6539\u4e86\u4e4b\u540e\u5c31\u53ef\u4ee5 <code>upx -d</code> \u4e86</p> <p>\u7528\u63d2\u4ef6\u6062\u590d\u4e2d\u6587\u51fd\u6570\u540d\u4e4b\u540e\uff0c\u67e5\u770b <code>\u5b57\u7b26\u96c6\u6bd4\u8f83</code> \u7684\u4ea4\u53c9\u5f15\u7528\uff0c\u7528\u5230\u4e86 <code>\u6570\u636e\u52a0\u5bc6</code> \u51fd\u6570\uff0c\u901a\u8fc7\u67e5\u624b\u518c\uff0c\u8fd9\u662f\u4e2aRC4\u52a0\u5bc6\uff0c\u7136\u540e\u627e\u5230\u5bf9\u5e94\u7684\u5bc6\u94a5\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2022%E4%B8%9C%E5%8C%97%E3%80%91hana/#_2","title":"\u624b\u8131\u58f3","text":"<p>\u8ddf\u7740\u6559\u7a0b www.bilibili.com/video/BV1Gx4y1i7ty</p> <p>\u6254\u8fdbx32dbg\uff0c\u4f46\u662f\u4e00\u76f4F8\u90fd\u6ca1\u6709 <code>pushad</code>\uff0c\u7136\u540e\u4e00\u76f4 <code>\u6267\u884c\u5230\u8fd4\u56de</code> \uff08Ctrl+F9\uff09\u5c31\u53ef\u4ee5\u4e86 </p> <p></p> <p>\u6267\u884c\u5230 <code>pushad</code> \uff08\u628a\u6240\u6709\u5bc4\u5b58\u5668\u538b\u5230\u5806\u6808\uff09\uff0c\u6309F8\u5355\u6b65\u4e00\u6b21\uff0c\u7136\u540e\u89c2\u5bdf\u5bc4\u5b58\u5668</p> <p></p> <p>\u5728\u5de6\u4e0b\u89d2\u5185\u5b58\u533a\u57df Ctrl + G \uff0c\u8f93\u5165 esp\uff0c\u8df3\u5230esp\uff0c\u7136\u540e\u53f3\u952e\u4e0b\u4e00\u4e2a <code>\u786c\u4ef6\u65ad\u70b9</code> - <code>\u8bbf\u95ee\u65ad\u70b9</code> \uff0c\u591a\u5c11\u5b57\u8282\u90fd\u53ef\u4ee5\uff0c\u7136\u540e\u6309 F9 \u8fd0\u884c\uff0c\u5c31\u4f1a\u65ad\u5230\u8fd9\u91cc</p> <p></p> <p>\u5de6\u4e0b\u89d2\u4e5f\u4f1a\u6709\u63d0\u793a\uff1a</p> <p></p> <p><code>jmp hana.45FC55</code> \u662f\u4e00\u4e2a\u5927\u8df3\uff0c\u9009\u4e2d\uff0c\u6309 Enter \u8df3\u8fc7\u53bb</p> <p></p> <p>0045FC55\uff0c\u8fd9\u5c31\u662fOEP\u4e86\uff08\u7a0b\u5e8f\u771f\u6b63\u5165\u53e3\u70b9\uff09\uff0c\u7136\u540e\u8c03\u7528\u81ea\u5e26\u7684\u63d2\u4ef6</p> <p></p> <p></p> <p>OEP \u586b\u4e0a 0045FC55 \uff0c\u7136\u540e\u70b9 <code>\u8f6c\u50a8</code> \uff0c\u4fdd\u5b58\u5230 <code>hana_dump.exe</code> \uff0c\u4e0d\u8fc7\u4e00\u822c\u662f\u4e0d\u80fd\u8fd0\u884c\u7684</p> <p></p> <p>\u5f97\u4fee\u590d\u5bfc\u5165\u8868\uff0c\u7528 x32dbg \u6253\u5f00 <code>hana_dump.exe</code>\uff0c\u7136\u540e\u6253\u5f00\u521a\u624d\u7684\u63d2\u4ef6</p> <p>\u70b9 <code>IAT\u81ea\u52a8\u641c\u7d22</code> - <code>\u83b7\u53d6\u5bfc\u5165</code> \uff0c\u7136\u540e\u5c31\u4f1a\u81ea\u52a8\u641c\u7d22\u5bfc\u5165\u8868\uff0c\u7136\u540e\u70b9\u51fb <code>\u4fee\u590d\u8f6c\u50a8</code>\uff0c\u6253\u5f00 <code>hana_dump.exe</code></p> <p>\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u4ee5 <code>SCY</code> \u7ed3\u5c3e\u7684\u7a0b\u5e8f</p> <p></p> <p>\u8fd9\u65f6\u5019\u5c31\u5df2\u7ecf\u4fee\u590d\u597d\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u53cc\u51fb\u8fd0\u884c</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2022%E5%88%9D%E8%B5%9B%E3%80%91secreeeet/","title":"\u3010CISCN2022\u521d\u8d5b\u3011secreeeet","text":"<p>\u7ed9\u4e86\u4e24\u4e2a\u6587\u4ef6\uff0cexe\u548cpng.enc\uff0c\u89e3\u5bc6</p> <p>\u4ece\u5934\u5f00\u59cb\u5206\u6790\u6bd4\u8f83\u8ff7\uff0c\u5c31\u4ece\u6253\u5f00 <code>flag.png</code> \u5f00\u59cb\u5206\u6790\uff0c\u65b0\u5efa\u4e00\u4e2a <code>flag.png</code> \u5185\u5bb9\u662f <code>aaaaaaaaaa</code> \u7136\u540e\u89c2\u5bdf\u7a0b\u5e8f\u8fd0\u884c\uff0c\u5bf9\u53d8\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u8fd8\u539f\u7b26\u53f7</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2023%E5%88%9D%E8%B5%9B%E3%80%91PwSh/","title":"\u3010CISCN2023\u521d\u8d5b\u3011PwSh","text":"<p>[CISCN 2023 \u521d\u8d5b]PwSh | NSSCTF</p> <p>\u770b\u4e86\u4e0b\uff0c\u5168\u6df7\u6dc6\u4e86\uff0c\u7528\u4e00\u4e2a\u53cd\u6df7\u6dc6\u5668</p> <p>denisugarte/PowerDrive: A tool for de-obfuscating PowerShell scripts (github.com)</p> <p>\u63d0\u793a\u53ef\u80fd\u5305\u542b\u6076\u610f\u4ee3\u7801\uff0c\u7528\u865a\u62df\u673a\u62cd\u5feb\u7167\u3001\u628a\u7f51\u5361\u7981\u4e86</p> <p>\u7528\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884cpwsh</p> <pre><code>Set-Executionpolicy Unrestricted\nImport-Module ./PowerDrive.psm1\n</code></pre> <p>\u5361\u6b7b\u4e86\uff0c\u6362\u4e00\u4e2a</p> <p>Malandrone/PowerDecode: PowerDecode is a PowerShell-based tool that allows to deobfuscate PowerShell scripts obfuscated across multiple layers. The tool performs code dynamic analysis, extracting malware hosting URLs and checking http response.It can also detect if the malware attempts to inject shellcode into memory. (github.com)</p> <p>\u5931\u8d25\uff0c\u518d\u6362</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2023%E5%88%9D%E8%B5%9B%E3%80%91PwSh/#_1","title":"\u8d5b\u535a\u53a8\u5b50","text":"<p>\u770b\u4e86\u4e00\u4e9b\u6587\u7ae0\uff0c\u7a81\u7136\u53d1\u73b0\u8fd9\u73a9\u610f\u8d3c\u5f3a</p> <p>\u53c2\u8003\uff1a - Deobfuscate PowerShell using subtract - CyberChef Recipe 0x4 - Securityinbits - Deobfuscate Script using CyberChef \u2013 Recipe 0x3 - Securityinbits</p> <pre><code>From_Base64('A-Za-z0-9+/=',true,false)\nRaw_Inflate(0,0,'Adaptive',false,false)\n</code></pre> <p>\u4e0a\u9762\u8fd9\u6bb5\u4ee3\u7801\u53ef\u4ee5\u89e3\u538b</p> <p>From Base64, Raw Inflate - CyberChef)</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/%E3%80%90CISCN2023%E5%88%9D%E8%B5%9B%E3%80%91flutter/","title":"\u3010CISCN2023\u521d\u8d5b\u3011flutter","text":"<p>\u770b\u6587\u7ae0\u8bf4\uff0cflutter\u7684\u6240\u6709\u903b\u8f91\u653e\u5728\u4e86 <code>libapp.so</code></p> <p>\u7528ida\u6253\u5f00\uff0c\u641c\u7d22\u5b57\u7b26\u4e32 <code>result</code> \uff0c\u67e5\u770b\u4ea4\u53c9\u5f15\u7528</p> <p>\u8fd9\u91cc\u6ca1\u6cd5\u76f4\u63a5\u67e5\u770b\uff0c\u9700\u8981\u5f80\u4e0a\u7ffb\u4e00\u4e0b\uff0c\u5c31\u4f1a\u6709\u4e00\u4e2a\u5f15\u7528\u5b57\u7b26\u4e32\u7684\u5730\u65b9</p> <p></p> <p>\u7136\u540e\u67e5\u770b\u4ea4\u53c9\u5f15\u7528\uff0c\u627e\u5230\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u5206\u914d\u5b57\u7b26\u4e32\u7684\u5730\u65b9\uff1a</p> <p>\u60f3\u529e\u6cd5</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024/Go/","title":"Go","text":"<p>\u4f7f\u7528strace\u4e00\u628a\u68ad\uff0c\u88ab\u53cd\u8c03\u8bd5\u4e86</p> <pre><code>\u276f strace -o strace.log ./GoReverse\nDebugger detected!\n</code></pre> <p>\u4f46\u662fstrace\u4e5f\u80fd\u770b\u5230\u4e00\u4e9b</p> <p></p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024/gdb_debug/","title":"gdb_debug","text":"<p>flag{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa}</p> <p>\u5355\u5b57\u7b26\u52a0\u5bc6\uff0c\u76f4\u63a5\u5f00\u7206</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024/wasm/","title":"wasm","text":"<p>window\u4e0b\u4e0d\u80fd\u4f7f\u7528wasm2c</p> <p>\u5728linux\u4e0b\u53ef\u4ee5\uff1a</p> <pre><code>sudo apt install wabt\nwasm2c vuln.c\n</code></pre> <p>\u662f\u628a name=abc \u8f93\u5165\u8fdb\u53bb\u5f53\u4f5c\u8f93\u5165</p> <p></p> <p>\u8fd9\u6837\u653e\u8fdb <code>flag.txt</code> \uff0c\u5728 <code>file.txt</code> \u4f1a\u51fa\u73b0\u622a\u65ad</p> <p><code>flag{aaaaaaaaaaaaaaaaaaaaaaaaaa}</code></p> <p>\u957f\u5ea6\u4f30\u8ba1\u5c31\u662f\u8fd9\u4e2a\u4e86</p> <p>\u5c1d\u8bd5\u5bfc\u5165wasm\u5230\u6d4f\u89c8\u5668</p> <p>\u8d3c\u9ebb\u70e6\uff0c\u653e\u5f03</p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024/wasm/#strace","title":"\u4f7f\u7528strace\u5927\u6cd5","text":"<p>\u5b89\u88c5 wasmtime \u4e4b\u540e\uff0c<code>strace -o strace.log wasmtime --dir=. vuln.wasm</code></p>"},{"location":"%E5%88%B7%E9%A2%98/CISCN/2024/where/","title":"Where","text":"<p>C \u5c06C\u4ee3\u7801\u5c01\u88c5\u6210python\u53ef\u4ee5import\u8c03\u7528\u7684so - \u77e5\u4e4e (zhihu.com)</p> <p>\u76f4\u63a5\u5206\u6790\u4ee3\u7801\u6bd4\u8f83\u56f0\u96be\uff0c\u76f4\u63a5strace\u67e5\u770b\u8c03\u7528</p> <p></p> <pre><code>strace -o strace.log python whereistheflag.py\n</code></pre> <p></p> <p>\u8fd9\u91cc\u6bd4\u8f83\u53ef\u4ee5\uff0c\u53bb <code>getrandom</code> \u627e\u627e\u4ea4\u53c9\u5f15\u7528\u2014\u2014\u627e\u4e0d\u5230</p> <p><code>_pyx_pw_11whereThel1b_13check_flag</code></p> <p>\u5728\u5934\u90e8\u5199\u4e00\u4e2a <code>input()</code> \u5c31\u53ef\u4ee5\u9644\u52a0\u8c03\u8bd5\u4e86</p> <p></p> <p>\u8fd9\u91cc\u6709\u70b9\u50cf\u6bd4\u8f83\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\uff0c\u4f46\u662f\u6ca1\u65ad\u5230\uff0c\u770b\u6765\u6709\u6bd4\u8f83\u957f\u5ea6\u6216\u8005\u5176\u4ed6\u7684\u903b\u8f91</p> <pre><code>_Pyx_PyObject_FastCallDict(\u51fd\u6570\uff0c\u53c2\u6570\uff0c\u53c2\u6570\u957f\u5ea6) \u662f\u8c03\u7528\u51fd\u6570\n</code></pre> <p></p> <p>refcnt\u5c31\u662f\u5f15\u7528\u6b21\u6570\uff0c\u548cgc\u56de\u6536\u6709\u5173</p> <p><code>_pyx_pymod_exec_whereThel1b</code> \u662f\u5e38\u91cf\u6c60</p> <p></p> <p>\u6240\u4ee5\u8fd9\u91cc\u7684\u610f\u601d\u662f</p> <p></p> <p>randint(self, 0, 2)</p> <p>\u5173\u4e8eCython\u751f\u6210\u7684so\u52a8\u6001\u94fe\u63a5\u5e93\u9006\u5411_cython \u9006\u5411-CSDN\u535a\u5ba2</p> <pre><code>help(whereThel1b)\n</code></pre> <p></p> <p>\u770b\u8d77\u6765whereistheflag\u51fd\u6570\u662f\u968f\u673a\u7684\uff0c\u4f46\u662ftrytry\u4e0d\u662f\uff0c\u76f4\u63a5\u5206\u6790trytry</p> <p></p> <p>\u8fd9\u91cc\u5c31\u662ftrytry\u7684\u4ee3\u7801</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/SomeNSS/","title":"1. Base64\u81ea\u5b9a\u4e49\u8868","text":"<p>\u7b80\u5355\u5b66\u4e60\u4e0bBase64</p> <p>\u6587\u4ef6</p> <pre><code>v11 += 4;\nv13 = input[v12];\n*(v11 - 4) = aQvejafhmuyjbac[v13 &gt;&gt; 2];\nv14 = input[v12 + 1];\n*(v11 - 3) = aQvejafhmuyjbac[(v14 &gt;&gt; 4) | (16 * v13) &amp; 0x30];\nv15 = input[v12 + 2];\nv12 += 3i64;\n*(v11 - 2) = aQvejafhmuyjbac[(v15 &gt;&gt; 6) | (4 * v14) &amp; 0x3C];\n*(v11 - 1) = aQvejafhmuyjbac[v15 &amp; 0x3F];\n</code></pre> <p>\u8fd9\u91cc\u5c31\u662fbase64\u52a0\u5bc6\uff0c\u5176\u4e2d <code>aQvejafhmuyjbac</code> \u662f\u81ea\u5b9a\u4e49\u7684\u52a0\u5bc6\u8868</p> <p>\u4e58\u6cd5\u5176\u5b9e\u5c31\u662f\u4f4d\u64cd\u4f5c</p> <pre><code>v11 += 4;\nv13 = input[v12];\n*(v11 - 4) = aQvejafhmuyjbac[v13 &gt;&gt; 2];\nv14 = input[v12 + 1];\n*(v11 - 3) = aQvejafhmuyjbac[(v14 &gt;&gt; 4) | (v13 &lt;&lt; 4) &amp; 0b00110000];\nv15 = input[v12 + 2];\nv12 += 3i64;\n*(v11 - 2) = aQvejafhmuyjbac[(v15 &gt;&gt; 6) | (v14 &lt;&lt; 2) &amp; 0b00111100];\n*(v11 - 1) = aQvejafhmuyjbac[v15 &amp; 0x3F];\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/SomeNSS/#_1","title":"\u4ee3\u7801","text":"<pre><code>import base64\n\nenc = '5Mc58bPHLiAx7J8ocJIlaVUxaJvMcoYMaoPMaOfg15c475tscHfM/8=='\ntable = 'qvEJAfHmUYjBac+u8Ph5n9Od17FrICL/X0gVtM4Qk6T2z3wNSsyoebilxWKGZpRD'\nreal_table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nprint(len(table))\nprint(len(real_table))\n\nresult = ''\nfor c in enc:\n    if c == '=':\n        result += '='\n    else:\n        result += real_table[table.index(c)]\n\nprint(base64.b64decode(result))\n# \u8fd9\u91cc\u6362\u6210\n# print(base64.b64decode(enc.translate(str.maketrans(table, real_table))))\n# \u4e5f\u53ef\u4ee5\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/SomeNSS/#2","title":"2. \u6a21\u7684\u9006\u8fd0\u7b97","text":"<pre><code>flag = 'xxxxxxxxxxxxxxxxxxxxx'\ns = 'wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;'\nresult = ''\nfor i in range(len(flag)):\n    s1 = ord(flag[i])//17 # \u6700\u5927\u7684ascii\u7801 // 17 = 7\uff0cs1\u7684\u8303\u56f4\u662f0-7\n    s2 = ord(flag[i])%17 # s2 \u7684\u8303\u56f40 - 16\n    result += s[(s1+i)%34]+s[-(s2+i+1)%34] # \u5b57\u7b26\u62fc\u63a5\nprint(result)\n# result = 'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i'\n\n#\u9898\u76ee\u4e3a\u4ee5\u4e0a\u90e8\u5206\n\nenc_flag = 'v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i'\nresult = ''\nfor i in range(0, len(enc_flag), 2):\n    i_origin = i // 2\n    s1 = (s.index(enc_flag[i]) - i_origin) % 34\n    s2 = (-(s.index(enc_flag[i + 1]) - 34) - i_origin - 1) % 34\n    result += chr(s1 * 17 + s2)\n\nprint(result)\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/SomeNSS/#3-wordy","title":"3. Wordy","text":"<p>\u4f7f\u7528ida\u770b\u4e0d\u51fa\u4ec0\u4e48\u4e1c\u897f\uff0c\u52a8\u6001\u8c03\u8bd5\u4e00\u4e0b</p> <p>\u6587\u4ef6</p> <p>\u628a <code>ida\u76ee\u5f55/dbgsrv/linux_server64</code> \u6254\u8fdbwsl\uff0c\u7136\u540e\u8fd0\u884c</p> <ul> <li>ida\u91cc\u9009\u62e9Debugger-Remote Linux Debugger\uff0c</li> <li>Debugger-Process Options\uff0c\u586b\u4e0aip:port</li> <li>Debugger-Start Process\u5373\u53ef</li> </ul> <p>\u8c03\u8bd5\u53d1\u73b0\uff0cjmp\u547d\u4ee4\u975e\u5e38\u5947\u602a\uff0c\u5bfc\u81f4\u65e0\u6cd5\u4e00\u6b21\u6027\u53cd\u6c47\u7f16\uff0c\u53ea\u80fd\u8fb9\u8c03\u8bd5\u8fb9\u53cd\u6c47\u7f16</p> <p>\u8fd9\u5c5e\u4e8e\u82b1\u6307\u4ee4\u7684\u4e00\u79cd</p> <p>\u4f46\u8fd9\u9898\u6bd4\u8f83\u7b80\u5355\uff0c\u4e00\u76f4\u5728 <code>putchar</code>\uff0c\u6240\u4ee5\u4e00\u8fb9\u641c\u7d22 <code>0xBF</code>\uff0c\u4e00\u8fb9\u6309C\u53cd\u6c47\u7f16</p> <p>\u5728\u7a0b\u5e8f\u8f83\u672b\u5c3e\u7684\u5730\u65b9\u5c31\u53ef\u4ee5\u627e\u5230flag</p> <p>\u770b\u4e86\u4e0b\u5176\u4ed6\u5e08\u5085\u7684wp</p> <p>\u8fd0\u884cidapython\u811a\u672c\uff0c\u5373\u53ef\u4e00\u6b21\u6027\u53bb\u9664\u6389\u82b1\u6307\u4ee4</p> <pre><code>start = 0x55BE0E39D136\nend = 0x55BE0E39F100\nfor i in range(start, end):\n    if get_wide_byte(i) == 0xEB and get_wide_byte(i + 1) == 0xFF:\n        patch_byte(i, 0x90) # nop\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/","title":"\u53cc\u6e38\u620f","text":"<p>\u987a\u4fbf\u5b66\u4e0bCE</p> <p>\u6587\u4ef6</p> <p>\u539f\u9898\u5730\u5740\u3010NSSCTF\u3011</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#_2","title":"\u6982\u89c8","text":"<p>\u4e24\u79cd\u65b9\u6cd5</p> <ol> <li>\u3010\u4f20\u9001\u95e8\u3011 \u9759\u6001\u5206\u6790+Cheat Engine\uff08\u975e\u5e38\u89c4\u89e3\u6cd5\uff09</li> <li>\u3010\u4f20\u9001\u95e8\u3011 \u7eaf\u9759\u6001\u5206\u6790\uff08\u5e38\u89c4\u89e3\u6cd5\uff09</li> </ol>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#1-ce","title":"1. CE","text":""},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#part0","title":"Part.0 \u9759\u6001\u5206\u6790","text":"<p>\u5c1d\u8bd5\u76f4\u63a5\u6254\u8fdbida\uff0c\u7136\u540e\u4ece\u5934\u5f00\u59cb\u5206\u6790</p> <p>\u6765\u81ea\u672a\u6765\u7684\u6211\uff1a\u8fd9\u91cc\u5176\u5b9e\u65b9\u6cd5\u4e0d\u5bf9\uff0c\u76f4\u63a5\u641c\u5b57\u7b26\u4e32\u5c31\u884c</p> <p>\u6709\u70b9\u96be\uff0c\u9759\u6001\u5206\u6790\u4e0d\u51fa\u4ec0\u4e48\u7ed3\u679c</p> <p>\u53ea\u627e\u5230\u4e86\u4e00\u4e9b\u7ebf\u7d22\uff1a</p> <ul> <li><code>the first game tell the score</code></li> <li><code>the score is saving cat's key!</code></li> <li><code>You win.\\nThe flag is HZCTF{md5(path)+score}</code></li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#part1-snake","title":"Part.1 Snake","text":"<p>\u7b2c\u4e00\u4e2a\u662f\u4e00\u4e2a\u8d2a\u5403\u86c7\u6e38\u620f\uff0cCE\u9644\u52a0\u5230\u8fdb\u7a0b\u4e2d</p> <p>\u76f4\u63a5\u641c\u5206\u6570\uff0c\u641c\u4e24\u4e09\u6b21\u5c31\u80fd\u627e\u5230\u5730\u5740</p> <p>\u7136\u540e\u53f3\u952e-&gt;\u5c06\u9009\u4e2d\u7684\u5730\u5740\u6dfb\u52a0\u5230\u5730\u5740\u5217\u8868-&gt;\u53f3\u952e\u5730\u5740\u5217\u8868\u4e2d\u7684\u5730\u5740-&gt;\u627e\u51fa\u662f\u4ec0\u4e48\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u5730\u5740\uff08F5\uff09</p> <p>\u7136\u540e\u5403\u679c\u7136\u540e\u81ea\u6740\uff0c\u4f1a\u51fa\u51e0\u4e2a\u6761\u76ee</p> <pre><code>7FF79350247C - 83 3D 4D080100 64 - cmp dword ptr [7FF793512CD0],64\n7FF7935024B4 - 39 05 16080100  - cmp [7FF793512CD0],eax\n7FF7935024D0 - 8B 05 FA070100  - mov eax,[7FF793512CD0]\n</code></pre> <p>\u9010\u4e2a\u70b9\u51fb\u2014\u2014\u663e\u793a\u53cd\u6c47\u7f16\u7a0b\u5e8f\uff0c\u5728\u7b2c\u4e00\u4e2a\u6761\u76ee\u65c1\u8fb9\u627e\u5230\u4e00\u4e2a\u6bd4\u8f83\u5206\u6570\u7684\u6307\u4ee4\uff1a</p> <pre><code>doublegame.exe+1247C - cmp dword ptr [doublegame.exe+22CD0],64\n</code></pre> <p>\u548c</p> <pre><code>doublegame.exe+1248A - cmp [doublegame.exe+22CD0],00CC07C9 ; 13371337\n</code></pre> <p>\u7136\u540e\u5206\u522b\u5c1d\u8bd5\u5c0664\u548c13371337\u653e\u8fdb\u6570\u503c\uff0c\u5c1d\u8bd5\u540e\u8005\u4e4b\u540e\u5c31\u4f1a\u8df3\u8f6c\u5230\u4e00\u4e2a\u8ff7\u5bab</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#part2-maze","title":"Part.2 Maze","text":"<p>\u7b2c\u4e8c\u4e2a\u662f\u4e00\u4e2a\u8ff7\u5bab\u6e38\u620f\uff0c\u9700\u8981\u8f93\u5165wasd\u6765\u201c\u62ef\u6551\u5c0f\u732b\u201d</p> <pre><code>000000000000000000000\n0 0 0 0     0     0 0\n0 0 0 00000 00000 0 0\n0 0               0 0\n0 000 000 0 000 0 0 0\n0 0     0 0 0   0 0 0\n0 0 0 00000 000 000 0\n0 0 0     0   0 0\n0 000 0 0 000 0 0 0 0\n0     0 0 0 0 0 0 0 0\n0 00000 000 000 0 0 0\n0     0       0   0 0\n000 0 0 0 000 0 0 0 0\n0 0 0 0 0 0 * 0 0 0 0\n0 0000000 0 000 00000\n@   0   0 0         0\n0 0 0 0 0 00000000000\n0 0 0 0             0\n000 0 00000 0 000 000\n0         0 0   0   0\n000000000000000000000\n</code></pre> <p>\u8fd9\u91cc\u7684@\u5c31\u662f\u4eba\uff0c*\u662f\u5c0f\u732b\uff0c\u8def\u5f84\u662f <code>dddssssddwwwwddssddwwwwwwddddssa</code></p> <pre><code>do you know the key to open the door\n</code></pre> <p>\u4ece\u9759\u6001\u5206\u6790\u5f97\u77e5\uff0ckey\u5c31\u662f\u5206\u6570\uff0c<code>the score is saving cat's key!</code> \u537313371337</p> <pre><code>oh,the door open!\n\u606d\u559c\u4f60\u5b8c\u6210\u4e86\u7b2c\u4e00\u4e2a\u4efb\u52a1!\u8bf7\u4ece\u5934\u7528\u6700\u5feb\u7684\u65b9\u5f0f\u628a\u732b\u5e26\u51fa\u53bb\n</code></pre> <p>\u7136\u540e\u53c8\u662f\u8d70\u8ff7\u5bab</p> <p>\u5b8c\u6574\u8def\u5f84\uff1a<code>dddssssddwwwwddssddwwwwwwddddssaassddddwwwwddwwwwddd</code></p> <pre><code>You win.\nThe flag is HZCTF{md5(path)+score}\n</code></pre> <p>\u8ba1\u7b97\u5373\u5f97flag\uff0c\u6ce8\u610f\u8fd9\u91cc\u7684md5\u9700\u8981\u5168\u5c0f\u5199</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/doublegame/#2","title":"2. \u7eaf\u9759\u6001\u5206\u6790","text":"<p>\u770b\u5e08\u5085\u7684wp\u5b66\u5230\u7684\uff0c\u4e00\u5f00\u59cb\u6ca1\u60f3\u5230</p> <p>\u641c\u7d22\u5b57\u7b26\u4e32 <code>Game over</code>\uff0c\u53cc\u51fb\u5f15\u7528</p> <pre><code>if ( dword_140022CD0 &gt; 13371337 ) sub_14001136B();\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>sub_14001136B</code> \u70b9\u8fdb\u53bb\uff0c\u662f\u6253\u5370\u8ff7\u5bab\u7684\u4ee3\u7801</p> <p>\u6c47\u7f16\u4ee3\u7801\u662f</p> <pre><code>.text:0000000140012494                 jle     short loc_1400124A7\n.text:0000000140012496                 call    sub_14001136B\n</code></pre> <p>\u76f4\u63a5<code>&lt;Ctrl-N&gt;</code> nop\u6389jle\u5c31\u884c</p> <p>\u7136\u540e\u5c31\u662f\u8d70\u8ff7\u5bab\uff0c\u7565</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/","title":"ezvm","text":"<p>\u6bd4\u8f83ez\u7684vm \u865a\u62df\u673a\u521d\u63a2</p> <p>\u539f\u94fe\u63a5\u3010NSSCTF\u3011ezvm</p> <p>\u6587\u4ef6</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#_1","title":"\u524d\u7f6e\u77e5\u8bc6","text":"<p>\u53c2\u8003\uff1a\u3010\u770b\u96ea\u8bba\u575b\u3011\u5bf9VM\u9006\u5411\u7684\u5206\u6790(CTF)</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#vm-re","title":"\u7b80\u5355\u7684vm-re\u6846\u67b6","text":"<p>\u865a\u62df\u673a\u5c31\u662f\u8981\u53bb\u6a21\u4eff\u4e00\u4e2a\u673a\u5668\uff0c\u8ba9\u673a\u5668\u53bb\u6267\u884c\u4e00\u4e2a\u6587\u4ef6</p> <p>\u5b83\u9700\u8981\u5bc4\u5b58\u5668\u548c\u5806\u6808\uff0c\u6a21\u62df\u4e00\u4e2aCPU\u4e0d\u65ad\u53bb\u8bfb\u53d6\u6307\u4ee4\u2014\u2014\u4ee5\u5faa\u73af\u7684\u5f62\u5f0f</p> <p>1.\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u5206\u914d\u5982\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>\u4f2a\u5806\u6808</li> <li>\u4f2a\u5bc4\u5b58\u5668</li> <li>\u5b57\u7b26\u4e32</li> </ul> <p>\u8fd9\u91cc\u5c31\u6784\u6210\u4e86CPU+\u5185\u5b58</p> <p>2.\u6a21\u62df\u4e00\u4e2aCPU\u8bfb\u53d6\u6307\u4ee4\u7684\u5f62\u5f0f(dispatcher)\u53bb\u5199\u4e3b\u7a0b\u5e8f</p> <p>\u4e0d\u65ad\u7684\u53bb\u8bfb\u53d6\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\u6216\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4(\u4f2a \u673a\u5668\u7801opcode)\uff0c\u7136\u540e\u6267\u884c\u6307\u4ee4opcode\u6240\u5bf9\u5e94\u7684\u4e00\u4e9b\u51fd\u6570(\u5176\u5b9e\u8fd9\u4e9b\u51fd\u6570\u53ef\u4ee5\u7406\u89e3\u4e3a\u4f2a\u6c47\u7f16\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u6bd4\u5982\u5c31\u50cf\u4e00\u4e9badd,sub,pop,push,jmp\u7b49\u64cd\u4f5c)\uff0c\u8fd9\u6837\u4e0b\u6765\u5c31\u53ef\u4ee5\u4e0e\u771f\u5b9e\u7684\u7a0b\u5e8f\u6267\u884c\u76f8\u5dee\u65e0\u51e0</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#_2","title":"\u76ee\u6807","text":"<p>\u628a\u6240\u6709\u4f2aopcode\u5168\u90e8\u5206\u6790\u51fa\u6765</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#_3","title":"\u5206\u6790","text":"<p>\u641c\u96c6\u7ebf\u7d22\uff0c\u5206\u6790opcode</p> <p></p> <p>\u56fe\uff1a\u5de8\u5927\u7684switch</p> <pre><code>while ( 1 )\n{\n    v3 = dword_49F020[dword_49F020[0] + 109];\n    if ( v3 == -1 )\n    return 0;\n    switch ( v3 )\n    {\n</code></pre> <p>\u6839\u636e <code>v3</code> \u6765 <code>switch</code> \u8981\u6267\u884c\u7684\u51fd\u6570\uff0c\u53ef\u77e5\u8fd9\u91cc <code>v3</code> \u5c31\u662f opcode\uff0c\u90a3\u4e48 <code>dword_49F020[dword_49F020[0] + 109]</code> \u5c31\u662f <code>opcode_list</code>\uff0c</p> <p><code>dword_49F020[0]</code> \u5927\u6982\u7387\u662f <code>vm_eip</code></p> <p>\u52a8\u6001\u8c03\u8bd5\uff0c\u627e\u5230<code>opcode_list</code>\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u7136\u540e idapython dump \u4e0b\u6765\uff0c\u811a\u672c\u5982\u4e0b</p> <pre><code>start = 0x49F1D4\nend = 0x49F2D8 # \u8fd9\u91cc\u5168\u662fFFFF\uff0c\u5c31\u662f\u7ec8\u70b9\n\nresult = []\nfor i in range(start, end, 4):\n    cmd_index = get_wide_dword(i)\n    result.append(hex(cmd_index))\n\nprint(','.join(result))\n\n# \u7ed3\u679c\n\"\"\"\n0x12,0x8,0x12,0x9,0x10,0x4,0x1,0xf,0xd,0x2,0x12,0x8,0x12,0x9,0x0,0x4,0xf,0xd,0x12,0x9,0x12,0xa,0x13,0x12,0xb,0x15,0x3,0x14,0x1,0x0,0xf,0xd,0x12,0xa,0x12,0x12,0x12,0x8,0x13,0xf,0x7,0x4,0x9,0xd,0x9,0x8,0x5,0x6,0x4,0x1,0x0,0xf,0xd,0x12,0x9,0x12,0x8,0x12,0xa,0x12,0x7,0xf,0xc,0x11,0xe\n\"\"\"\n</code></pre> <p>\u5728\u6bcf\u6b21opcode\u6267\u884c\u7ed3\u675f\uff0cvm_eip\u4e00\u5b9a\u4f1a\u589e\u52a0\uff0c\u6240\u4ee5 <code>dword_49F020</code> \u5c31\u662f vim_eip</p> <p>\u7c7b\u4f3c\u7684\uff0c\u4e00\u70b9\u4e00\u70b9\u5206\u6790\uff0c\u6700\u540e\u5f97\u5230\u4f2a\u5bc4\u5b58\u5668\u7684\u7ed3\u6784\u4f53\u3001\u89e3\u6790\u811a\u672c</p> <pre><code>#include&lt;stdint.h&gt;\n\nstruct vm\n{\n    int32_t vm_eip; // \u865a\u62df\u673a\u7684EIP\u6307\u9488 49F020\n    int32_t vm_esp; // \u865a\u62df\u673a\u7684ESP\u6307\u9488\uff0c\u6808\u5e27\n    int32_t vm_eax; // dword_49F028\n    int32_t vm_ebx; // dword_49F02C\n    int32_t vm_ecx; // dword_49F030\n    int32_t vm_edx; // dword_49F034\n    int32_t vm_esi; // dword_49F038\n    int32_t vm_edi; // dword_49F03C\n    int32_t vm_sign_flag; // sign\u6307\u4ee4\u4e4b\u540e\uff0c\u7ed3\u679c\u5b58\u653e\u5728\u8fd9\u91cc\n};\n</code></pre> <pre><code>opcode_table = {\n    0x0: \"mov ebx, eax\",\n    0x1: \"inc eax\",\n    0x2: \"dec eax\",\n    0x3: \"xor ebx, edi\",\n    0x4: \"push ebx\",\n    0x5: \"push edx\",\n    0x6: \"push esi\",\n\n    0x7: \"pop ebx\",\n    0x8: \"pop edx\",\n    0x9: \"pop esi\",\n    0xa: \"pop eax\",\n    0xb: \"pop edi\",\n\n    0xc: \"jz vm_sign_flag, esi\",\n    0xd: \"jnz vm_sign_flag, esi\",\n\n    0xe: \"jmp eax\",\n    0xf: \"sign ebx, edx\",\n    0x10: \"getchar ebx\",\n    0x11: \"putchar ebx\",\n    0x12: \"pfm ecx\",\n\n#   push [pop from memery]\n#   \u5373 esp++, [vm + esp + 6] = [vm + ecx + CDh], ecx++\n#   \u53ea\u6709\u8fd9\u91cc\u7684\u6570\u636e\u662f\u672a\u77e5\u7684\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u6253\u65ad\u70b9\uff0c\u7136\u540edump\u51fa\u6570\u636e\n\n    0x13: \"mov ebx, vm[ax+9]\",\n    0x14: \"mov vm[ax+9], bx\",\n    0x15: \"add ebx, ebx\"\n}\n\ndef dump():\n    \"\"\"\u8fd9\u6bb5\u811a\u672c\u6254\u5230ida\u91cc\u8fd0\u884c\uff0cdump\u51fa\u6570\u636e\u6bb5\"\"\"\n    start = 0x49F364\n    end = 0x49F4AC # \u540e\u9762\u5168\u662f0\uff0c\u5c31\u662f\u7ec8\u70b9\n\n    result = []\n    for i in range(start, end, 4):\n        cmd_index = get_wide_dword(i)\n        result.append(hex(cmd_index))\n\n    print(','.join(result))\n\ndata_dump = [0xa,0xfffffffb,0x20,0x2f,\n            0xfffffff6,0x0,0x5e,0x46,\n            0x61,0x43,0xe,0x53,\n            0x49,0x1f,0x51,0x5e,\n            0x36,0x37,0x29,0x41,\n            0x63,0x3b,0x64,0x3b,\n            0x15,0x18,0x5b,0x3e,\n            0x22,0x50,0x46,0x5e,\n            0x35,0x4e,0x43,0x23,\n            0x60,0x3b,0x0,0xffffffef,\n            0x15,0x8e,0x88,0xa3,0x99,0xc4,0xa5,0xc3,0xdd,0x19,0xec,0x6c,0x9b,0xf3,0x1b,0x8b,0x5b,0x3e,0x9b,0xf1,0x86,0xf3,0xf4,0xa4,0xf8,0xf8,0x98,0xab,0x86,0x89,0x61,0x22,0xc1,0x2,0x0,0xfffffffa,0x73,0x75,0x63,0x63,0x65,0x73]\n\nopcode_list = [0x12,0x8,0x12,0x9,0x10,0x4,0x1,0xf,0xd,0x2,0x12,0x8,0x12,0x9,0x0,0x4,0xf,0xd,0x12,0x9,0x12,0xa,0x13,0x12,0xb,0x15,0x3,0x14,0x1,0x0,0xf,0xd,0x12,0xa,0x12,0x12,0x12,0x8,0x13,0xf,0x7,0x4,0x9,0xd,0x9,0x8,0x5,0x6,0x4,0x1,0x0,0xf,0xd,0x12,0x9,0x12,0x8,0x12,0xa,0x12,0x7,0xf,0xc,0x11,0xe]\n\nfor opcode_index in opcode_list:\n    print(opcode_table[opcode_index])\n</code></pre> <p>\u7136\u540e\u4f2a\u6c47\u7f16\u6307\u4ee4\u5982\u4e0b</p> <pre><code>00 pfm ecx \n01 pop edx ; 0x0A\uff0c\u6362\u884c\u7b26\n02 pfm ecx\n03 pop esi ; -5\n04 getchar ebx\n05 push ebx\n06 inc eax ; \u8ba1\u7b97\u957f\u5ea6\n07 sign ebx, edx\n08 jnz vm_sign_flag, esi\n\n09 dec eax\n0a pfm ecx \n0b pop edx ; 0x20\n0c pfm ecx\n0d pop esi ; 0x2f\n0e mov ebx, eax ; \u957f\u5ea6\u8f6c\u79fb\n0f push ebx\n10 sign ebx, edx\n11 jnz vm_sign_flag, esi ; \u5982\u679c\u957f\u5ea6\u4e0d\u76f8\u7b49\uff0c\u5c31\u9000\u51fa\uff0c\u6240\u4ee5\u957f\u5ea6\u662f 0x20\n\n12 pfm ecx\n13 pop esi ; -10\n14 pfm ecx\n15 pop eax ; 0x00\n16 mov ebx, vm[ax+9] ; \u5373\u4ece\u6808\u5e95\u5f00\u59cb\u83b7\u53d6\u6570\u636e\n17 pfm ecx\n18 pop edi ; 0x5e\n19 add ebx, ebx ; * 2\n1a xor ebx, edi ; \u5f02\u6216\n1b mov vm[ax+9], bx ; \u7136\u540e\u5b58\u56de\u53bb\n1c inc eax \n\n1d mov ebx, eax\n1e sign ebx, edx\n1f jnz vm_sign_flag, esi ; \u5224\u65ad\u4e0b\u6807\u662f\u5426\u8d85\u8fc7\u957f\u5ea6\n\n20 pfm ecx\n21 pop eax ; 0x00\n22 pfm ecx ; -17\n23 pfm ecx ; 0x15\n24 pfm ecx ; 0x8e\n\n25 pop edx ; 0x8e\n26 mov ebx, vm[ax+9] ; \u4ece\u6808\u5e95\u5f00\u59cb\n27 sign ebx, edx \u68c0\u6d4b \u662f\u5426\u7b49\u4e8eedx\n28 pop ebx ; 0x15\n29 push ebx ; 0x15\n2a pop esi ; 0x15\n2b jnz vm_sign_flag, esi ; \u4e0d\u76f8\u7b49\u5c31\u6254\u51fa\u53bb\uff0ceip + 0x15\n2c pop esi -17\n2d pop edx \n2e push edx\n2f push esi\n30 push ebx\n31 inc eax\n32 mov ebx, eax\n33 sign ebx, edx\n34 jnz vm_sign_flag, esi\n35 pfm ecx\n36 pop esi\n37 pfm ecx\n38 pop edx\n39 pfm ecx\n3a pop eax\n3b pfm ecx\n3c pop ebx\n3d sign ebx, edx\n3e jz vm_sign_flag, esi\n3f putchar ebx\n40 jmp eax\n</code></pre> <p>\u6700\u540e\u5206\u6790\u51fa\u6765\uff0c\u5c31\u662f\u4e2a\u5f02\u6216+\u9664\u6cd5\u52a0\u5bc6</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#exp","title":"EXP","text":"<pre><code>xor_table = [0x5e,0x46,\n            0x61,0x43,0xe,0x53,\n            0x49,0x1f,0x51,0x5e,\n            0x36,0x37,0x29,0x41,\n            0x63,0x3b,0x64,0x3b,\n            0x15,0x18,0x5b,0x3e,\n            0x22,0x50,0x46,0x5e,\n            0x35,0x4e,0x43,0x23,\n            0x60,0x3b,0x0, 0x0]\n\nenc_flag = [0x8e, 0x88,0xa3,0x99,0xc4,0xa5,0xc3,0xdd,0x19,0xec,0x6c,0x9b,0xf3,0x1b,0x8b,0x5b,0x3e,0x9b,0xf1,0x86,0xf3,0xf4,0xa4,0xf8,0xf8,0x98,0xab,0x86,0x89,0x61,0x22,0xc1,0x2,0x0]\n\nprint(len(enc_flag))\n\nresult = ''\nfor i in range(len(enc_flag)):\n    result += chr((enc_flag[i] ^ xor_table[i]) // 2)\n\nprint(result)\n\n# hgame{Ea$Y-Vm-t0-PrOTeCT_cOde!!}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/ezvm/#_4","title":"\u53c2\u8003\u8d44\u6599","text":"<p>\u301052pojie\u3011\u603b\u7ed3idapython\u5728\u9006\u5411\u4e2d\u7684\u5e94\u7528</p> <p>\u8fd9\u7bc7\u6587\u7ae0\u57fa\u672c\u6240\u6709idapython\u7684\u7528\u6cd5\u90fd\u6db5\u76d6\u5230\u4e86\uff0c\u4e0d\u8fc7\u6709\u4e9b\u7528\u6cd5\u5728python3\u65e0\u6cd5\u4f7f\u7528\uff0c\u9700\u8981\u518d\u53c2\u8003\u8fd9\u7bc7\uff1a\u3010\u535a\u5ba2\u56ed\u3011\u57fa\u4e8eIDA7.5_Python3</p> <p>\u3010\u770b\u96ea\u8bba\u575b\u3011\u5bf9VM\u9006\u5411\u7684\u5206\u6790(CTF)</p> <p>\u9898\u76ee\u7c7b\u4f3c\uff0c\u8fd9\u4e2a\u5c31\u662f\u89e3\u9898\u7684\u57fa\u672c\u601d\u8def\u4e86\uff0c\u4f46\u662f\u8fd8\u662f\u8981\u809d\uff0c\u662f\u4e2a\u82e6\u529b\u6d3b</p> <p>\u3010\u77e5\u4e4e\u3011NCTF2023 \u9006\u5411\u9898\u76eeezVM \u9898\u89e3</p> <p>\u8fd9\u4e2a\u662f\u7528Frida\u66b4\u529b\u7834\u89e3\u65b9\u6cd5\uff0c\u53ef\u4ee5\u770b\u770b\uff0c\u4e0d\u8fc7\u9898\u76ee\u672a\u7ed9\u51fa\u4e00\u70b9\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u4e0d\u597d\u7206\u7834</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/","title":"Findxenny smc","text":"<p>\u521d\u8bc6SMC\u6280\u672f</p> <p>\u539f\u94fe\u63a5\u3010NSSCTF\u3011ezvm</p> <p>\u6587\u4ef6</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/#_1","title":"\u524d\u7f6e\u77e5\u8bc6","text":"<p>SMC\uff08Software-Based Memory Encryption\uff09\u662f\u4e00\u79cd\u5c40\u90e8\u4ee3\u7801\u52a0\u5bc6\u6280\u672f\uff0c\u5b83\u53ef\u4ee5\u5c06\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6307\u5b9a\u533a\u6bb5\u8fdb\u884c\u52a0\u5bc6\uff0c\u4f7f\u5f97\u9ed1\u5ba2\u65e0\u6cd5\u76f4\u63a5\u5206\u6790\u533a\u6bb5\u5185\u7684\u4ee3\u7801\uff0c\u4ece\u800c\u589e\u52a0\u6076\u610f\u4ee3\u7801\u5206\u6790\u96be\u5ea6\u548c\u964d\u4f4e\u6076\u610f\u653b\u51fb\u6210\u529f\u7684\u53ef\u80fd\u6027\u3002</p> <p>\u5373\u589e\u5927\u9759\u6001\u5206\u6790\u7684\u96be\u5ea6\uff0c\u4f7f\u7528\u52a8\u6001\u8c03\u8bd5\u5373\u53ef\u7834\u62db</p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/#ctfsmc","title":"CTF\u4e2d\u7684SMC","text":"<p>SMC\u4e00\u822c\u6709\u4fe9\u79cd\u7834\u89e3\u65b9\u6cd5\uff0c 1. \u7b2c\u4e00\u79cd\u662f\u627e\u5230\u5bf9\u4ee3\u7801\u6216\u6570\u636e\u52a0\u5bc6\u7684\u51fd\u6570\u540e\u901a\u8fc7idapython\u5199\u89e3\u5bc6\u811a\u672c\u3002 2. \u7b2c\u4e8c\u79cd\u662f\u52a8\u6001\u8c03\u8bd5\u5230SMC\u89e3\u5bc6\u7ed3\u675f\u7684\u5730\u65b9dump\u51fa\u6765\u3002</p> <p>SMC\u7684\u5b9e\u73b0\u662f\u9700\u8981\u5bf9\u76ee\u6807\u5185\u5b58\u8fdb\u884c\u4fee\u6539\u7684\uff0c.text\u4e00\u822c\u662f\u6ca1\u6709\u5199\u6743\u9650\u7684\u3002</p> <p>\u90a3\u4e48\u5c31\u9700\u8981\u62e5\u6709\u4fee\u6539\u76ee\u6807\u5185\u5b58\u7684\u6743\u9650\uff1a</p> <ul> <li>\u5728linux\u7cfb\u7edf\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7mprotect\u51fd\u6570\u4fee\u6539\u76ee\u6807\u5185\u5b58\u7684\u6743\u9650</li> <li>\u5728Windows\u7cfb\u7edf\u4e2d\uff0cVirtualProtect\u51fd\u6570\u5b9e\u73b0\u5185\u5b58\u6743\u9650\u7684\u4fee\u6539</li> </ul> <p>\u56e0\u6b64\u4e5f\u53ef\u4ee5\u89c2\u5bdf\u662f\u5426\u6709\u8fd9\u4e24\u4e2a\u51fd\u6570\u6765\u5224\u65ad\u662f\u5426\u8fdb\u884c\u4e86SMC\u3002 </p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/#_2","title":"\u53c2\u8003\u6587\u7ae0\uff1a","text":"<ul> <li>\u3010CSDN\u3011CTF Reverse\u9006\u5411\u5b66\u4e60\u4e4bSMC\u52a8\u6001\u4ee3\u7801\u52a0\u5bc6\u6280\u672f</li> <li>\u3010\u77e5\u4e4e\u3011\u63a2\u7a76SMC\u5c40\u90e8\u4ee3\u7801\u52a0\u5bc6\u6280\u672f</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/#poc","title":"poc","text":"<pre><code>if ( (unsigned __int64)sub_7FF7DA121753(v15) &gt;= 0xC )\n</code></pre> <p>\u8fd9\u4e2a\u662f\u68c0\u67e5\u957f\u5ea6\u7684\uff0c\u8f93\u5165\u957f\u5ea6\u9700\u8981\u5927\u4e8e\u7b49\u4e8e <code>0xC</code></p> <pre><code>...\nsub_7FF7DA121514(v9, v10, v11);\nif ( (unsigned int)qword_7FF7DA139370(*v17)\n|| (unsigned int)qword_7FF7DA139378(*v18)\n|| (unsigned int)qword_7FF7DA139380(*v19) )\n{\n    v13 = sub_7FF7DA121262(std::cout, \"Try harder\");\n    std::ostream::operator&lt;&lt;(v13, sub_7FF7DA1211FE);\n}\nelse\n{\n    v12 = sub_7FF7DA121262(std::cout, \"I can't believe my golden doge eye! weare comarde!\");\n    std::ostream::operator&lt;&lt;(v12, sub_7FF7DA1211FE);\n}\n</code></pre> <p>2h\u540e\u66f4\u65b0</p> <p>\u51fd\u6570 <code>sub_7FF7DA121514</code> \u5185\u90e8\u8c03\u7528\u4e86 <code>VirtualProtect</code>\uff0c\u4e0eSMC\u7684\u7279\u5f81\u76f8\u7b26</p> <p>\u8fd9\u4e09\u4e2aqword\u5c31\u662fSMC\u7684\u7ed3\u679c\uff0c\u52a8\u6001\u8c03\u8bd5\u4e00\u4e0b\uff0c\u53d1\u73b0\u5728 <code>sub_7FF7DA121514</code> \u51fd\u6570\u4e4b\u540e\uff0c\u8fd9\u4e09\u4e2aqword\u5c31\u90fd\u8d4b\u503c\u4e0a\u4e86\uff0c\u5206\u522b\u53cc\u51fb\u8fdb\u53bb\uff0c\u7136\u540e\u6309P\u521b\u5efa\u51fd\u6570</p> <p>\u5206\u522b\u662f</p> <pre><code>__int64 __fastcall sub_17E2A13A8C0(__int64 a1)\n{\n    if ( a1 == 0x665F756F795F686Fi64 )\n    // \u5373 f_uoy_ho\n    // \u6ce8\u610f\u8fd9\u91cc\u662f\u4ee5\u5c0f\u7aef\u5e8f\u663e\u793a\u6570\u503c\uff0c\u5b57\u7b26\u4e32\u5e94\u8be5\u662f\n    // oh_you_f\n    // \u800c\u4e0d\u662f f_uoy_ho\n        return 0i64;\n    else\n        return -1i64;\n}\n\n__int64 __fastcall sub_17E2A13A4A0(__int64 a1)\n{\n    __int64 v1; // rcx\n    __int64 v3[2]; // [rsp+0h] [rbp-40h]\n    int v4[12]; // [rsp+10h] [rbp-30h] BYREF\n\n    v3[0] = a1;\n    qmemcpy(v4, \"ound_our\", 8);\n    v1 = 0i64;\n    while ( *((_BYTE *)v3 + v1) == *((_BYTE *)v4 + v1) )\n    {\n        if ( ++v1 &gt;= 8 )\n        return 0i64;\n    }\n    return -1i64;\n}\n\n_int64 __fastcall sub_17E2A13A210(__int64 a1)\n{\n    if ( a1 == 0x796E6E33785Fi64 )\n    // _x3nny\n        return 0i64;\n    else\n        return -1i64;\n}\n</code></pre> <p>\u7136\u540e\u62fc\u63a5\u5b57\u7b26\u4e32\u5373\u53ef\u5f97\u5230flag</p> <pre><code>oh_you_found_our_x3nny\n</code></pre> <p>\u6ce8\u610f</p> <p>\u770b\u6c47\u7f16\u4e00\u5b9a\u6bd4\u770bF5\u51c6\u786e</p> <p>\u6bd4\u5982\u8fd9\u91cc\u7684 <code>0x665F756F795F686Fi64</code> \u662f\u5c0f\u7aef\u5e8f\uff0c\u5982\u679c\u4ece\u5de6\u5230\u53f3\u8bfb\uff0c\u662f\u4e2a\u672a\u77e5\u7684\u5b57\u7b26\u4e32</p> <p>\u6c47\u7f16\u4e2d\u5c31\u6709\u5f88\u6e05\u6670\u7684\u5b57\u7b26\u4e32 <code>oh_you_f</code></p>"},{"location":"%E5%88%B7%E9%A2%98/NSSCTF/findxenny_smc/#_3","title":"\u5c0f\u77e5\u8bc6","text":"<p>\u53d1\u73b0\u633a\u591a\u7a0b\u5e8f\u90fd\u5305\u542b <code>-858993460</code> \u8fd9\u4e2a\u9b54\u6570\u7684\uff0c\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u7528</p> <pre><code>for ( i = 250i64; i; --i )\n{\n    *(_DWORD *)v3 = -858993460;\n    v3 += 4;\n}\n</code></pre> <p>\u8fd9\u4e2a <code>-858993460</code> \u5176\u5b9e\u662f <code>CCCCCCCC</code>\uff0cC\u7f16\u8bd1\u5668\u5b9a\u4e49\u53d8\u91cf\u7684\u6808\u7a7a\u95f4\u586b\u5145\u7684\u503c\u9ed8\u8ba4\u662fCC</p> <p>\u8fd9\u91cc\u7684\u4ee3\u7801\u610f\u601d\u662f\u7528 CC \u521d\u59cb\u5316\u6808\u7a7a\u95f4</p>"},{"location":"%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%8A%9F%E8%83%BD/LaTeX%20Math%20Support/","title":"\u652f\u6301LaTeX Math","text":"<p>LaTeX math is supported using MathJax.</p> <p>Inline math looks like \\(f(x) = x^2\\). The input for this is <code>$f(x) = x^2$</code>. Use <code>$...$</code>.</p> <p>For a block of math, use <code>$$...$$</code> on separate lines</p> <pre><code>$$\nF(x) = \\int^a_b \\frac{1}{2}x^4\n$$\n</code></pre> <p>gives </p> \\[ F(x) = \\int^a_b \\frac{1}{2}x^4 \\]"},{"location":"%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%8A%9F%E8%83%BD/Mermaid%20Diagrams/","title":"\u6d41\u7a0b\u56fe\u8bed\u6cd5\u652f\u6301","text":"<p>Here's the example from MkDocs Material documentation: </p> <pre><code>graph LR\n  A[Start] --&gt; B{Error?};\n  B --&gt;|Yes| C[Hmm...];\n  C --&gt; D[Debug];\n  D --&gt; B;\n  B ----&gt;|No| E[Yay!];</code></pre>"},{"location":"%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%8A%9F%E8%83%BD/Text%20Formatting/","title":"\u6587\u672c\u683c\u5f0f\u5316","text":"<p>You can have lists like this</p> <ul> <li>first</li> <li>second</li> <li>third</li> </ul> <p>Or checklist lists to</p> <ul> <li> Get</li> <li> things</li> <li> done</li> </ul> <p>Also, get highlights and strikethroughs as above (similar to Obsidian).</p> <p>More formatting options for your webpage here. (but not compatible with Obsidian)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-28/","title":"2024-04-28\u63a8\u8350","text":""},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-28/#spacedesk","title":"Spacedesk","text":"<p>\u628a\u591a\u4e2a\u8bbe\u5907\u6574\u6210\u526f\u5c4f</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-28/#explorerpatcher","title":"ExplorerPatcher","text":"<p>valinet/ExplorerPatcher: This project aims to enhance the working environment on Windows (github.com)</p> <p>\u8ba9 Windows \u81ea\u5e26\u7684 Explorer.exe \u66f4\u5f3a\u5927</p> <ul> <li>\u652f\u6301\u4efb\u52a1\u680f\u79fb\u52a8</li> <li>Win10\u6837\u5f0f\u7684\u4efb\u52a1\u680f</li> <li>\u7a97\u53e3\u4e91\u6bcd\u663e\u793a</li> </ul>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/","title":"2024-04-29","text":""},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#docker-desktop","title":"Docker desktop","text":"<p>Docker Desktop: The #1 Containerization Tool for Developers | Docker</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":"<pre><code>docker pull ubuntu:latest # \u62c9\u53d6container\ndocker run -it ubuntu:latest /bin/bash # \u8fd0\u884cdocker\ndocker attach &lt;container\u540d&gt; # \u8fde\u63a5\u5230container\n</code></pre>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#cyberchef","title":"CyberChef","text":"<p>gchq/CyberChef: The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis (github.com)</p> <pre><code>docker run -it -p 8080:80 ghcr.io/gchq/cyberchef:latest\n</code></pre>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#ghidra","title":"Ghidra","text":"<p>NationalSecurityAgency/ghidra: Ghidra is a software reverse engineering (SRE) framework (github.com)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#binary-ninja","title":"Binary Ninja","text":"<p>Binary Ninja 3.1.3469\u7834\u89e3\u7248 \u9006\u5411\u5206\u6790\u5de5\u5177 cracked - \ud83d\udd30\u96e8\u82c1\u2112\ud83d\udd30 (ddosi.org)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#ai","title":"AI","text":"<p>\u5982\u4f55\u4f7f\u7528</p> <p>THUDM/chatglm3-6b-128k \u00b7 Hugging Face</p> <p>\u5982\u4f55\u4f7f\u7528\ud83e\udd17hugging face\u7684\u6a21\u578b\u5e93? - \u6398\u91d1 (juejin.cn)</p> <p>\u4f7f\u7528docker</p> <pre><code>docker pull pytorch/pytorch\npython\n</code></pre> <p>Hannibal046/Awesome-LLM: Awesome-LLM: a curated list of Large Language Model (github.com)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-04-29/#dockerubuntu","title":"\u5728Docker\u5b89\u88c5ubuntu","text":"<pre><code>sudo docker pull ubuntu:20.04\ndocker run -it ubuntu:20.04 /bin/sh\n</code></pre> <p>\u5bb9\u5668\u955c\u50cf\u670d\u52a1 (aliyun.com)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-02/","title":"2024-05-02","text":""},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-02/#_1","title":"\u4e0b\u8f7d\u6574\u4e2a\u7f51\u9875","text":"<p>ArchiveBox/ArchiveBox: \ud83d\uddc3 Open source self-hosted web archiving. Takes URLs/browser history/bookmarks/Pocket/Pinboard/etc., saves HTML, JS, PDFs, media, and more... (github.com)</p> <p>\u53ef\u4ee5\u5728dockerhub\u641c\u5230</p> <pre><code>archivebox manage createsuperuser\n</code></pre> <p>Docker \u2014 ArchiveBox 0.7.3 documentation</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-02/#_2","title":"\u5168\u9762\u6307\u5357\uff1a\u5982\u4f55\u5f52\u6863\u7f51\u9875","text":"<p>iipc/awesome-web-archiving: An Awesome List for getting started with web archiving (github.com)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-02/#_3","title":"\u7231\u76d8","text":"<p>\u7231\u76d8 - \u6700\u65b0\u7684\u5728\u7ebf\u7834\u89e3\u5de5\u5177\u5305 (52pojie.cn)</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-11/","title":"2024-05-11","text":""},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-11/#pyenv-win","title":"pyenv-win","text":"<p>pyenv-win/pyenv-win</p> <p>\u5728 Windows \u4e0b\u8f7b\u677e\u7ba1\u7406 Python \u7248\u672c</p> <pre><code>Invoke-WebRequest -UseBasicParsing -Uri \"https://raw.githubusercontent.com/pyenv-win/pyenv-win/master/pyenv-win/install-pyenv-win.ps1\" -OutFile \"./install-pyenv-win.ps1\"; &amp;\"./install-pyenv-win.ps1\"\n</code></pre> <p>\u5373\u53ef\u5b89\u88c5</p>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-11/#_1","title":"\u4f7f\u7528","text":"<ol> <li><code>pyenv --version</code> \u67e5\u770bpyenv\u7684\u7248\u672c</li> <li><code>pyenv install -l</code> \u67e5\u770b\u53ef\u5b89\u88c5\u7684python\u7248\u672c</li> <li><code>pyenv install &lt;version&gt;</code> \u5b89\u88c5python\u7248\u672c</li> <li><code>pyenv global [version]</code> \u67e5\u770b/\u8bbe\u7f6e\u5168\u5c40python\u7248\u672c</li> </ol>"},{"location":"%E5%9C%A8%E7%94%A8%E4%BB%80%E4%B9%88%E8%BD%AF%E4%BB%B6/2024-05-13/","title":"2024-05-13","text":"<p>\u5927\u4f17\u70b9\u8bc4</p> <p>value.dealDetails value.dealMoreDetails</p> <p>\u67e5\u770b\u8c03\u7528\u5806\u6808</p> <p></p> <p>\u5728 success \u91cc\u6709\u4e00\u4e2aget\u8bf7\u6c42\u7684\u51fd\u6570</p> <p></p> <p>JS\u9006\u5411\u4e4b\u5927\u4f17\u70b9\u8bc4mtgsig-CSDN\u535a\u5ba2</p> <pre><code>import requests\nfrom urllib.parse import urlencode, urlparse\n\ndef print_hi():\n    # _token \u53ef\u4ee5\u4e0d\u53d8\n    _token = \"eJxVT9tugkAQ/Zd9lcAuFxHeWtDiVrwgKtr4wEUUkcu6UISm/9410aQmk5wzZ+aczPyA6zgCOoIQyogD34cr0AHiId8HHKgom6hIUVRtICJJ6nMgfNU0FXIguK5NoH8hTYQcktH+rjhMeChwAPfcfy7KrO5bY7YETlVVUl0Qmqbho8TPyyQ/8mGRCfRUlIIl71L3LCudhAszc5fsqqfBD8OizqtXE2C5mctyGaYP9B9YPXub/ciCaHLMGTvgm7ukMiWxY1N37bVQsjtrOpsML9OuHRiGkwQfONsSx0sv/XAj7ggZbeJ01LyN5qs2oemsdYft9TyRWs/D5pFaSVxkCgmCuVIrak0swYlie6HV7x2OJtqt8wWCz8PSFLZ10aOfZNEWeLWBtokXRt4zDQ38/gFFDXqL\"\n    mtgsig = '{\"a1\":\"1.1\",\"a2\":1715579821971,\"a3\":\"15y52uy18y425448yyz2x5uy6121x1w981u293z176y97958zu22854v\",\"a5\":\"++VxA4/aPYxywCqKro1gDW==\",\"a6\":\"hs1.4Kx+RtzPePwht7vrJrUHR5zoCXF+c7astYA7RjT9btt34LQBO/g2HauDdUbG3fuNlj8Dh+as4NPSgZ3SXcqlSyw==\",\"x0\":4,\"d1\":\"e57d8e61a30e910e890ac21146731f7a\"}'\n    Cookie = \"_lxsdk_cuid=18f706a748ac8-0e4de3b2579e2b-e505625-1fa400-18f706a748ac8; _lxsdk_s=18f706a748a-e6f-a2-fe2%7C%7C239; _lxsdk=18f706a748ac8-0e4de3b2579e2b-e505625-1fa400-18f706a748ac8; WEBDFPID=15y52uy18y425448yyz2x5uy6121x1w981u293z176y97958zu22854v-2030937976891-1715577976205KWMEEMI10f02007e9804b0b4cf483cebf1f9f511791; _hc.v=58c90185-4e27-9ea1-131d-842f1f8c56d6.1715577976; qruuid=de97eba9-513a-4f65-9a32-4b84e6ef4668; dplet=f2021981ce546f27fa34c8dfd0c786fb; dper=0202ef20af3d87af5a16bcccc237a823e8d0df4009db9d0ecfdcf45f67f1f9bd06fefb342540c7caa1f27c62597568bfe39ff88a7fc79abb128600000000f91f0000439c03108f0ea755cd1edafa24d2258a1715179d7c029f2c3e1aab90976ac0434cfc435b8b35129fa8e0e00156197357; ll=7fd06e815b796be3df069dec7836c3df; ua=dpuser_6238374210; ctu=c25351188d4885ad07cd45286ba7c51a1c34c0303bc3cefe9fa5a5530aa2e990; Hm_lvt_602b80cf8079ae6591966cc70a3940e7=1715578004; Hm_lpvt_602b80cf8079ae6591966cc70a3940e7=1715579822; fspop=test\"\n\n    params = {\n        \"shopId\": \"H4ZkTj45z3JoDmTS\",\n        \"cityId\": \"7\",\n        \"shopName\": \"\u677e\u5c0f\u8299\u00b7\u677e\u997c\u00b7\u8212\u8299\u857e\",\n        \"power\": \"5\",\n        \"mainCategoryId\": \"34246\",\n        \"shopType\": \"10\",\n        \"_token\": _token,\n        \"uuid\": \"58c90185-4e27-9ea1-131d-842f1f8c56d6.1715577976\",\n        \"platform\": \"1\",\n        \"partner\": \"150\",\n        \"optimusCode\": \"10\",\n        \"originUrl\": \"https://www.dianping.com/shop/H4ZkTj45z3JoDmTS\",\n        \"yodaReady\": \"h5\",\n        \"csecplatform\": \"4\",\n        \"csecversion\": \"2.4.0\",\n        \"mtgsig\": mtgsig,\n    }\n\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0\",\n        \"Accept\": \"application/json, text/javascript, */*; q=0.01\",\n        \"Accept-Language\": \"en-US,en;q=0.5\",\n        \"Accept-Encoding\": \"gzip, deflate, br\",\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Connection\": \"keep-alive\",\n        \"Referer\": \"https://www.dianping.com/shop/H4ZkTj45z3JoDmTS\",\n        \"Cookie\": Cookie,\n        \"Sec-Fetch-Dest\": \"empty\",\n        \"Sec-Fetch-Mode\": \"cors\",\n        \"Sec-Fetch-Site\": \"same-origin\",\n    }\n\n    url = \"https://www.dianping.com/ajax/json/shopDynamic/promoInfo\"\n    response = requests.get(url, params=params, headers=headers)\n    print(response.text)\n\nif __name__ == '__main__':\n    print_hi()\n</code></pre>"},{"location":"%E7%AE%97%E6%B3%95/TEA/","title":"TEA \u7b97\u6cd5","text":"<p>\u53c2\u8003\uff1aTEA/XTEA/XXTEA\u7cfb\u5217\u7b97\u6cd5 - zpchcbd - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"%E7%AE%97%E6%B3%95/TEA/#tea_1","title":"TEA","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n//\u52a0\u5bc6\u51fd\u6570\nvoid encrypt (uint32_t* v, uint32_t* k) {\n    uint32_t v0=v[0], v1=v[1], sum=0, i;           /* set up */\n    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */\n    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */\n    for (i=0; i &lt; 32; i++) {                       /* basic cycle start */\n        sum += delta;\n        v0 += ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);\n        v1 += ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);\n    }                                              /* end cycle */\n    v[0]=v0; v[1]=v1;\n}\n\n//\u89e3\u5bc6\u51fd\u6570\nvoid decrypt (uint32_t* v, uint32_t* k) {\n    uint32_t v0=v[0], v1=v[1], sum=0xC6EF3720, i;  /* set up */\n    uint32_t delta=0x9e3779b9;                     /* a key schedule constant */\n    uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3];   /* cache key */\n    for (i=0; i&lt;32; i++) {                         /* basic cycle start */\n        v1 -= ((v0&lt;&lt;4) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;5) + k3);\n        v0 -= ((v1&lt;&lt;4) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;5) + k1);\n        sum -= delta;\n    }                                              /* end cycle */\n    v[0]=v0; v[1]=v1;\n}\n\nint main()\n{\n    uint32_t v[2]={1,2},k[4]={2,2,3,4};\n    // v\u4e3a\u8981\u52a0\u5bc6\u7684\u6570\u636e\u662f\u4e24\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\n    // k\u4e3a\u52a0\u5bc6\u89e3\u5bc6\u5bc6\u94a5\uff0c\u4e3a4\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5373\u5bc6\u94a5\u957f\u5ea6\u4e3a128\u4f4d\n    printf(\"\u52a0\u5bc6\u524d\u539f\u59cb\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    encrypt(v, k);\n    printf(\"\u52a0\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    decrypt(v, k);\n    printf(\"\u89e3\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    return 0;\n}\n</code></pre>"},{"location":"%E7%AE%97%E6%B3%95/TEA/#xtea","title":"XTEA","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */\n\nvoid encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) {\n    unsigned int i;\n    uint32_t v0=v[0], v1=v[1], sum=0, delta=0x9E3779B9;\n    for (i=0; i &lt; num_rounds; i++) {\n        v0 += (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);\n        sum += delta;\n        v1 += (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);\n    }\n    v[0]=v0; v[1]=v1;\n}\n\nvoid decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) {\n    unsigned int i;\n    uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*num_rounds;\n    for (i=0; i &lt; num_rounds; i++) {\n        v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);\n        sum -= delta;\n        v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]);\n    }\n    v[0]=v0; v[1]=v1;\n}\n\nint main()\n{\n    uint32_t v[2]={1,2};\n    uint32_t const k[4]={2,2,3,4};\n    unsigned int r=32;//num_rounds\u5efa\u8bae\u53d6\u503c\u4e3a32\n    // v\u4e3a\u8981\u52a0\u5bc6\u7684\u6570\u636e\u662f\u4e24\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\n    // k\u4e3a\u52a0\u5bc6\u89e3\u5bc6\u5bc6\u94a5\uff0c\u4e3a4\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5373\u5bc6\u94a5\u957f\u5ea6\u4e3a128\u4f4d\n    printf(\"\u52a0\u5bc6\u524d\u539f\u59cb\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    encipher(r, v, k);\n    printf(\"\u52a0\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    decipher(r, v, k);\n    printf(\"\u89e3\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    return 0;\n}\n</code></pre>"},{"location":"%E7%AE%97%E6%B3%95/TEA/#xxtea","title":"XXTEA","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#define DELTA 0x9e3779b9\n#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))\n\nvoid btea(uint32_t *v, int n, uint32_t const key[4])\n{\n    uint32_t y, z, sum;\n    unsigned p, rounds, e;\n    if (n &gt; 1)            /* Coding Part */\n    {\n        rounds = 6 + 52/n;\n        sum = 0;\n        z = v[n-1];\n        do\n        {\n            sum += DELTA;\n            e = (sum &gt;&gt; 2) &amp; 3;\n            for (p=0; p&lt;n-1; p++)\n            {\n                y = v[p+1];\n                z = v[p] += MX;\n            }\n            y = v[0];\n            z = v[n-1] += MX;\n        }\n        while (--rounds);\n    }\n    else if (n &lt; -1)      /* Decoding Part */\n    {\n        n = -n;\n        rounds = 6 + 52/n;\n        sum = rounds*DELTA;\n        y = v[0];\n        do\n        {\n            e = (sum &gt;&gt; 2) &amp; 3;\n            for (p=n-1; p&gt;0; p--)\n            {\n                z = v[p-1];\n                y = v[p] -= MX;\n            }\n            z = v[n-1];\n            y = v[0] -= MX;\n            sum -= DELTA;\n        }\n        while (--rounds);\n    }\n}\n\n\nint main()\n{\n    uint32_t v[2]= {1,2};\n    uint32_t const k[4]= {2,2,3,4};\n    int n= 2; //n\u7684\u7edd\u5bf9\u503c\u8868\u793av\u7684\u957f\u5ea6\uff0c\u53d6\u6b63\u8868\u793a\u52a0\u5bc6\uff0c\u53d6\u8d1f\u8868\u793a\u89e3\u5bc6\n    // v\u4e3a\u8981\u52a0\u5bc6\u7684\u6570\u636e\u662f\u4e24\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\n    // k\u4e3a\u52a0\u5bc6\u89e3\u5bc6\u5bc6\u94a5\uff0c\u4e3a4\u4e2a32\u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5373\u5bc6\u94a5\u957f\u5ea6\u4e3a128\u4f4d\n    printf(\"\u52a0\u5bc6\u524d\u539f\u59cb\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    btea(v, n, k);\n    printf(\"\u52a0\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    btea(v, -n, k);\n    printf(\"\u89e3\u5bc6\u540e\u7684\u6570\u636e\uff1a%u %u\\n\",v[0],v[1]);\n    return 0;\n}\n</code></pre>"},{"location":"%E7%AE%97%E6%B3%95/%E8%8E%B7%E5%8F%96%E5%AF%86%E9%92%A5%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/","title":"\u83b7\u53d6\u5bc6\u94a5\u7684\u5947\u6280\u6deb\u5de7","text":""},{"location":"%E7%AE%97%E6%B3%95/%E8%8E%B7%E5%8F%96%E5%AF%86%E9%92%A5%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/#rc4","title":"RC4","text":"<p>\u56e0\u4e3a\u662f\u5f02\u6216\u52a0\u5bc6\uff0c\u6240\u4ee5\u53ef\u4ee5\u8f93\u5165 <code>aaaaaaaaaaaaaaaaaaaaaaaaaa</code> \u6765\u83b7\u53d6\u5bc6\u94a5\u6d41</p>"},{"location":"%E7%AE%97%E6%B3%95/%E8%8E%B7%E5%8F%96%E5%AF%86%E9%92%A5%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/#base64","title":"Base64 \u81ea\u5b9a\u4e49\u8868","text":""},{"location":"%E8%B5%9B%E4%BA%8B/2024D3/%E5%8D%9A%E5%BE%B7%E4%B9%8B%E9%97%A8/","title":"\u535a\u5fb7\u4e4b\u95e8","text":"<p>Spells - DND 5th Edition (wikidot.com)</p> <p>Spells | Baldurs Gate 3 Wiki (fextralife.com)</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/O2/","title":"O2\u7ea7\u522b\u7684\u4f18\u5316\uff1f","text":"<p>\u6587\u4ef6</p> <pre><code>./O2: /lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.32' not found (required by ./O2)\n</code></pre> <p>GLIBC\u7248\u672c\u592a\u4f4e\uff0c\u4f7f\u7528 wsl ubuntu-preview \u5373\u53ef\u8fd0\u884c</p> <p>\u65e0\u6cd5\u62d6\u5165ida\u67e5\u770b</p> <p>\u8fd9\u91cc\u4f3c\u4e4e\u9700\u8981\u4fee\u590dELF\u4ec0\u4e48\u7684</p> <p>\u5982\u679c\u4e0d\u4fee\uff0c\u6bcf\u6b21Debug\u90fd\u5f97\u91cd\u542fIDA\uff0c\u607c\u7684\u5f88</p> <p>2024-04-22 \u770b\u5927\u4f6cwp\u540e\u66f4\u65b0</p> <p>\u62d6\u5165DIE\u67e5\u770b\uff0c\u53d1\u73b0\u662f AMD64, 32\u4f4d</p> <p><code>elf header\u88ab\u4fee\u6539\u4e86\uff0c\u5c06EI_CLASS\u6539\u4e3a2\u5373\u53ef\u4fee\u590d(1\u662f32\u4f4d\uff0c2\u662f64\u4f4d)</code></p> <p>\u76f4\u63a5\u52a8\u6001\u8c03\u8bd5\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u4e86</p> <p>\u8fd9\u91cc\u9700\u8981\u4e00\u4e9b\u5bc4\u5de7\uff0c</p> <p>\u7a0b\u5e8f\u7684\u5165\u53e3\u662f libc\uff0c\u7a0b\u5e8f\u91cc\u9762\u6709\u7b49\u5f85\u7528\u6237\u8f93\u5165\u7684\u8bdd\uff0c\u5c31\u4f1a\u5361\u4f4f</p> <p>\u6240\u4ee5\u5355\u6b65\u8c03\u8bd5\uff0c\u770b\u54ea\u91cc\u5361\u4f4f\u4e86\uff0c\u5c31\u91cd\u65b0\u8c03\u8bd5\uff0c<code>F7</code> \u8fdb\u53bb\u5c31\u884c</p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u6bd4\u8f83\u7075\u8f66\uff0c\u8fd8\u662f\u5f97\u95ee\u95ee\u5176\u4ed6\u65b9\u6cd5</p> <p>\u76f4\u63a5\u641c\u5b57\u7b26\u4e32\uff0c\u627e\u5230\u4e00\u4e9b\u4e1c\u897f\uff0c\u6709\u70b9\u50cf\u5bc6\u94a5/\u5bc6\u6587</p> <p><code>364d4d5c3e387e00421c597a0a7302144d5b70087e064619567336297d151f567</code></p> <pre><code>((void (__fastcall *)(_BYTE *, char **, char **))sub_564A5C2065C0)(v15, &amp;off_564A5C209360, &amp;off_564A5C209340);\n</code></pre> <p>off_564A5C209360 \u662f\u8f93\u5165\u7684\u5b57\u7b26\u4e32 off_564A5C209340 \u662f <code>PaluCTF</code> </p> <pre><code>O2:000055E1F1448344 lea     rdx, off_55E1F144B340 ; \"PaluCTF\"\nO2:000055E1F144834B call    near ptr unk_55E1F14485C0\n</code></pre> <p>\u770b\u6c47\u7f16\uff0c\u5f97\u51fa\u7b97\u6cd5</p> <pre><code>key = b'PaluCTF'\ninp = b'aaaaaaaaaaaaaaaaaaa'\n\nfor i in range(len(inp)):\n    print(hex((key[i % len(key)] + inp[i]) &amp; 0x7F))\n</code></pre> <p>\u52a8\u8c03\u9a8c\u8bc1\u4e4b\u540e\uff0c\u6b63\u786e</p> <p>\"PaluCTF\" \u4e0b\u9762\u6709\u4e24\u4e2a\u51fd\u6570\uff0c\u7b2c\u4e00\u4e2a\u662f\u52a0\u5bc6\u8f93\u5165\uff0c\u7b2c\u4e8c\u4e2a\u6267\u884c\u4e4b\u540e\uff0c[rsp+68h+var_40] \u53d8\u6210 26h\uff0c\u5982\u679c\u4e0d\u662f 54h\uff0c\u5c31\u8f93\u51fa Wrong!</p> <p>\u68c0\u9a8c\u957f\u5ea6\u7684\u5730\u65b9</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/O2/#exp","title":"EXP","text":"<pre><code>enc = '364d4d5c3e387e00421c597a0a7302144d5b70087e064619567336297d151f56770a7935424f2a780643'\nkey = b'PaluCTF'\n\nr = []\nfor i in range(0, len(enc), 2):\n    r.append((int(enc[i:i+2], 16) - key[(i // 2) % len(key)]) &amp; 0x7F)\nprint(''.join(chr(c) for c in r))\n</code></pre>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/PyLu/","title":"\u87d2\u86c7\u5e15\u9c81","text":"<p>\u6587\u4ef6</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/PyLu/#_2","title":"\u89e3\u5305","text":"<p>\u770b\u56fe\u6807/\u6254\u8fdbDIE\uff0c\u4f7f\u7528PyInstaller\u6253\u5305\u7684\uff0c\u5f00\u59cb\u89e3\u5305</p> <ul> <li>pyinstxtractor \u89e3\u5305\u51fa pyc</li> <li>pycdc \u89e3\u5305\u51fa py \uff08\u4e4b\u524d\u7528\u7684 Uncompyle6 \u4e0d\u597d\u4f7f\u4e86\uff0c\u56e0\u4e3a\u662f\u7528 3.11 \u6253\u5305\u7684\uff09</li> </ul> <p>\u53e6\u5916\uff0c\u8fd9\u91cc\u7684pycdc\u5e76\u6ca1\u6709\u7ed9\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u9700\u8981\u624b\u52a8\u7f16\u8bd1</p> <ul> <li>\u5b89\u88c5 cmake</li> <li><code>git clone https://github.com/zrax/pycdc.git</code></li> <li><code>cmake . msbuild pycdc.sln</code></li> <li>\u7528 VS \u6253\u5f00\uff0c\u7f16\u8bd1</li> </ul> <p>\u5df2\u7ecf\u628a\u7f16\u8bd1\u597d\u7684\u6587\u4ef6\u6254\u8fdbPython\u5e38\u7528\u5de5\u5177\u4e86</p> <p>\u53c2\u8003</p> <p>\u3010python\u9006\u5411 pyc\u53cd\u7f16\u8bd1\u3011python\u9006\u5411\u5168\u7248\u672c\u901a\u6740-CSDN\u535a\u5ba2</p> <p>Decompiling recent python versions (up to 3.12) - Ring 0x00 (idafchev.github.io)</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/PyLu/#_3","title":"\u5206\u6790","text":"<pre><code>from Crypto.Util.number import bytes_to_long\n\ndef enc(key):\n    R = bytes_to_long(b'Welcome To PaluCTF!')\n    MOD = 2 ** 418\n    R = R ^ R - 60 &gt;&gt; 24\n    R = R ^ R - 60 &lt;&lt; 88\n    R ^= key\n    R = -R ** 2 * 2024 % MOD\n    R = R * key % MOD\n    return R\n\nflag = input('Welcome To PaluCTF!\\nInput FLAG:')\nm = bytes_to_long(flag.encode())\ncor = 0x2E441F765514CCA89173554726494D37E9FBE774B6F807BC5F6E71117530CE3D7DB5F70554C03CD9055F4E42969600904DF1F4DB8L\nif enc(m) == cor:\n    print('Congratulation!')\n    return None\nprint('Wrong FLAG!')\n</code></pre> <p>\u7a0d\u5fae\u4fee\u6539\u4e0b\u4ee3\u7801\uff0c\u4f7f\u5f97\u53ef\u8bfb\u6027\u63d0\u9ad8\u4e00\u4e9b</p> <pre><code>def enc(key):\n    R = bytes_to_long(b'Welcome To PaluCTF!')\n    MOD = 2 ** 418\n    R = R ^ ((R - 60) &gt;&gt; 24)\n    R = R ^ ((R - 60) &lt;&lt; 88)\n    # \u6b64\u65f6 hex(R) # 0x57656c340a01064f390a00536b201128393569390a00040e4c2522383362\n\n    KeyXor = key ^ R\n    temp = (KeyXor ** 2) * (key)\n    R = ((-(temp)) * 2024) % MOD\n    return R\n\nflag = input()\nm = bytes_to_long(flag.encode())\ncor = 0x2E441F765514CCA89173554726494D37E9FBE774B6F807BC5F6E71117530CE3D7DB5F70554C03CD9055F4E42969600904DF1F4DB8\nif enc(m) == cor:\n    print('Congratulation!')\n    exit()\nprint('Wrong FLAG!')\n</code></pre> <p>\u6240\u4ee5\u7b97\u6cd5\u662f</p> <pre><code>graph TD\n  A[\u8f93\u5165str] --&gt;|encode| B[bytes];\n  B --&gt;|bytes_to_long| K[\u5927\u6570key];\n  K --&gt; Z;\n\n  W['Welcome To PaluCTF!'] --&gt;|\u8ba1\u7b97| R;\n  R[\u4e00\u4e2a\u56fa\u5b9a\u7684\u5927\u6570R] --&gt; Z;\n\n\n  Z[\u5f02\u6216 \u4e58\u6cd5 \u53d6\u6a21\u8fd0\u7b97] --&gt;O[\u4e00\u4e2a\u5927\u6570];</code></pre> <p>\u4ee5\u4e0a\u7b97\u6cd5\u56e0\u4e3a\u5e26\u6709==\u5f02\u6216/\u5e73\u65b9/\u53d6\u6a21/\u4e58\u6cd5==\u8fd0\u7b97\uff0c\u5bfc\u81f4\u5f88\u96be\u627e\u5230\u9006\u8fd0\u7b97\uff0c</p> <p>\u4f46\u662f\u53e6\u5916\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u5e76\u6ca1\u6709\u6539\u53d8\u5404\u4e2a\u4f4d\u7684\u4f4d\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2a\u4f4d\u5f00\u59cb\uff0c\u9010\u4f4d\u7206\u7834</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/PyLu/#exp","title":"EXP","text":"<pre><code>from Crypto.Util.number import bytes_to_long\nfrom string import printable\n\ncor = 0x2E441F765514CCA89173554726494D37E9FBE774B6F807BC5F6E71117530CE3D7DB5F70554C03CD9055F4E42969600904DF1F4DB8\n\ndef enc(key):\n    R = bytes_to_long(b'Welcome To PaluCTF!')\n    MOD = 2 ** 418\n    R = R ^ R - 60 &gt;&gt; 24\n    R = R ^ R - 60 &lt;&lt; 88\n    R ^= key\n    R = -R ** 2 * 2024 % MOD\n    R = R * key % MOD\n    return R\n\ndef find_next(current_str: str):\n    print(current_str)\n    length = len(current_str)\n    if (cor &gt;&gt; (length * 8)) == 0:\n        return current_str\n\n    for c in printable:\n        s = (c + current_str)\n        e = enc(bytes_to_long(s.encode()))\n        if (e &gt;&gt; (length * 8)) &amp; 0xFF == cor &gt;&gt; (length * 8) &amp; 0xFF:\n            r = find_next(c + current_str)\n            if r == None:\n                continue\n            else:\n                return r\n\n    return None\n\nfind_next(\"\")\n</code></pre>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E5%B8%95%E9%B2%81%E6%9D%AF/PyLu/#exp2","title":"EXP2","text":"<p>\u770b\u4e86\u4e0b\u7b2c\u4e00\u540d\u7684wp\uff0c\u7528\u5230\u4e86z3</p> <p>Z3\u5b98\u65b9\u6587\u6863 | Introduction | Online Z3 Guide (microsoft.github.io)</p> <p>Z3\u57fa\u7840\u5b66\u4e60\uff08\u4e00\uff09 \u4ece\u4f8b\u5b50\u5165\u95e8</p> <p>\u5e15\u9c81\u676f Writeup (yuque.com)</p> <pre><code>import z3\nfrom Crypto.Util.number import *\n\ndef enc(key):\n    R = bytes_to_long(b\"Welcome To PaluCTF!\")\n    MOD = 2**418\n    R = R ^ ((R - 60) &gt;&gt; 24)\n    R = R ^ ((R - 60) &lt;&lt; 88)\n    R ^= key\n    R = (-R * R * 2024) % MOD  \n    R = (R * key) % MOD\n    return R\n\nres = 0x2E441F765514CCA89173554726494D37E9FBE774B6F807BC5F6E71117530CE3D7DB5F70554C03CD9055F4E42969600904DF1F4DB8\nsolver = z3.Solver()\nkey = z3.BitVec(\"key\", 418)\nsolver.add(enc(key) == res)\nsolver.check()\nm = solver.model()\nflag = long_to_bytes(m[key].as_long())\nprint(flag)\n</code></pre> <p>\u592a\u62bd\u8c61\u4e86</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"\u5e15\u9c81\u670d\u52a1\u5668","text":"<p>\u65b0\u5efa\u865a\u62df\u673a\uff08.vmdk\uff09\u5bfc\u5165Vmware - \u9152\u5927\u6697 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>Login\u4f7f\u7528root</p> <p></p> <p>Linux\u7cfb\u7edf tcpdump \u6293\u5305\u547d\u4ee4\u4f7f\u7528\u6559\u7a0b - \u77e5\u4e4e (zhihu.com)</p> <pre><code>tcpdump -XX # \u67e5\u770b\u4ee516\u8fdb\u5236\u548cASCII\u5417\u5f62\u5f0f\u663e\u793a\u6bcf\u4e2a\u62a5\u6587\uff08\u5305\u542b\u94fe\u8def\u5c42\u62a5\u5934\uff09\u3002\n</code></pre> <p></p> <p>flag{Ur_s3rVer_1s_n0w_mY_p4l}</p> <p></p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/#2","title":"2 \u6eaf\u6e90","text":"<p>Vmware\u865a\u62df\u673a\u547d\u4ee4\u5b89\u88c5 Vmware Tools_sudo apt-get autoremove open-vm-tools sudo apt-get-CSDN\u535a\u5ba2</p> <pre><code>sudo apt-get open-vm-tools\nsudo apt-get install open-vm-tools-desktop\nsudo reboot // \u91cd\u542f\u7535\u8111\n</code></pre> <p>parted\u6269\u5c55\u78c1\u76d8\u5206\u533a\uff08\u5b9e\u8df5\u7bc7\uff09_parted\u5206\u533a\u6269\u5bb9-CSDN\u535a\u5ba2</p> <p>grayddq/GScan: \u672c\u7a0b\u5e8f\u65e8\u5728\u4e3a\u5b89\u5168\u5e94\u6025\u54cd\u5e94\u4eba\u5458\u5bf9Linux\u4e3b\u673a\u6392\u67e5\u65f6\u63d0\u4f9b\u4fbf\u5229\uff0c\u5b9e\u73b0\u4e3b\u673a\u4fa7Checklist\u7684\u81ea\u52a8\u5168\u9762\u5316\u68c0\u6d4b\uff0c\u6839\u636e\u68c0\u6d4b\u7ed3\u679c\u81ea\u52a8\u6570\u636e\u805a\u5408\uff0c\u8fdb\u884c\u9ed1\u5ba2\u653b\u51fb\u8def\u5f84\u6eaf\u6e90\u3002 (github.com)</p> <p><code>/etc/shadow</code> \u6587\u4ef6\u5b58\u5728\u5f02\u5e38</p> <p></p> <p></p> <p>linux.55807</p> <p>ss\u547d\u4ee4 \u5982\u4f55\u68c0\u67e5 Debian \u4e0a\u7684\u5f00\u653e\u7aef\u53e3 (linux-console.net)</p> <pre><code>ss -ulp\n\nudp \u00a0 ESTAB \u00a00 \u00a0 \u00a0 \u00a00 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0192.168.47.131:55807 \u00a0 \u00a0 172.67.189.48:31900\n1```\ntraceroute 172.67.189.48\n\n\n```log\n 1  _gateway (192.168.47.2)  0.165 ms  0.084 ms  0.056 ms\n 2  * * *\n 3  * * *\n</code></pre> <pre><code>who-has _gateway\n</code></pre> <p>\u4e0d\u5c31\u662f 172.67.189.48 \u2014\u2014 \u4e00\u4e2a\u7f8e\u56fd\u7684\u8282\u70b9</p> <p>IP\u5730\u5740\u67e5\u8be2 - \u5728\u7ebf\u5de5\u5177 (tool.lu)</p> <p>\u6240\u4ee5\u53d1\u5305\u8def\u5f84\u662f\uff1a</p> <pre><code>graph TD\n    A[192.168.47.131:55807] --&gt; B[172.67.189.48:31900];\n    B --&gt; C[192.168.47.1]</code></pre> <p><code>ip addr</code> \u67e5\u770b\u672c\u5730ip\uff0c\u5373 <code>192.168.47.131</code></p> <p>\u770b\u770b\u8fd9\u4e2a\u7aef\u53e3 <code>55807</code> \u662f\u54ea\u4e2a\u7a0b\u5e8f\u5360\u7528\u7684</p> <pre><code>lsof -i\n</code></pre> <p></p> <p><code>46912 -&gt; _gateway:domain</code></p> <p>\u770b\u4e86\u4e0b <code>systemd-resolve</code> \u662f\u6539 dns \u7684</p> <p>\u4f18\u5316ubuntu dns\u89e3\u6790\uff0c\u5173\u6389systemd-resolved - MR__Wang - \u535a\u5ba2\u56ed (cnblogs.com)</p> <pre><code>cat /etc/resolv.conf\n\n##########################\nnameserver 192.168.47.2\nsearch localdomain\n</code></pre> <p>Linux\u914d\u7f6e/etc/resolv.conf\u8be6\u89e3 - yuhaohao - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>nameserver \u662f dns \u670d\u52a1\u5668</p> <p></p> <pre><code>traceroute _gateway\n\ntraceroute to _gateway(192.168.47.2)...\n</code></pre> <p>\u6240\u4ee5 dns \u628a <code>_gateway</code> \u57df\u540d\u89e3\u6790\u5230\u4e86 192.168.47.2</p> <p></p> <p><code>gateway.5335</code> \uff0c\u770b\u770b\u8fd9\u4e2a\u7aef\u53e3</p> <p></p> <p>\u770b\u6765\u5c31\u662f\u8fd9\u4e2a <code>systemd-resolve</code></p> <pre><code>systemd+ \u00a0 \u00a0 494 \u00a00.0 \u00a00.6 \u00a020824 13040 ? \u00a0 \u00a0 \u00a0 \u00a0Ss \u00a0 12:22 \u00a0 0:00 /lib/systemd/systemd-resolved\n</code></pre> <pre><code>systemd-resolved --help\n\n/lib/systemd/systemd-resolved [OPTIONS...]\n\nProvide name resolution with caching using DNS, mDNS, LLMNR.\n\nThis program takes no positional arguments.\n\nOptions:\n  -h --help                 Show this help\n     --version              Show package version\n     --bus-introspect=PATH  Write D-Bus XML introspection data\n\nSee the systemd-resolved.service(8) man page for details.\n</code></pre> <pre><code>apt install net-tools\n</code></pre> <p></p> <p>netstat \u547d\u4ee4\u4e0d\u663e\u793a\u8fdb\u7a0b\u53f7\u8fdb\u7a0b\u540d\uff0c\u53ea\u663e\u793a\u6a2a\u7ebf '-'_netstat\u770b\u4e0d\u5230\u8fdb\u7a0b\u540d-CSDN\u535a\u5ba2</p> <p>\u5c1d\u8bd5\u628aDNS\u6539\u4e86</p> <pre><code>vim /etc/resolv.conf\n</code></pre> <p></p> <p>\u8fd9\u4e2a\u7aef\u53e3</p> <p>\u5982\u4f55\u5728Linux\u547d\u4ee4\u884c\u4e0b\u53d1\u9001\u548c\u63a5\u6536UDP\u6570\u636e\u5305 - whowin - \u53d1\u8868\u6211\u4e2a\u4eba\u539f\u521b\u4f5c\u54c1\u7684\u6280\u672f\u535a\u5ba2 (gitee.io)</p> <p>/sbin/init /lib/systemd/systemd-udevd /lib/systemd/systemd-timesyncd /usr/bin/VGAuthService /usr/bin/vmtoolsd</p> <p>root \u00a0 \u00a0 \u00a0 \u00a0 732 \u00a00.0 \u00a00.1 168140 \u00a02956 ? \u00a0 \u00a0 \u00a0 \u00a0S \u00a0 \u00a012:23 \u00a0 0:00 (sd-pam)</p> <p>\u76f4\u63a5\u641c sd-pam\uff0c\u597d\u50cf\u662f\u4e2a\u6316\u77ff\u811a\u672c\uff0cpid\u662f732</p> <p>\u4e91\u670d\u52a1\u5668\u53cd\u9ed1\u5ba2\u5165\u4fb5\u653b\u9632\u5b9e\u5f55\uff08\u4e00\uff09 - \u6e05\u5982\u8bb899 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>unhide \u641c\u7d22\u9690\u85cf\u8fdb\u7a0b\u548c TCP/UDP \u7aef\u53e3\u2014\u2014\u901a\u8fc7\u4fee\u6539\u52a0\u8f7d\u7684so\u6587\u4ef6\u6765\u5b9e\u73b0\u9690\u85cf\uff0c\u5f85\u7814\u7a76\u5b9e\u73b0\u601d\u8def - bonelee - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>linux\u9690\u85cf\u75c5\u6bd2\u5904\u7406\uff08top\u67e5\u8be2us\u5360\u752870%\u5de6\u53f3\uff0c\u5374\u6ca1\u6709CPU\u9ad8\u4f7f\u7528\u7684\u8fdb\u7a0b\uff09_top\u547d\u4ee4us\u5f88\u9ad8\u4f46\u6ca1\u8fdb\u7a0b-CSDN\u535a\u5ba2</p> <p>\u91cd\u5f00\u4e2a\u865a\u62df\u673a\uff0c\u626b\u4e00\u4e0b\u6240\u6709\u7a0b\u5e8f</p> <p>Linux Find\u547d\u4ee4\u67e5\u627e\u6307\u5b9a\u65f6\u95f4\u8303\u56f4\u5185\u7684\u6587\u4ef6\u7684\u4f8b\u5b50 - \u7b80\u4e66 (jianshu.com)</p> <pre><code>find / -mtime +3 -type f -print # \u4e09\u5929\u201c\u4ee5\u524d\u201d\u6539\u8fc7\u7684\u6587\u4ef6\nfind / -mtime -3 -type f -print # \u4e09\u5929\u201c\u5185\u201d\u6539\u8fc7\u7684\u6587\u4ef6\nfind / -type f -newermt '2024-2-10' ! -newermt '2024-04-25' # \u6307\u5b9a\u65f6\u95f4\n\n# \u65f6\u95f4\u4e2d\u7684\u547d\u4ee4\uff1am: Modify c: Change b: Birth a: Access\n</code></pre> <p>linux - \u67e5\u627e\u6307\u5b9a\u65f6\u95f4\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u4e2d\u7684\u5173\u952e\u5b57 - Alive_2020 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <pre><code>find . -type f -ctime -1| xargs ls \u2013l \n</code></pre> <ul> <li><code>-type f</code> \u6307\u6587\u4ef6</li> <li><code>ctime</code> c:change</li> <li>ctime\u53c2\u6570\u6307\u6587\u4ef6\u65e5\u671f\u7b49\u72b6\u6001\u6027\u53c2\u6570\u4fee\u6539\uff0cmtime\u53c2\u6570\u6307\u5185\u5bb9\u6539\u53d8\uff1a</li> </ul> <p></p> <p>stat\u547d\u4ee4\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</p> <p>2024-02-12 \u5230 2024-04-25</p> <p></p> <p><code>find / -name \"*.py\" | less</code></p> <p></p> <pre><code>find / -type f -newermt '2024-2-11 4:35:00' ! -newermt '2024-04-25' # \u6709\u8f93\u51fa\nfind / -type f -newermt '2024-2-11 4:36:00' ! -newermt '2024-04-25' # \u65e0\u8f93\u51fa\n</code></pre> <p>\u8bf4\u660e\u88c5\u4e86Python\u5e93\u4e4b\u540e\u5c31\u6ca1\u52a8\uff0c\u6ca1\u5565\u5173\u7cfb</p> <p>\u4ece 2024-02-11 5:35:00 \u5f00\u59cb\u7684</p> <p></p> <p>linux\u6316\u77ff\u8fdb\u7a0b\uff0c\u9690\u85cfCPU\u2014\u2014\u7528top\u3001ps\u7b49\u547d\u4ee4\u5374\u4e00\u76f4\u627e\u4e0d\u5230\u662f\u54ea\u4e2a\u8fdb\u7a0b\u5728\u5360\u7528\uff0ctodo\uff0c\u5f85\u6df1\u5165 - bonelee - \u535a\u5ba2\u56ed (cnblogs.com)</p> <pre><code>cat /proc/net/udp\n</code></pre> <p></p> <pre><code>#!/bin/bash\n\n# \u904d\u5386/proc/\u4e0b\u7684\u6240\u6709\u6570\u5b57\u6587\u4ef6\u5939\uff08\u8fdb\u7a0b\u6587\u4ef6\u5939\uff09\nfor pid_dir in /proc/[0-9]*/; do\n    pid=$(basename \"$pid_dir\")  # \u63d0\u53d6\u8fdb\u7a0bID\n\n    # \u68c0\u67e5\u8fdb\u7a0b\u6587\u4ef6\u5939\u4e0b\u7684fd\u5b50\u6587\u4ef6\u5939\u662f\u5426\u5b58\u5728\n    if [ -d \"$pid_dir\"fd ]; then\n        # \u904d\u5386\u8fdb\u7a0b\u7684fd\u5b50\u6587\u4ef6\u5939\u4e2d\u7684\u6240\u6709\u6587\u4ef6\n        for fd_file in \"$pid_dir\"fd/*; do\n            # \u68c0\u67e5\u6587\u4ef6\u662f\u5426\u662f\u4e00\u4e2asocket\n            if file \"$fd_file\" | grep -q \"socket\"; then\n                # \u8f93\u51fa\u8be5\u8fdb\u7a0bID\uff08\u8fdb\u7a0b\u53f7\uff09\n                echo \"Process $pid has a socket open:\"\n                cat \"$pid_dir\"cmdline  # \u8f93\u51fa\u8fdb\u7a0b\u7684\u547d\u4ee4\u884c\n                echo \"---\"\n                break  # \u627e\u5230\u4e00\u4e2asocket\u540e\u5c31\u9000\u51fa\u5f53\u524d\u8fdb\u7a0b\u7684fd\u6587\u4ef6\u5939\u904d\u5386\n            fi\n        done\n    fi\ndone\n</code></pre> <p></p> <p><code>cat /proc/net/udp</code> \u770b\u770b\u662f\u54ea\u4e2a\u7aef\u53e3</p> <p></p> <p><code>\u672c\u5730 99A2(39330) -&gt; \u8fdc\u7a0b 7C9C(31900)</code></p> <p></p> <p>Linux iptables\u547d\u4ee4\u8be6\u89e3-CSDN\u535a\u5ba2</p> <pre><code># \u6dfb\u52a0\u9632\u706b\u5899\nsudo iptables -A INPUT -s 172.67.189.48 -j DROP\n</code></pre> <p>\u5c1d\u8bd5\u5efa\u7acb\u7aef\u53e3\uff0c\u770b\u770b\u662f\u5426\u88ab\u5360\u7528</p> <p>Linux\u53d1\u9001udp/tcp\u5305\u6700\u7b80\u5355\u65b9\u6cd5-netcat_linux\u53d1\u9001udp\u5305-CSDN\u535a\u5ba2</p> <pre><code>apt install ncat\nnc -v -n -l 192.168.47.131 39330\n</code></pre> <p></p> <p>\u5e76\u6ca1\u6709\u88ab\u5360\u7528\uff0c\u5947\u602a\u4e86</p> <p>\u8bd5\u8bd5\u53d1\u5305</p> <pre><code>nc -v 172.67.189.48 31900\n</code></pre> <p>\u8bd5\u8bd5\u8f6c\u53d1\u5230\u8fd9\u4e2a\u7aef\u53e3</p> <pre><code>vim /etc/sysctl.conf\nnet.ipv4.ip_forward=1\nsysctl -p\nsudo iptables -t nat -A PREROUTING -p udp --dport 39330 -j DNAT --to-destination 172.67.189.48:31900\nsudo iptables -t nat -A POSTROUTING -p udp -d 172.67.189.48 --dport 31900 -j SNAT --to-source 192.168.47.131:11451\n# \u67e5\u770b\u5f53\u524d\u89c4\u5219\nsudo iptables -L -n -t nat\n</code></pre> <p><code>tail -f \u6587\u4ef6</code></p> <p>\u6539\u7aef\u53e3\u4e86 39304</p> <p>\u77e5\u9053\u4e86\uff0c\u5c1d\u8bd5\u8fde\u63a5 <code>nc -v 172.67.189.48 31900</code> \u8fde\u63a5\u8d85\u65f6\uff0c\u6240\u4ee5\u6ca1\u6709\u5efa\u7acb\u8fde\u63a5\uff0c\u6240\u4ee5\u662f\u770b\u4e0d\u5230\u8fdb\u7a0b\u7684\uff0c\u60f3\u529e\u6cd5\u8f6c\u53d1\u4e00\u4e0bip\u7136\u540e\u642d\u4e2a\u670d\u52a1\u5668</p> <p>127.0.0.1:39304 -&gt; 172.67.189.48:31900 \u5982\u4f55\u8f6c\u53d1\u8fd9\u4e2a\u5305\u5230127.0.0.1:11451</p> <p></p> <p>gpt</p> <pre><code>sysctl -w net.ipv4.ip_forward=1\niptables -t nat -N MYCHAIN\niptables -t nat -A OUTPUT -p tcp -s 192.168.47.131 --sport 39304 -d 172.67.189.48 --dport 31900 -j MYCHAIN\niptables -t nat -A MYCHAIN -p tcp -j REDIRECT --to-port 11451\nsudo iptables -t nat -L # \u67e5\u770b\u5f53\u524d\u72b6\u6001\n</code></pre> <p>iptables\u5b9e\u73b0IP\u5730\u5740\u91cd\u5b9a\u5411\uff08\u8f6c\u53d1\uff09 - EasonJim - \u535a\u5ba2\u56ed (cnblogs.com)</p> <pre><code>iptables -t nat -A OUTPUT -d 172.67.189.48 -p udp --dport 31900 -j DNAT --to-destination 192.168.47.131:11451\n</code></pre> <p>\u5220\u9664\u89c4\u5219</p> <pre><code>sudo iptables -t nat -D PREROUTING 1\n</code></pre> <p></p> <pre><code>nc -v -u -l 127.0.0.1 11451\n# u \u662f udp, l \u662f listening\n</code></pre> <p>\u53ef\u4ee5\uff0c\u6536\u5230\u4e86 </p> <p></p> <p>\u4f46\u662f\u8fd8\u662f\u770b\u4e0d\u5230\u8fdb\u7a0bpwp</p> <p></p> <p>192.168.47.132:59471</p> <pre><code>nc -v -u 172.67.189.48 31900 # udp \u8fde\u63a5\n</code></pre> <p>\u6d4b\u8bd5\u4e86\u4e00\u4e0b\uff0cudp\u662f\u53ef\u4ee5\u770b\u5230\u8fdb\u7a0b\u7684\uff0c\u90a3\u5c31\u786e\u5b9a\uff0c\u5c31\u662f\u7a0b\u5e8f\u4e3b\u52a8\u9690\u85cf\u4e86\u8fdb\u7a0b</p> <p></p> <p>\u5c1d\u8bd5\u904d\u5386\u6240\u6709\u7cfb\u7edf\u6587\u4ef6\uff0c\u4f5c\u4e3afile\u547d\u4ee4\u7684\u8f93\u5165\uff0c\u627e\u5230\u8fd9\u4e2asocket</p> <p></p> <p>\u5931\u8d25\uff0c\u9690\u85cf\u4e86</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u8fdb\u7a0b\u9690\u85cf","text":"<p>\u5e94\u6025\u54cd\u5e94\u4e4bLinux\u4e0b\u8fdb\u7a0b\u9690\u85cf - FreeBuf\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u95e8\u6237</p> <p></p> <p>screen <code>Ctrl + A -&gt; Esc</code> \u53ef\u4ee5\u9605\u8bfb\u6a21\u5f0f</p> <p>\uff08\u6e17\u900f\u6d4b\u8bd5\u540e\u671f\uff09Linux\u8fdb\u7a0b\u9690\u85cf\u8be6\u89e3_linux\u9690\u85cf\u8fdb\u7a0b-CSDN\u535a\u5ba2</p> <p></p> <p></p> <p>/etc/.resolv.conf.systemd-resolved.bat</p> <p>\u6280\u672f|\u5982\u4f55\u5728 Linux/Unix/Windows \u4e2d\u53d1\u73b0\u9690\u85cf\u7684\u8fdb\u7a0b\u548c\u7aef\u53e3</p> <p></p> <p></p> <pre><code>strace -o strace_ss.log ss -up\n# \u770b\u770bss\u7684\u8c03\u7528\u60c5\u51b5\n</code></pre> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u4e0a\u9762\u8fd9\u5f20\u56fe\u7247\u5f88\u53ef\u7591\uff0c\u4f3c\u4e4e\u662f\u53d1\u9001\u4e86\u4e00\u4e2a\u5305 <code>sendmsg</code> \u7136\u540e <code>recvmsg</code> \u5c31\u6536\u5230\u4e86\u4e0a\u9762\u7684\u672c\u5730ip\u548c\u8fdc\u7a0bip\uff0c\u4f46\u662fpid\u4e00\u4e2a\u662f0\u4e00\u4e2a\u662f636521\uff0c\u76f4\u63a5\u770bproc\u91cc\u9762\u4e5f\u6ca1\u6709636521</p> <p>getsockname()\u51fd\u6570 Unix/Linux - Unix/Linux\u7cfb\u7edf\u8c03\u7528 (yiibai.com)</p> <pre><code>**int getsockname(int** _s_**, struct sockaddr ***_name_**, socklen_t ***_namelen_**);**\n</code></pre> <p>Linux\u7f16\u7a0b\u4e4brecvmsg\u548csendmsg\u51fd\u6570 - \u5b63\u672b\u7684\u5929\u5802 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>636521</p> <p>\u3010\u8f6c\u3011Linux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u5e38\u89c1\u624b\u6cd5\u53ca\u4fa6\u6d4b\u624b\u6bb5_linux_xian_wwq-GitCode \u5f00\u6e90\u793e\u533a (csdn.net)</p> <pre><code>\u4e13\u4e1a\u4e00\u70b9\u8bdd\uff0c\u4f7f\u7528\u4e00\u4e9b\u7cfb\u7edf\u5b8c\u6574\u6027\u68c0\u67e5\u5de5\u5177\uff0c\u6bd4\u5982tripwrie\u3001aide\u7b49\n</code></pre> <p>4.11.\u00a0\u4f7f\u7528 AIDE\u68c0\u67e5\u5b8c\u6574\u6027 Red Hat Enterprise Linux 7 | Red Hat Customer Portal</p> <pre><code>http://127.0.0.1:5244/p/ss\n</code></pre> <p>systemctl\u547d\u4ee4\u5217\u51fa\u6240\u6709\u670d\u52a1_systemctl list-CSDN\u535a\u5ba2</p> <pre><code>systemctl list-units --type=service --state=running\n</code></pre> <p></p> <p>cron \u662f\u8ba1\u65f6\u4efb\u52a1\uff0c\u6bd4\u5982\u6bcf\u65e5\u3001\u6bcf\u5468\uff0c\u4f3c\u4e4e\u4e5f\u6ca1\u4ec0\u4e48</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E5%B8%95%E9%B2%81%E6%9C%8D%E5%8A%A1%E5%99%A8/#_2","title":"\u7ee7\u7eed","text":"<p>linux\u4e0b\u8fdb\u7a0b\u9690\u85cf\u7684\u4e00\u4e9b\u7814\u7a76 - \u5148\u77e5\u793e\u533a (aliyun.com)</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E8%8F%9C%E7%8B%97%E5%B7%A5%E5%85%B7/","title":"\u83dc\u72d7\u5de5\u5177","text":""},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E8%8F%9C%E7%8B%97%E5%B7%A5%E5%85%B7/#1","title":"\u5de5\u51771","text":"<p>\u5b66\u957f\u63d0\u9192 SSTI \u6ce8\u5165\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884cshell\u547d\u4ee4\uff0ccat\u5c31\u51fa\u6765\u4e86</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E8%8F%9C%E7%8B%97%E5%B7%A5%E5%85%B7/#2","title":"\u5de5\u51772","text":"<p>hint1: not_flag \u91cc\u7684\u5185\u5bb9\u4e0d\u662f\u8003\u70b9\uff01</p> <p>hint2: poster.jpg\u00a0\u89c2\u5bdf\u5e76\u601d\u8003</p> <p></p> <ol> <li><code>cat not_flag</code> \u663e\u793a <code>CHROOT JAIL</code>\uff0c\u51fa\u9898\u4eba\u8868\u793a\u4e0d\u662f\u8003\u70b9</li> <li>\u5c1d\u8bd5 <code>__globals__['flag']</code> \u548c <code>__globals__.get('flag')</code></li> <li>\u627e\u5230\u62ff\u5230\u5176\u4ed6\u6a21\u5757\u7684 <code>__builtins__</code> \u7684\u529e\u6cd5\uff0c\u7136\u540e\u9ed1\u540d\u5355\u95ee\u9898\u89e3\u51b3\u4e86</li> <li>\u6574\u534a\u5929\u6ca1\u6574\u51fa\u6765\uff0c\u5c1d\u8bd5\u4e00\u4e9bshell\u547d\u4ee4\uff0c\u6bd4\u5982 <code>find</code> \uff0c\u5931\u8d25</li> <li>\u6b6a\u4e2a\u8def\uff0c\u5c1d\u8bd5 <code>from importlib import reload</code>\uff0c\u6ca1\u5565\u7528</li> <li>\u5c1d\u8bd5\u83b7\u53d6python\u6e90\u7801\uff0c<code>get_source</code> \u5931\u8d25</li> <li>\u5f00\u59cb\u67e5\u770b\u5b57\u8282\u7801 <code>dis.dis(module_name, file=i)</code> \uff0c\u83b7\u53d6\u5230 <code>./app.py</code> \u7684\u5b57\u8282\u7801\uff0c\u627e\u4e0d\u5230flag\uff0c\u672c\u5730\u8c03\u8bd5\u4e4b\u540e\uff0c\u53d1\u73b0\u5168\u5c40\u53d8\u91cf\u5e76\u4e0d\u4f1a\u76f4\u63a5\u5230\u5b57\u8282\u7801\u4e2d\uff08\u540e\u7eed\uff1a\u76f4\u63a5\u8fd9\u6837\u4f20\u5165\u5e76\u4e0d\u4f1a\u7ed9\u51fa\u5b8c\u5168\u7684\u5b57\u8282\u7801\uff09</li> <li>\u53d1\u73b0\u91cd\u65b0\u628a\u6574\u4e2a\u6587\u4ef6\u5bfc\u5165\uff0c\u7136\u540e <code>compile</code> \u7f16\u8bd1\uff08\u6210 <code>Code Object</code> \uff09\u518d <code>dis.dis</code>\uff0c\u5c31\u6709\u5168\u5c40\u53d8\u91cf\u4e86\uff0c\u6240\u4ee5\u5f97\u60f3\u529e\u6cd5\u627e\u5230\u6574\u4e2a\u6587\u4ef6\u7684 <code>Code Object</code></li> <li>\u627e\u5230 <code>StackOverflow</code> \u7684\u8d44\u6599\uff0c\u76f4\u63a5 <code>dis.dis</code> \u51fa\u6765\u7684\u5b57\u8282\u7801\u662f\u4e0d\u5305\u542b\u6700\u5916\u5c42\u7684\u4ee3\u7801\u7684\uff0c\u8981\u7528 <code>frame.f_back</code> \u9010\u5c42\u8fd4\u56de\uff0c\u76f4\u5230\u6700\u9876\u5c42</li> <li>\u901a\u8fc7\u904d\u5386 <code>frame.f_back</code>\uff0c\u53ef\u4ee5\u6253\u5370\u51fa\u5806\u6808\uff0c\u53d1\u73b0\u6700\u9876\u5c42\u7684\u662f <code>threading</code>\uff0c\u8bf4\u660e\u4e0d\u662f\u4e3b\u7ebf\u7a0b</li> <li>\u6253\u5370\u51fa\u4e3b\u7ebf\u7a0b <code>threading.enumerate()[0]</code>\uff0c\u7136\u540e\u6309\u7167 <code>StackOverflow</code> \u7ed9\u51fa\u7684 <code>frame = sys._current_frames().get(main_thread.ident, None)</code>  \u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u4e3b\u7ebf\u7a0b\u7684 <code>frame</code></li> <li>\u4e3b\u7ebf\u7a0b\u6700\u9876\u5c42\u7684 <code>frame</code> \u5c31\u662f <code>./app.py</code> \uff0c\u6b64\u65f6 <code>dis.dis</code> \u5c31\u53ef\u4ee5\u62ff\u5230 <code>frame</code></li> </ol>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E8%AE%A1%E7%AE%97%E5%99%A8/","title":"\u8ba1\u7b97\u5668","text":"<p>malloc\u5206\u914d\u5185\u5b58\u8fdb\u884c\u5bf9\u9f50\u7684\u64cd\u4f5c - Carlos\u00b7Wei - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>\u6240\u4ee5\u4ecerequest2size\u53ef\u77e5\uff0c\u572864\u4f4d\u7cfb\u7edf\uff0c\u5982\u679c\u7533\u8bf7\u5185\u5b58\u4e3a1\uff5e24\u5b57\u8282\uff0c\u7cfb\u7edf\u5185\u5b58\u6d88\u801732\u5b57\u8282\uff0c\u5f53\u7533\u8bf725\u5b57\u8282\u7684\u5185\u5b58\u65f6\uff0c\u7cfb\u7edf\u5185\u5b58\u6d88\u801748\u5b57\u8282\u3002\u800c\u5bf9\u4e8e32\u4f4d\u7cfb\u7edf\uff0c\u7533\u8bf7\u5185\u5b58\u4e3a1\uff5e12\u5b57\u8282\u65f6\uff0c\u7cfb\u7edf\u5185\u5b58\u6d88\u8017\u4e3a16\u5b57\u8282\uff0c\u5f53\u7533\u8bf7\u5185\u5b58\u4e3a13\u5b57\u8282\u65f6\uff0c\u7cfb\u7edf\u5185\u5b58\u6d88\u8017\u4e3a24\u5b57\u8282\u3002</p> <p>python - Convert hex to float - Stack Overflow</p> <pre><code>&gt;&gt;&gt; import struct\n&gt;&gt;&gt; struct.unpack('!f', bytes.fromhex('41973333'))[0]\n18.899999618530273\n&gt;&gt;&gt; struct.unpack('!f', bytes.fromhex('41995C29'))[0]\n19.170000076293945\n&gt;&gt;&gt; struct.unpack('!f', bytes.fromhex('470FC614'))[0]\n36806.078125\n</code></pre> <p>Base Convert: IEEE 754 Floating Point</p> <p>Python\u5b9e\u73b0\u6d6e\u70b9\u6570\u5236\uff08IEEE-754\uff09\u7684\u8f6c\u6362\u2014\u2014struct - \u77e5\u4e4e (zhihu.com)</p> <p>4.1986725672294305e-140</p> <p>\u76f4\u63a5\u6539\u62100x21\uff0c\u5c31\u53ef\u4ee5malloc\u5230\u53e6\u5916\u7684\u5730\u65b9</p> <p>1.63e-322</p> <p>\u4e0d\u884c\uff0c\u8d3c\u5c0f\u7684\u6570\u52a0\u8d77\u6765\u4e0d\u4f1a\u6709\u7cbe\u5ea6\u635f\u5931</p>"},{"location":"%E8%B5%9B%E4%BA%8B/2024%E6%B5%B7%E6%B4%8B%E6%9D%AF/%E8%AE%A1%E7%AE%97%E5%99%A8/#-8e-323","title":"()+()-8e-323","text":"<p>\u53ef\u4ee5\u91cd\u7f6e\u5806\u7684\u987a\u5e8f</p> <p></p> <p>5e-324 \u8fd9\u4e2a\u7684\u5341\u8fdb\u5236\u662f1</p> <pre><code>()+()+0+0+0+0+0+0+0+0+0+0+0+0-8e-323\n\n()+()+()+()+()+()+()+()+()-5e-324\n</code></pre> <pre><code>2.008776679223492e-139\n2323232323232323\n\n5e-324\n1\n</code></pre> <pre><code>37 2B 28 00 00 00 00 00\n6.08864182749133e-43\nE1 00 00 00 00 00 00 00\n-1.757388200993436e+159\n</code></pre> <pre><code>18 2C 28 00 00 00 00 00\nE1 00 00 00 00 00 00 00\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/","title":"\u5b89\u5353\u9006\u5411","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#1","title":"1. \u5b89\u5353\u73af\u5883","text":"<p>\u771f\u673a\u6216\u8005\u6a21\u62df\u5668\uff0c\u6700\u597d\u7528\u5907\u7528\u673a\u5668\u4f5c\u4e3a\u771f\u673a\uff0c\u9700\u8981root\u548c\u5b89\u88c5Magisk</p> \u73af\u5883 \u4f18\u70b9 \u7f3a\u70b9 \u771f\u673a \u7a33\u5b9a\uff0carm64\u67b6\u6784 root\u7684\u8fc7\u7a0b\u6bd4\u8f83\u9ebb\u70e6 \u84dd\u53e0\u6a21\u62df\u5668 \u7a33\u5b9a \u4ec5\u652f\u6301x64\u67b6\u6784\uff0c\u4e0d\u80fd\u5b89\u88c5Magisk WSA \u4f53\u9a8c\u5f88\u597d \u4e0d\u7a33\u5b9a\uff0c\u9047\u5230\u5d29\u6e83\u7684app\u4f1a\u5bfc\u81f4WSA\u7cfb\u7edf\u91cd\u542f ## 2. \u6253\u5f00\u8c03\u8bd5\u603b\u5f00\u5173 <p>\u5373\u628a <code>ro.debuggable</code> \u8bbe\u7f6e\u62101</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#magisk-resetprop","title":"\u4f7f\u7528Magisk resetprop","text":"<p>\u9700\u8981root\uff1b\u9700\u8981\u5b89\u88c5Magisk\uff1b\u771f\u673a\u3001WSA\u5747\u53ef</p> <p>\u91cd\u542f\u540e\u5931\u6548</p> <pre><code>adb shell \"su -c magisk resetprop ro.debuggable 1\"\nadb shell \"stop;start;\"\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#magiskhidepropsconf","title":"MagiskHidePropsConf\u6a21\u5757","text":"<p>\u9700\u8981root\uff1b\u9700\u8981\u5b89\u88c5Magisk\uff1b\u91cd\u542f\u540e\u4f9d\u7136\u751f\u6548</p> <p>Magisk-Modules-Repo/MagiskHidePropsConf</p> <p>\u5b89\u88c5\u6a21\u5757\u4e4b\u540e</p> <pre><code>adb shell \"su -c prop ro.debuggable 1\" # \u7136\u540e\u6309y\u56de\u8f66\nadb shell \"su -c magisk resetprop ro.debuggable\" # \u68c0\u67e5\u662f\u5426\u8bbe\u7f6e\u6210\u529f\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#mprop","title":"\u4f7f\u7528mprop","text":"<p>\u9700\u8981root\uff1b\u4e0d\u9700\u8981\u5b89\u88c5Magisk\uff1b\u91cd\u542f\u540e\u5931\u6548\uff1b\u53ea\u6709armv8\u548cv7</p> <p>wpvsyou/mprop</p> <pre><code>adb push mprop /data/local/tmp/\nadb shell \"su -c chmod +x /data/local/tmp/mprop\"\nadb shell \"su -c /data/local/tmp/mprop ro.debuggable 1\"\n</code></pre> <p>ddms\u6ca1\u6709\u88ab\u5220\u9664tools/monitor.bat\u5c31\u662f\uff08\u6ce8\u610f\u914d\u5408java8\u624d\u80fd\u8fd0\u884c\uff0c\u9ad8\u7248\u672c\u4e0d\u884c\uff0c\u5f88\u5751\uff09</p> <p>\u5728monitor.ini\u91cc-vmargs\u524d\u9762\u8bbe\u7f6e1.8\u7684\u73af\u5883\u4fe1\u606f\u5c31\u884c\u4e86  </p> <p>\u4e0d\u8fc7\u597d\u50cf\u4eb2\u6d4bJava18\u4e5f\u80fd\u8fd0\u884c</p> <pre><code>-vm C:\\Program Files\\Java\\jdk1.8.0_191\\bin\\javaw.exe  \n-vmargs\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#wsa","title":"\u90e8\u7f72WSA\uff08\u4e0d\u7a33\u5b9a\uff09","text":"<p>MustardChef/WSABuilds</p> <p>\u6ce8\u610f\u9700\u8981\u4f7f\u7528\u6700\u65b0\u7248\u7684 7z \u89e3\u538b\uff0c<code>Run.bat</code> \u5373\u53ef\u5b89\u88c5</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#_2","title":"\u8c03\u8bd5","text":"<p>\u4e0d\u5141\u8bb8\u8c03\u8bd5\u7684app\uff0c\u5f3a\u884c\u8c03\u8bd5</p> <pre><code>adb connect 127.0.0.1:58526\nadb shell \"su -c magisk resetprop ro.debuggable 1\"\nadb shell \"stop;start;\"\n</code></pre> <pre><code>adb shell am start -D -n com.example.ctf/.MainActivity\n</code></pre> <p>\u7136\u540e\u5c31\u53ef\u4ee5 Jeb Attach \u4e86</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#idaso","title":"IDA\u8c03\u8bd5so","text":"<pre><code>adb push android_x64_server /data/local/tmp/\nadb forward tcp:23946 tcp:23946 # \u7aef\u53e3\nadb shell\nsu\ncd /data/local/tmp\nchmod +x android_x64_server\n./android_x64_server\n</code></pre> <pre><code>$package=\"com.example.ezadvm\"\nadb shell am start -D -n $package/.MainActivity # \u542f\u52a8\n# IDA Attach\n# \u67e5\u770bpid\n# $tmp_pid=(adb shell \"ps | grep '$package' | tr -s ' ' | cut -d ' ' -f 2\")\njdb -connect com.sun.jdi.SocketAttach:hostname=127.0.0.1,port=8700\n</code></pre> <p>\u603b\uff1a</p> <p>\u51c6\u5907\uff1a</p> <pre><code>adb connect 127.0.0.1:58526\nadb shell \"su -c magisk resetprop ro.debuggable 1\"\nadb shell \"stop;start;\"\n</code></pre> <pre><code>adb forward tcp:23946 tcp:23946 # \u7aef\u53e3\nadb shell \"su -c /data/local/tmp/android_x64_server\"\n</code></pre> <pre><code>$package=\"com.example.re11113\"\nadb shell am start -D -n $package/.MainActivity # \u542f\u52a8\n$tmp_pid=(adb shell \"ps | grep '$package' | tr -s ' ' | cut -d ' ' -f 2\")\necho \"attach_process($tmp_pid)\"\n# \u590d\u5236\u5230\u8fd9\u91cc\uff0cIDA Attach\nadb forward tcp:8700 jdwp:$tmp_pid\njdb -connect com.sun.jdi.SocketAttach:hostname=127.0.0.1,port=8700\n# connect\u4e4b\u540e\u4f1a\u5361\u4f4f\uff0c\u5728IDA\u6309F9\u5c31\u53ef\u4ee5\u7ee7\u7eed\u8fd0\u884c\u4e86\n</code></pre> <p>\u4f46\u662f\u62a5\u9519\u4e86\uff1a</p> <pre><code>got SIGSEGV signal (Segmentation violation) (exc.code b, tid 11422)\n</code></pre> <p>\u96be\u641e</p> <pre><code>adb shell \"su -c logcat | grep $tmp_pid\" &gt; logcat.log\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Android/#_3","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>Android\u641e\u673a\u4e4b\u6253\u5f00\u7cfb\u7edf\u8c03\u8bd5\u603b\u5f00\u5173ro.debuggable - \u77e5\u4e4e (zhihu.com)</li> <li>\u65b0\u624b\u5411\u603b\u7ed3\uff1aIDA\u52a8\u6001\u8c03\u8bd5So\u7684\u4e00\u4e9b\u5751 - \u77e5\u4e4e (zhihu.com)</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/C%2B%2Bflit/","title":"\u7f8e\u5316C++\u51fd\u6570\u540d","text":"<p>c++filt - \u8fd8\u539fso\u4e2d\u7684\u51fd\u6570\u540d | m4bln (mabin004.github.io)</p> <p>C++\u662f\u5141\u8bb8\u51fd\u6570\u91cd\u8f7d\u7684\uff0c\u4e5f\u5c31\u5f15\u51fa\u4e86\u7f16\u8bd1\u5668\u7684name mangling\uff08\u540d\u5b57\u4fee\u9970\uff09\u673a\u5236,\u5176\u76ee\u7684\u662f\u7ed9\u540c\u540d\u7684\u91cd\u8f7d\u51fd\u6570\u4e0d\u540c\u7684\u7b7e\u540d\u3002</p> <p>\u8fd9\u91cc\u4f7f\u7528 <code>c++filt</code> \u7684\u589e\u5f3a\u7248\u672c\u2014\u2014nico/demumble</p> <p>cp \u5230 /usr/bin/ \u5373\u53ef</p> <pre><code>$ demumble _ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareEPKc\nstd::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt;&gt;::compare(char const*) const\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Docker/","title":"Docker","text":"<pre><code>docker run --rm -it -p 8000:8000 -v ${PWD}:/docs squidfunk/mkdocs-material\ndocker run --it --net host -v ${PWD}:/root ubuntu:22.04 /bin/sh # \u5171\u4eab\u7f51\u7edc\n</code></pre> <p>\u8be6\u7ec6\u53ef\u4ee5\u4f7f\u7528 <code>docker run --help</code> \u67e5\u770b</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/EDB_LinuxOD/","title":"Linux\u5e73\u53f0\u7684OD","text":"<p>eteran/edb-debugger: edb is a cross-platform AArch32/x86/x86-64 debugger. (github.com)</p> <p>Compiling (Ubuntu) \u00b7 eteran/edb-debugger Wiki (github.com)</p> <pre><code># install dependencies\nsudo apt-get install         \\\n    cmake                    \\\n    build-essential          \\\n    libdouble-conversion-dev \\\n    libqt5xmlpatterns5-dev   \\\n    qtbase5-dev              \\\n    qt5-qmake                \\\n    qttools5-dev             \\\n    libqt5svg5-dev           \\\n    libgraphviz-dev          \\\n    libcapstone-dev          \\\n    pkg-config               \\\n    qttools5-dev\n\n# build and run edb\ngit clone --recursive https://github.com/eteran/edb-debugger.git\ncd edb-debugger\nmkdir build\ncd build\ncmake ..\nmake\n./edb\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/","title":"IDA\u7684\u7cd5\u96c6\u4f7f\u7528\u5bc4\u5de7","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_1","title":"\u5feb\u6377\u952e","text":"<p>\u4ece\u5b98\u7f51\u6252\u4e0b\u6765 p\u4e86\u4e00\u4e0b\u7684\u56fe</p> <p></p> <p>\u3010\u770b\u96ea\u8bba\u575b\u3011IDA\u6280\u5de7\u2014\u2014\u7ed3\u6784\u4f53</p> <p>IDA PRO 8.3 x86/x64/ARM/ARM64/MIPS/PPC/PPC64 (leakforum.io)</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_2","title":"\u57fa\u7840","text":"<ul> <li>F5 \u53cd\u7f16\u8bd1 / \u5237\u65b0\u53cd\u7f16\u8bd1\uff08patch\u6216\u8005\u5e94\u7528\u7ed3\u6784\u4f53\u4e4b\u540e\uff09</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_3","title":"\u5feb\u7167","text":"<ul> <li>Ctrl_Shift_W \u4fdd\u5b58\u5feb\u7167</li> <li>Ctrl_Shift_T \u8fd8\u539f\u5feb\u7167</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_4","title":"\u6807\u8bb0","text":"<ul> <li>Alt_M \u6253\u6807\u673a</li> <li>Ctrl_M \u4f20\u9001\u6807\u8bb0</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_5","title":"\u7ed3\u6784\u4f53","text":"<ol> <li>Shift_F1 \u672c\u5730\u5c5e\u6027\u7a97\u53e3</li> <li>\u6309 Insert \u4ee5C\u8bed\u8a00\u8bed\u6cd5\u5b9a\u4e49\u7ed3\u6784\u4f53</li> <li>Ctrl_F \u641c\u7d22\u521a\u5b9a\u4e49\u7684\u7ed3\u6784\u4f53\uff0c\u53cc\u51fb\u5bfc\u5165\u7ed3\u6784\u4f53</li> <li>\u53f3\u952e\u53d8\u91cf -&gt; <code>Convert to struct...</code></li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_6","title":"\u7ed3\u6784\u4f53\u6570\u7ec4","text":"<ol> <li>Alt_Q \u628a\u7b2c\u4e00\u4e2a\u5143\u7d20\u5b9a\u4e49\u4e3a\u7ed3\u6784\u4f53</li> <li>Shift_* \u5b9a\u4e49\u6570\u7ec4</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_7","title":"\u6252\u6570\u636e","text":"<ol> <li>Shift_E \u63d0\u53d6\u4e8c\u8fdb\u5236\u6570\u636e</li> <li>\u5728C\u4ee3\u7801\u754c\u9762 R ascii\u7801\u8f6c\u6362\u6210\u5b57\u7b26</li> <li>D \u628a\u6c47\u7f16\u6307\u4ee4\u8f6c\u6362\u6210\u6570\u5b57\u683c\u5f0f</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_8","title":"\u51fd\u6570","text":"<ol> <li>E \u4fee\u6539\u51fd\u6570\u7684\u7ed3\u5c3e\u5230\u5f53\u524d\u4f4d\u7f6e</li> <li>Alt_P \u7f16\u8f91\u51fd\u6570\u7684\u8be6\u7ec6\u4fe1\u606f</li> <li>Alt_E_F_D \u5220\u9664\u51fd\u6570\u5b9a\u4e49 \u2014\u2014 \u5176\u5b9e\u5c31\u662f\u6a21\u62df\u9009\u62e9 Edit - Functions - Delete function</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#idapython","title":"idapython","text":"<p>\u5b98\u65b9\u6587\u6863</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#pip","title":"\u4f7f\u7528pip\u88c5\u5e93","text":"<p>\u5728IDA\u91cc\u6267\u884c\uff0c\u52a0\u4e2a\u611f\u53f9\u53f7</p> <pre><code>!pip install xxx\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_9","title":"\u8bbe\u7f6e","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_10","title":"\u5b57\u4f53","text":"<p>IDA\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5de5\u4f5c\u533a\u90fd\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5df1\u7684\u5b57\u4f53\u5927\u5c0f\uff0c\u9009\u4e2d\u5de5\u4f5c\u533a\u4e4b\u540e\uff0c\u70b9 Options - Fonts</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_11","title":"\u7a97\u53e3\u8c03\u6574","text":"<p>\u62d6\u52a8\u5b50\u7a97\u53e3\u7684\u6807\u9898\u540d\uff0c\u5c31\u53ef\u4ee5\u628a\u5b50\u7a97\u53e3\u62d6\u51fa\u6765</p> <p>\u628a\u9f20\u6807\u653e\u5728\u6807\u9898\u540d\u7684\u4e0b\u9762\u7684\u7070\u8272\u7684\u6761\u6761\uff0c\u5c31\u53ef\u4ee5\u5355\u51fb\u62d6\u56de\u53bb</p> <p></p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_12","title":"\u663e\u793a\u6c47\u7f16\u8be6\u7ec6\u4fe1\u606f","text":"<p>Options - General - Disassembly</p> \u540d\u79f0 \u529f\u80fd Line Prefixed (Graph) \u5728Graph\u4e2d\u663e\u793a\u884c\u53f7 Stack pointer \u663e\u793a\u6808\u6307\u9488\uff0c\u4fbf\u4e8e\u5206\u6790\u6808\u5e73\u8861 Auto Comments \u663e\u793a\u6c47\u7f16\u547d\u4ee4\u63cf\u8ff0 Number of opcode... \u663e\u793a\u673a\u5668\u7801\uff0c0\u4e3a\u4e0d\u663e\u793a\uff0c\u975e0\u8bbe\u7f6e\u663e\u793a\u5bbd\u5ea6"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_13","title":"\u8c03\u8bd5","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#_14","title":"\u6682\u505c\u6cd5","text":"<p>\u5982\u679c\u7a0b\u5e8f\u6709\u7c7b\u4f3c <code>scanf</code> <code>getchar</code> \uff0c\u5c31\u53ef\u4ee5\u70b9\u51fb <code>\u6682\u505c</code> \uff0c\u8fd9\u6837\u8f93\u5165\u5b57\u7b26\u4e32\u4e4b\u540e\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u505c\u5728\u8fd9\u4e9b\u51fd\u6570\u4e0a\uff0c\u7136\u540e\u67e5\u770b\u8c03\u7528\u5806\u6808\uff0c\u5c31\u53ef\u4ee5\u5206\u6790\u7a0b\u5e8f\u7684\u5173\u952e\u90e8\u5206</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA/#rebase","title":"Rebase","text":"<p>\u5bf9\u4e8e\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684so\u6587\u4ef6\uff0c\u5982\u4f55\u627e\u5230\u5bf9\u5e94\u51fd\u6570\u662f\u5173\u952e</p> <p>\u7b49\u5230\u5185\u5b58\u4e2d\u52a0\u8f7d\u4e86\u5bf9\u5e94\u7684so\u6587\u4ef6\u4e4b\u540e\uff0c<code>Ctrl-S</code> \u9009\u62e9 <code>so</code> \u6700\u4f4e\u5730\u5740\u7684\u6bb5\uff0c\u590d\u5236\u5730\u5740</p> <p>\u590d\u5236\u4e00\u4efdso\uff0c\u518d\u7528IDA\u6253\u5f00\uff0c <code>Edit -&gt; Segments -&gt; Rebase Program</code> \u586b\u4e0a\u4e0a\u9762\u7684\u5730\u5740\uff0c\u5c31\u4e0d\u7528\u6bcf\u6b21\u90fd\u8ba1\u7b97\u5730\u5740\u4e86</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/","title":"IDA\u9519\u8bef\u624b\u518c","text":"<p>\u4ece Failures and troubleshooting (hex-rays.com) \u590d\u5236</p> <p>The following failure categories exist:</p> <ol> <li>a crash or access violation</li> <li>internal consistency check failure (interr)</li> <li>graceful failure to decompile a function</li> <li>incorrect output text</li> <li>inefficient/unclear/suboptimal output text</li> </ol> <p>The current focus is on producing a correct output for any correct function. The decompiler should not crash, fail, or produce incorrect output for a valid input. Please file a\u00a0bugreport\u00a0if this happens.</p> <p>The decompiler has an extensive set of internal checks and assertions. For example, it does not produce code which dereferences a \"void*\" pointer. On the other hand, the produced code is not supposed to be compilable and many compilers will complain about it. This is a deliberate choice of not making the output 100% compilable because the goal is not to recompile the code but to let humans analyze it faster.</p> <p>The decompiler uses some C++ constructs in the output text. Their use is restricted to constructs which cannot be represented in C (the most notable example is passing structures to functions by value).</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#internal-errors","title":"Internal errors","text":"<p>When the decompiler detects an internal inconsistency, it displays a message box with the error code. It also proposes you to send the database to the hex-rays.com server:</p> <p></p> <p>It is really difficult (almost impossible) to reproduce bugs without a sample database, so please send it to the server. To facilitate things, the decompiler saves its internal state to the database, which is really handy if the error occurs after hours and hours of decompilation.</p> <p>It is impossible to decompile anything after an internal error. Please reload the database, or better, restart IDA.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#graceful-failures","title":"Graceful failures","text":"<p>When the decompiler gracefully fails on a function, it will display one of the following messages. In general, there is no need to file a bugreport about a failure except if you see that the error message should not be displayed.</p> <ul> <li>#cannot convert to microcode</li> <li>#not enough memory</li> <li>#invalid basic block</li> <li>#positive sp value has been found</li> <li>#prolog analysis failed</li> <li>#switch analysis failed</li> <li>#exception analysis failed</li> <li>#stack frame is too big</li> <li>#local variable allocation failed</li> <li>#16-bit functions are not supported</li> <li>#call analysis failed</li> <li>#function frame is wrong</li> <li>#undefined or illegal type</li> <li>#inconsistent database information</li> <li>#wrong basic type sizes in compiler settings</li> <li>#redecompilation has been required</li> <li>#could not compute fpu stack states</li> <li>#max recursion depth reached during lvar allocation</li> <li>#variables would overlap</li> <li>#partially initialized variable</li> <li>#too complex function</li> <li>#only 32-bit functions can be decompiled for the current database</li> <li>#only 64-bit functions can be decompiled for the current database</li> <li>#already decompiling a function</li> <li>#far memory model is supported only for pc</li> <li>#special segments cannot be decompiled</li> <li>#too big function</li> <li>#bad input ranges</li> <li>#current architecture is not supported</li> <li>#bad instruction in the delay slot</li> </ul> <p>Please read the\u00a0Troubleshooting\u00a0section about the possible actions.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#cannot-convert-to-microcode","title":"cannot convert to microcode","text":"<p>This error means that the decompiler could not translate an instruction at the specified address into microcode. Please check the instruction and its length. If it looks like a regular instruction used in the compiler generated code and its length is correct, file a bugreport.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#not-enough-memory","title":"not enough memory","text":"<p>The error message is self-explanatory. While it should not happen very often, it still can be seen on functions with huge stacks. No need to report this bug. Hopefully the next version will handle functions with huge stack more efficiently.</p> <p>Please restart IDA after this error message.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#invalid-basic-block","title":"invalid basic block","text":"<p>This error means that at the specified address there is a basic block, which does not end properly. For example, it jumps out of the function, ends with a non-instruction, or simply contains garbage. If you can, try to correct the situation by modifying the function boundaries, creating instructions, or playing with function tails. Usually this error happens with malformed functions.</p> <p>If the error happens because of a call, which does not return, marking the called function as \"noret\" will help. If the call is indirect, adding a cross reference to a \"noret\" function will help too.</p> <p>If this error occurs on a database created by an old version of IDA, try to reanalyze the program before decompiling it. In general, it is better to use the latest version of IDA to create the databases for decompilation.</p> <p>Unrecognized table jumps may lead to this failure too.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#positive-sp-value-has-been-found","title":"positive sp value has been found","text":"<p>The stack pointer at the specified address is higher than the initial stack pointer. Functions behaving so strangely cannot be decompiled. If you see that the stack pointer values are incorrect, modify them with the\u00a0Alt-K (Edit, Functions, Change stack pointer)\u00a0command in IDA.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#prolog-analysis-failed","title":"prolog analysis failed","text":"<p>Analysis of the function prolog has failed. Currently there is not much you can do but you will not see this error very often. The decompiler will try to produce code with prolog instructions rather than stopping because of this failure.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#switch-analysis-failed","title":"switch analysis failed","text":"<p>The switch idiom (an indirect jump) at the specified address could not be analyzed. You may specify the switch idiom manually using\u00a0Edit, Other, Specify switch idiom.</p> <p>If this error occurs on a database created by an old version of IDA, try to delete the offending instruction and recreate it. Doing so will reanalyze it and might fix the error because newer versions of IDA handle switches much better than older versions.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#exception-analysis-failed","title":"exception analysis failed","text":"<p>This error message should not occur because the current version will happily decompile any function and just ignore any exception handlers and related code.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#stack-frame-is-too-big","title":"stack frame is too big","text":"<p>Since the stack analysis requires lots of memory, the decompiler will refuse to handle any function with the unaliased stack bigger than 1 MB.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#local-variable-allocation-failed","title":"local variable allocation failed","text":"<p>This error message means that the decompiler could not allocate local variables with the registers and stack locations. You will see this error message only if you have enabled HO_IGNORE_OVERLAPS in the\u00a0configuration file. If overlapped variables are allowed in the output, they are displayed in red.</p> <p>Please check the prototypes of all involved functions, including the current one. Variables types and definitions may cause this error too.</p> <p>Updating the function stack frame and creating correct stack variables too may help solve the problem.</p> <p>If you got this error after some manipulations with the function type or variable types, you may reset the information about the current function (Edit, Other, Reset decompiler information) and start afresh.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#16-bit-functions-are-not-supported","title":"16-bit functions are not supported","text":"<p>The message text says it all. While the decompiler itself can be fine tuned to decompile 16-bit code, this is not a priority.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#call-analysis-failed","title":"call analysis failed","text":"<p>This is the most painful error message but it is also something you can do something about. In short, this message means that the decompiler could not determine the calling convention and the call parameters. If this is a direct non-variadic call, you can fix it by specifying the callee type: just jump to the callee and hit\u00a0Y\u00a0to specify the type. For variadic functions too it is a good idea to specify the type, but the call analysis could still fail because the decompiler has to find out the actual number of arguments in the call. We would recommend to start by checking the stack pointer in the whole function. Get rid of any incorrect stack pointer values. Second, check the types of all called functions. If the type of a called function is wrong, it can interfere with other calls and lead to a failure. Here is a small example:</p> <p>push eax </p> <p>push edx </p> <p>push eax </p> <p>call f1 </p> <p>call f2</p> <p>If f1 is defined as a\u00a0__stdcall\u00a0function of 3 arguments, and f2 is a function of 1 argument, the call analysis will fail because we need in total 4 arguments and only 3 arguments are pushed onto the stack.</p> <p>If the error occurs on an indirect call, please\u00a0specify the operand type\u00a0of the call instruction. Also,\u00a0adding an xref\u00a0to a function of the desired type from the call instruction will work. The decompiler will use the type of the referenced function.</p> <p>If all input types are correct and the stack pointer values are correct but the decompiler still fails, please file a bugreport.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#function-frame-is-wrong","title":"function frame is wrong","text":"<p>This is a rare error message. It means that something is wrong with the function stack frame. The most probable cause is that the return address area is missing in the frame or the function farness (far/near) does not match it.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#undefined-or-illegal-type","title":"undefined or illegal type","text":"<p>This error can occur if a reference to a named type (a typedef) is made but the type is undefined. The most common case is when a type library (like vc6win.til) is unloaded. This may invalidate all references to all types defined in it.</p> <p>This error also occurs when a type definition is illegal or incorrect. To fix an undefined ordinal type, open the local types windows (Shift-F1) and redefine the missing type.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#inconsistent-database-information","title":"inconsistent database information","text":"<p>Currently this error means that the function chunk information is incorrect. Try to redefine (delete and recreate) the function.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#wrong-basic-type-sizes-in-compiler-settings","title":"wrong basic type sizes in compiler settings","text":"<p>Some basic type sizes are incorrect. The decompiler requires that</p> <ul> <li>sizeof(int) == 4</li> <li>sizeof(enum) == 4</li> </ul> <p>Please check the type sizes in the Options, Compiler dialog box and modify them if they are incorrect.</p> <p>Also ensure that the correct memory model is selected: \"near data, near code\".</p> <p>Finally, the pointer size must be:</p> <ul> <li>for 32-bit applications use \"near 32bit, far 48bit\"</li> <li>for 64-bit applications use \"64bit\". </li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#redecompilation-has-been-required","title":"redecompilation has been required","text":"<p>This is an internal error code and should not be visible to the end user. If it still gets displayed, please file a bugreport.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#could-not-compute-fpu-stack-states","title":"could not compute fpu stack states","text":"<p>The decompiler failed to trace the FPU stack pointer. Please check the called function types, this is the only thing available for the moment. We will introduce workarounds and corrective commands in the future. For more information about floating point support, please follow\u00a0link.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#max-recursion-depth-reached-during-lvar-allocation","title":"max recursion depth reached during lvar allocation","text":"<p>Please file a bugreport, normally this error message should not be displayed.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#variables-would-overlap","title":"variables would overlap","text":"<p>This is a variant of the\u00a0variable allocation failure\u00a0error. You will see this error message only if you have enabled HO_IGNORE_OVERLAPS in the\u00a0configuration file. If overlapped variables are allowed in the output, they are displayed in red.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#partially-initialized-variable","title":"partially initialized variable","text":"<p>A partially initialized variable has been detected. Wrong stack trace can induce this error, please check the stack pointer.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#too-complex-function","title":"too complex function","text":"<p>The function is too big or too complex. Unfortunately there is nothing the user can do to avoid this error.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#no-license-available","title":"no license available","text":"<p>IDA could not locate your decompiler license.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#only-32-bit-functions-can-be-decompiled-for-the-current-database","title":"only 32-bit functions can be decompiled for the current database","text":"<p>This error message will not currently be displayed.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#only-64-bit-functions-can-be-decompiled-for-the-current-database","title":"only 64-bit functions can be decompiled for the current database","text":"<p>IDA64 can currently decompile only 64-bit functions. To decompile 32-bit functions please use IDA32.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#already-decompiling-a-function","title":"already decompiling a function","text":"<p>An attempt to decompile a function while decompiling another function has been detected. Currently only one function can be decompiled at once.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#far-memory-model-is-supported-only-for-pc","title":"far memory model is supported only for pc","text":"<p>Please check the data and code memory models in the Options, Compiler dialog. If necessary, reset them to 'near' models.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#special-segments-cannot-be-decompiled","title":"special segments cannot be decompiled","text":"<p>The current function belongs to a special segment (e.g. \"extern\" segment). Such segments do not contain any real code, they contain just pointers to imported functions. The function body is located in some other dynamic library. Therefore, there is nothing that we could decompile.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#too-big-function","title":"too big function","text":"<p>The current function is bigger than the maximal permitted size. The maximal permitted size is specified by the\u00a0MAX_FUNCSIZE\u00a0configuration parameter.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#bad-input-range","title":"bad input range","text":"<p>The specified input ranges are wrong. The range vector cannot be empty. The first entry must point to an instruction. Ranges may not overlap. Ranges may not start or end in the middle of an item.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#current-architecture-is-not-supported","title":"current architecture is not supported","text":"<p>The current processor bitness, endianness, or ABI settings in the compiler options are not acceptable. See the current ABI limitations\u00a0here.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#bad-instruction-in-the-delay-slot","title":"bad instruction in the delay slot","text":"<p>Branches and jumps are not allowed in a delay slot. Such instructions signal an exception and cannot be decompiled.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#troubleshooting","title":"Troubleshooting","text":"<p>When the decompiler fails, please check the following things:</p> <ul> <li>the function boundaries. There should not be any wild branches jumping out of function to nowhere. The function should end properly, with a return instruction or a jump to the beginning of another function. If it ends after a call to a non-returning function, the callee must be marked as a\u00a0non-returning\u00a0function.</li> <li>the stack pointer values. Use the\u00a0Options, General, Stack pointer\u00a0command to display them in a column just after the addresses in the disassembly view. If the stack pointer value is incorrect at any location of the function, the decompilation may fail. To correct the stack pointer values, use the\u00a0Edit, Functions, Change stack pointer\u00a0command.</li> <li>the stack variables. Open the stack frame window with the\u00a0Edit, Functions, Stack variables...\u00a0command and verify that the definitions make sense. In some cases creating a big array or a structure variable may help.</li> <li>the function type. The calling convention, the numbers and the types of the arguments must be correct. If the function type is not specified, the decompiler will try to deduce it. In some rare cases, it will fail. If the function expects its input in non-standard registers or returns the result in a non-standard register, you will have to inform the decompiler about it. Currently it makes a good guess about the non-standard input locations but cannot handle non-standard return locations.</li> <li>the types of the called functions and referenced data items. A wrong type can wreak havoc very easily. Use the\u00a0F\u00a0hotkey to display the type of the current item in the message window. For functions, position the cursor on the beginning and hit\u00a0F. If the type is incorrect, modify it with\u00a0Edit, Functions, Set function type\u00a0(the hotkey is\u00a0Y). This command works not only for functions but also for data and structure members.</li> <li>If a type refers to an\u00a0undefined type, the decompilation might fail.</li> <li>use a database created by\u00a0the latest version of IDA.</li> </ul> <p>In some cases the output may contain variables in red. It means that local variable allocation has failed. Please read the page about\u00a0overlapped variables\u00a0for the possible corrective methods.</p> <p>The future versions will have more corrective commands but we have to understand what commands we need.</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA_Failure_Manual/#bugreports","title":"Bugreports","text":"<p>To be useful, the bugreport must contain enough information to reproduce the bug. The\u00a0send database\u00a0command is the preferred way of sending bugreports because it saves all relevant information to the database. Some bugs are impossible to reproduce without this command.</p> <p>The database is sent in the compressed form to save the bandwidth. An SSL connection is used for the transfer.</p> <p>If your database/input file is confidential and you cannot send it, try to find a similar file to illustrate the problem. Thank you.</p> <p>We handle your databases confidentially (as always in the past).</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E4%B8%BB%E9%A2%98/","title":"IDA\u4e3b\u9898","text":"<p>pr701/dp701: Dark theme for IDA Pro (github.com)</p> <p>\u628a <code>/dp701-extra-large/theme.css</code> \u6539\u4e00\u4e0b\uff0c<code>font-size:</code> \u5168\u90e8\u6539\u6210 <code>10px</code> \u5c31\u53ef\u4ee5</p> <p><code>Options -&gt; Colors -&gt; Current Theme -&gt; dp701-extra-large</code></p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/","title":"IDA\u63d2\u4ef6","text":"<p>Keypatch</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#ida","title":"IDA\u7b26\u53f7\u8868\u6062\u590d","text":"<p>\u7b26\u53f7\u8868\u6062\u590d | Antel0p3's blog</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#ida-flair","title":"IDA flair","text":"<p>flair\u901a\u8fc7\u9009\u62e9\u7684\u7b7e\u540d\u6587\u4ef6\u548c\u7a0b\u5e8f\u4e2d\u7684\u51fd\u6570\u8fdb\u884c\u7b7e\u540d\u5339\u914d\u6765\u5e2e\u52a9\u6211\u4eec\u8fd8\u539f\u5e93\u51fd\u6570 \u5176\u4e2d\u7b7e\u540d\u6587\u4ef6\u53ef\u4ee5\u4ecesig-database\u4e2d\u83b7\u53d6\uff0c\u6709\u5236\u4f5c\u597d\u7684\u5404\u67b6\u6784\u5404\u7248\u672c\u7b7e\u540d\u6587\u4ef6</p> <p>\u5df2\u7ecf\u653e\u5728\u4e86 <code>D:\\Documents\\SZPOJP\\IDA\u63d2\u4ef6</code> \u4e0b</p> <p>\u7528<code>DIE</code>\u67e5\u51fa\u6765\u64cd\u4f5c\u7cfb\u7edf\u3001\u7f16\u8bd1\u5668\u7248\u672c\uff08\u5982\u679c\u67e5\u4e0d\u51fa\u6765\uff0c\u5c31\u6bcf\u4e00\u4e2a\u90fd\u8bd5\u4e00\u6b21\uff09</p> <p></p> <p>\u627e\u5230\u5bf9\u5e94\u7684\u7b7e\u540d\u6587\u4ef6\uff0c\u8fd9\u91cc\u662f</p> <pre><code>sig-database\\ubuntu\\libc6\\20.04 (focal)\\amd64\\libc6_2.31-0ubuntu9.4_amd64.sig\n</code></pre> <p>\u590d\u5236\u7b7e\u540d\u6587\u4ef6(sig\u6587\u4ef6)\u5bfc\u5165\u5230IDA\u7684\u5bf9\u5e94\u7b7e\u540d\u76ee\u5f55\u4e0b<code>IDAx.x\\sig\\pc</code></p> <p>IDA\u4e2d\u6309\u4f4f<code>SHIFT+F5</code></p> <p>\u53f3\u952e\u9009\u62e9<code>Apply new signature...</code></p> <p></p> <p>\u9009\u62e9\u7b7e\u540d\u6587\u4ef6\u8fdb\u884c\u5339\u914d</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5f88\u591a\u51fd\u6570\u540d\u5df2\u7ecf\u6062\u590d\uff0c\u4ee3\u7801\u4e5f\u5c31\u597d\u5206\u6790\u591a\u4e86</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#sig","title":"\u624b\u52a8\u7f16\u8bd1sig","text":"<p>\u4f7f\u7528IDA flair\u6062\u590d\u9759\u6001\u7f16\u8bd1\u53bb\u7b26\u53f7\u7684\u5e93\u51fd\u6570\u540d_ida\u5de5\u5177flair70-CSDN\u535a\u5ba2</p> <pre><code>sudo apt install g++\nfind /lib/ -name \"*c++*\"\n</code></pre> <pre><code>/lib/x86_64-linux-gnu/libstdc++.so.6\n/lib/x86_64-linux-gnu/libmpdec++.so.3\n/lib/x86_64-linux-gnu/libstdc++.so.6.0.30\n/lib/x86_64-linux-gnu/libmpdec++.so.2.5.1\n/lib/gcc/x86_64-linux-gnu/11/libstdc++.so\n/lib/gcc/x86_64-linux-gnu/11/libsupc++.a\n/lib/gcc/x86_64-linux-gnu/11/libstdc++fs.a\n/lib/gcc/x86_64-linux-gnu/11/libstdc++.a\n</code></pre> <p>\u770b\u6765\u5c31\u662f <code>libstdc++.a</code></p> <pre><code>./pelf libc.a test.pat\n#\u5982\u679c\u8fd9\u53e5\u8bdd\u62a5\u9519: Unknown relocation type 42 (offset in section=0x16).\u90a3\u4e48\u8981\u52a0\u4e00\u4e2a\u53c2\u6570\uff1a\n./pelf -r42:0:0 libc.a test.pat\n#\u5982\u679c\u6709\u51fa\u73b0\u522b\u7684\u9519\u8bef\uff0c\u7ee7\u7eed\u6dfb\u52a0\u8fd9\u4e2a\u53c2\u6570 -r\u9519\u8bef\u53f7:0:0\n</code></pre> <p>\u7136\u540e\u4f1a\u51fa\u73b0\u4e00\u4e2a <code>test.exec</code> \uff0c\u8fd9\u91cc\u662f\u51b2\u7a81\u4fe1\u606f\uff0c\u540c\u6837\u7684\u7b7e\u540d\u5bf9\u5e94\u4e86\u4e0d\u540c\u7684\u51fd\u6570\u540d\uff0c\u5728\u9700\u8981\u7684\u51fd\u6570\u540d\u524d\u9762\u52a0\u4e0a <code>+</code> \u53f7\uff0c\u7136\u540e\u5220\u6389\u524d\u51e0\u884c\u7684\u6ce8\u91ca</p> <pre><code>./sigmake test.pat test.sig\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#c","title":"C++\u7ffb\u8bd1","text":"<p>oldkingOK/demumblida: Use demumble in ida (github.com)</p> <p>\u628a\u5f62\u4f3c <code>_ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE7compareEPKc</code> \u7684\u51fd\u6570\u540d\u7ffb\u8bd1\u6210\u53ef\u8bfb\u7684\u6587\u672c\uff0c\u5e76\u81ea\u52a8\u6ce8\u91ca</p> <p>\u5feb\u6377\u952e <code>Ctrl Alt D</code></p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#bindiff","title":"Bindiff","text":"<p>\u4eceReleases \u00b7 google/bindiff (github.com) \u4e0b\u8f7d\u5e76\u5b89\u88c5</p> <p>\u7528\u4e8e\u6bd4\u8f83\u4e8c\u8fdb\u5236\u51fd\u6570\u7684\u7b7e\u540d\u7b49\u4fe1\u606f</p> <ol> <li>\u6062\u590d\u7b26\u53f7\u8868</li> <li>\u67e5\u770b\u4e8c\u8fdb\u5236\u7684\u6539\u52a8</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#_1","title":"\u6613\u8bed\u8a00","text":"<p>fjqisba/E-Decompiler: \u7528\u6765\u8f85\u52a9\u5206\u6790\u6613\u8bed\u8a00\u7a0b\u5e8f\u7684IDA\u63d2\u4ef6 (github.com)</p> <p>\u628a E-decompiler \u548c esig \u653e\u8fdb <code>IDA/plugins</code></p> <p>\u9700\u8981patch\u4e00\u4e0bIDA\u548c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4ee5\u652f\u6301\u4e2d\u6587\u51fd\u6570\u540d\uff08\u53c2\u8003\uff1aIDA7.5\u652f\u6301\u4e2d\u6587\u51fd\u6570\u547d\u540d\u7684\u529e\u6cd5 - \u543e\u7231\u7834\u89e3\uff09</p> <p>\u6ce8\u610f\uff1a \u53ea\u6709IDA32\u4f1a\u663e\u793a\u6613\u8bed\u8a00\u63d2\u4ef6</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#_2","title":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<p><code>IDA_Pro_7.5\\cfg\\ida.cfg</code></p> <pre><code>NameChars =\n        \"$?@\"           // asm specific character\n        \"_0123456789\"\n        \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n        \"abcdefghijklmnopqrstuvwxyz\",\n        // This would enable common Chinese characters in identifiers:\n        // Block_CJK_Unified_Ideographs,\n        CURRENT_CULTURE;\n</code></pre> <p>\u628a <code>Block_CJK_Unified_Ideographs</code> \u7684\u6ce8\u91ca\u53d6\u6d88\u6389\u5373\u53ef</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#patch-ida","title":"Patch IDA","text":"<p>\u628a <code>IDA_Pro_7.5\\ida.dll</code> \u6254\u8fdb IDA\uff0c\u641c\u7d22 <code>calc_c_cpp_name</code> \u51fd\u6570</p> <p></p> <p>\u7136\u540e\u628a <code>*v10 = '_'</code> NOP\u6389</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#vscode","title":"\u4e0eVSCode\u8054\u52a8\u8fd0\u884c\u811a\u672c","text":"<p>ioncodes/idacode: An integration for IDA and VS Code which connects both to easily execute and debug IDAPython scripts. (github.com)</p> <p>\u590d\u5236\u5b8c\u4e4b\u540e\uff0c\u9700\u8981\u7f16\u8f91 <code>idacode.py</code>\uff0c\u52a0\u8f7d\u4f9d\u8d56</p> <pre><code># \u5b89\u88c5\u4f9d\u8d56\uff0c\u5728ida\u4e2d\u8f93\u5165\uff1a\n!pip install debugpy tornado\n</code></pre> <p>\u7136\u540e\u8f93\u5165 <code>!pip --version</code> \u663e\u793a <code>site-packages</code> \u7684\u8def\u5f84\uff0c\u6211\u8fd9\u91cc\u662f\uff1a</p> <p><code>D:\\\\Program Files\\\\Python310\\\\lib\\\\site-packages</code></p> <p>\u7136\u540e\u5728 <code>idacode.py</code> \u7684\u6700\u4e0a\u8fb9\u52a0\u4e24\u884c\u4ee3\u7801\uff1a</p> <pre><code>import sys\nsys.path.append('c:\\\\users\\\\mov\\\\appdata\\\\roaming\\\\python\\\\python310\\\\site-packages')\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/IDA%E6%8F%92%E4%BB%B6/#rust","title":"Rust\u5206\u6790","text":"<p>Release First Release \ud83c\udf89 \u00b7 timetravelthree/IDARustDemangler (github.com)</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Pwntools/","title":"Pwntools","text":"<pre><code>pip install pwntools\n</code></pre> <p>\u6216\u8005\u4f7f\u7528docker</p> <pre><code>docker run -d \\\n    --rm \\\n    -h ${ctf_name} \\\n    --name ${ctf_name} \\\n    -v $(pwd)/${ctf_name}:/ctf/work \\\n    -p 23946:23946 \\\n    --cap-add=SYS_PTRACE \\\n    skysider/pwndocker\n</code></pre> <pre><code> # \u76ee\u5f55\u4f5c\u4e3a\u540d\u79f0\n$ctf_name = Split-Path -Leaf (Get-Location);docker run -d --rm -h ${ctf_name} --name ${ctf_name} -v ${pwd}:/ctf/work -v \"D:\\Program Files\\IDA_Pro_v8.3_Portable\\dbgsrv:/root/dbgsrv\" -p 23946:23946 --cap-add=SYS_PTRACE skysider/pwndocker\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/","title":"Python\u5de5\u5177\u548c\u5305","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#pyinstaller","title":"\u89e3\u5305PyInstaller","text":"<ul> <li>Python\u9006\u5411\u2014\u2014Pyinstaller\u9006\u5411-\u8f6f\u4ef6\u9006\u5411-\u770b\u96ea-</li> </ul> <p>serfend/pydumpck</p> <pre><code>pip install pydumpck\npydumpck Py.exe\n</code></pre> <p>\u5373\u53ef\u9012\u5f52\u89e3\u5305\u6240\u6709\u6a21\u5757\u3001\u7a0b\u5e8f</p> <p>\u5df2\u8fc7\u65f6</p> <p>PyInstxtractor\u4e0b\u8f7d \u2014\u2014 github</p> <p>PyCdc\u4e0b\u8f7d \u2014\u2014 github</p> <p>\u4f7f\u7528\u65b9\u6cd5</p> <pre><code>python pyinstxtractor.py Py.exe\n.\\pycdc.exe .\\PyLu.pyc &gt; PyLu.py\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#_1","title":"\u5e38\u7528\u51fd\u6570","text":"<pre><code>n = 123\nhex(n) # 0x7b\nhex(n)[2:] # 7b\nbin(n) # 0b1111011\nchr(n) # {\nord('{') # 123\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#_2","title":"\u683c\u5f0f\u5316\u8f93\u51fa","text":"<pre><code>print(\"{:x} {:x}\".format(12345,123456)) # 3039 1e240\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#crypto","title":"Crypto","text":"<pre><code>pip install pycryptodome z3-solver\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#bytes","title":"bytes\u76f8\u5173","text":"<pre><code>from Crypto.Util.number import bytes_to_long, long_to_bytes\nbytes.fromhex('7b') # b'{'\nbytes([n]).hex() # 7b\nbytearray.fromhex('7bab')\n</code></pre> <p>PyCryptodome\u5b98\u65b9\u6587\u6863</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#_3","title":"\u52a0\u5bc6/\u89e3\u5bc6\u76f8\u5173","text":"<pre><code>from string import printable # \u53ef\u6253\u5370\u5b57\u7b26\u96c6\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#md5","title":"MD5","text":"<pre><code>r = \"HelloWorld\"\nimport hashlib\nprint(hashlib.md5(r.encode()).hexdigest())\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#_4","title":"\u89e3\u65b9\u7a0b","text":"<p>z3\u4e00\u628a\u68ad</p> <p>Introduction | Online Z3 Guide (microsoft.github.io)</p> <pre><code>import z3\nsolver = z3.Solver()\nflag = [z3.Int(\"i_%s\" % (i+1)) for i in range(32)]\nsolver.add()\nprint(solver.check())\nm = solver.model()\nprint(m)\n</code></pre> <p>C++\u7684z3</p> <p>\u53c2\u8003 - Z3\u6c42\u89e3\u5668\u7b80\u4ecb\u53ca\u73af\u5883\u642d\u5efa_z3\u5efa\u6a21\u6c42\u89e3-CSDN\u535a\u5ba2 - opencv - LNK2019: unresolved external symbol error in Visual Studio C++ - Stack Overflow - c++ - What does \"#pragma comment\" mean? - Stack Overflow</p> <ol> <li>Release z3-4.13.0 \u00b7 Z3Prover/z3 (github.com) \u4e0b\u8f7d z3-4.13.0-x64-win.zip</li> <li>\u5728\u9879\u76ee\u4e2d\u6dfb\u52a0\u4e09\u4e2a\u6587\u4ef6\u5939\uff0c\u5206\u522b\u4e3ainclude\u3001lib\u3001bin</li> <li>\u5c06 zip \u4e2d\u7684 <code>include</code> \u6240\u6709\u5934\u6587\u4ef6\u3001<code>libz3.lib</code>\u3001 <code>libz3.dll</code> \u5206\u522b\u653e\u8fdb\u4e0a\u9762\u7684\u6587\u4ef6\u5939</li> <li>\u65b0\u5efaVS c++ \u9879\u76ee\uff0c\u53f3\u952e\u89e3\u51b3\u65b9\u6848\uff0c\u5c5e\u6027<ul> <li>VC++\u76ee\u5f55----&gt;\u5305\u542b\u76ee\u5f55 \u4e0b\u62c9 edit ---&gt; \u6dfb\u52a0 <code>$(ProjectDir)include</code></li> <li>VC++\u76ee\u5f55----&gt;\u5e93\u76ee\u5f55 \u4e0b\u62c9 edit ---&gt; \u6dfb\u52a0 <code>$(ProjectDir)lib</code></li> <li>\u8c03\u8bd5 ---&gt;\u73af\u5883 \u8bbe\u7f6e edit ---&gt; \u6dfb\u52a0 <code>PATH=$(ProjectDir)bin</code></li> <li>Linker ---&gt; General ---&gt; Additional Library Directories ---&gt; \u6dfb\u52a0 <code>$(ProjectDir)lib</code></li> </ul> </li> <li>\u5728cpp\u6e90\u6587\u4ef6\u52a0\u4e0a <code>#pragma comment (lib, \"libz3.lib\")</code></li> </ol> <p>\u4ee3\u7801\u793a\u4f8b z3/examples/c++/example)</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Python%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8C%85/#_5","title":"\u56fe\u5f62\u5904\u7406","text":"<pre><code>pip install opencv-contrib-python easyocr\n</code></pre> <pre><code>import easyocr\n# \u521b\u5efareader\u5bf9\u8c61\nreader = easyocr.Reader(['en'],gpu=False, model_storage_directory=\"./Model\")\u00a0 \u00a0 result = reader.readtext(f'./data2/{i}.jpg')\n</code></pre> <pre><code># \u5bfc\u5165\u6240\u6709\u5fc5\u8981\u7684\u5e93\nimport cv2\nimport os\n\n# \u4ece\u6307\u5b9a\u7684\u8def\u5f84\u8bfb\u53d6\u89c6\u9891\ncam = cv2.VideoCapture( \"./iGotSmokynomial.mp4\" )\n\ntry :\n\n    # \u521b\u5efa\u540d\u4e3adata\u7684\u6587\u4ef6\u5939\n    if not os.path.exists( 'data' ):\n        os.makedirs( 'data' )\n\n# \u5982\u679c\u672a\u521b\u5efa\uff0c\u5219\u5f15\u53d1\u9519\u8bef\nexcept OSError:\n    print ( 'Error: Creating directory of data' )\n\n# frame\ncurrentframe = 0\ncount = 0\n\nwhile ( True ):\n    # reading from frame\n    ret, frame = cam.read()\n\n    if ret:\n        # \u5982\u679c\u89c6\u9891\u4ecd\u7136\u5b58\u5728\uff0c\u7ee7\u7eed\u521b\u5efa\u56fe\u50cf\n        gray_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)\n        white_pixel_count = cv2.countNonZero(gray_frame)\n        total_pixels = frame.shape[0] * frame.shape[1]\n        # \u5199\u5165\u63d0\u53d6\u7684\u56fe\u50cf\n        if white_pixel_count &gt; (0.99 * total_pixels):\n            name = './data/' + str (count) + '.jpg'\n            cv2.imwrite(name, gray_frame)\n            count += 1\n        # \u589e\u52a0\u8ba1\u6570\u5668\uff0c\u4ee5\u4fbf\u663e\u793a\u521b\u5efa\u4e86\u591a\u5c11\u5e27\n        currentframe += 1\n    else :\n        break\n# \u4e00\u65e6\u5b8c\u6210\u91ca\u653e\u6240\u6709\u7684\u7a7a\u95f4\u548c\u7a97\u53e3\ncam.release()\ncv2.destroyAllWindows()\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/x64dbg/","title":"x64dbg","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/x64dbg/#_1","title":"\u63d2\u4ef6","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/x64dbg/#_2","title":"\u53cd\u53cd\u8c03\u8bd5","text":"<p>SharpOD \u53cd\u53cd\u8c03\u8bd5\u63d2\u4ef6 v0.6d</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/x64dbg/#_3","title":"\u5e38\u7528\u5feb\u6377\u952e","text":"<p>\u548cIDA\u5dee\u4e0d\u591a</p> <ul> <li>F9 - \u8fd0\u884c</li> <li>Ctrl F9 - \u8fd0\u884c\u5230\u8fd4\u56de</li> <li>F8 - \u5355\u6b65\u8d8a\u8fc7</li> <li>F7 - \u5355\u6b65\u8fdb\u5165</li> <li>Ctrl F2 - \u91cd\u542f</li> <li>Alt X - \u5173\u95eddbg</li> </ul> <p>\u53f3\u952e\u641c\u7d22\u5b57\u7b26\u4e32\u3001\u547d\u4ee4\u7b49</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/Frida/","title":"Frida","text":"<p>\u770b\u770b\u793a\u4f8b\u811a\u672c</p> <p>Frida basics - Frida HandBook (learnfrida.info)</p> <p>frida/frida-tools: Frida CLI tools (github.com)</p> <pre><code>pip install frida-tools # CLI tools\npip install frida       # Python bindings\nnpm install frida       # Node.js bindings\n</code></pre> <pre><code>Interceptor.attach(ptr(\"0x401AA5\"), {\n    onEnter: function(args) {\n        console.log(\"call \", this.context.rax);\n    }\n});\n</code></pre> <pre><code>console.log(hexdump(ptr(0x401123), {\n            offset: 0,\n            length: 8,\n            header: true,\n            ansi: false\n        }));\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/JS%20API/","title":"JS API","text":"<pre><code>npm install frida-tools frida\n</code></pre> <p>\u5c31\u4f1a\u6709\u4ee3\u7801\u63d0\u793a</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M1%20Welcome/","title":"M1 Welcome","text":"<p>Welcome | Frida \u2022 A world-class dynamic instrumentation toolkit</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M1%20Welcome/#frida","title":"\u4ec0\u4e48\u662f Frida\uff1f","text":"<ul> <li>native app\u7684\u6cb9\u7334\u811a\u672c</li> <li>\u52a8\u6001\u4ee3\u7801\u5de5\u5177\u96c6\uff0c\u628ajs\u6216\u8005\u81ea\u5df1\u7684\u5e93\u63d2\u5165native apps</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M1%20Welcome/#frida_1","title":"\u4e3a\u4ec0\u4e48\u9700\u8981 Frida","text":"<ol> <li>\u8ddf\u8e2aapp\u6240\u4f7f\u7528\u7684API</li> <li>\u6784\u5efa\u4e86\u4e00\u4e2aapp\uff0c\u7528\u6237\u5728\u4f7f\u7528\u7684\u65f6\u5019\u6709bug\uff0c\u4f46\u662f\u65e5\u5fd7\u4e0d\u591f\uff0c\u4f60\u53c8\u53d1\u4e86\u4e2a\u5168\u662f <code>printf</code> \u6253\u5370\u65e5\u5fd7\u7684debug\u7248\u672c\u2014\u2014\u4f7f\u7528Frida\u53ef\u4ee5\u51e0\u884c\u5b8c\u6210\uff0c\u800c\u4e14\u517c\u5bb9\u6027\u597d</li> <li>\u64cd\u7eb5\u7a0b\u5e8f\u4e2d\u51fd\u6570\u7684\u6267\u884c\uff0c\u4e0d\u7136\u5c31\u5f97\u642d\u5efa\u6d4b\u8bd5\u73af\u5883</li> <li>\u5185\u90e8\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u9ed1\u76d2\u6d4b\u8bd5\uff0c\u800c\u65e0\u9700\u5728\u751f\u4ea7\u4ee3\u7801\u4e2d\u52a0\u5165\u4ec5\u7528\u4e8e\u7279\u6b8a\u6d4b\u8bd5\u7684\u903b\u8f91</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M1%20Welcome/#pythonapijs","title":"\u4e3a\u4ec0\u4e48\u4e00\u4e2aPython\u7684API\uff0c\u4f7f\u7528JS\u7684\u8c03\u8bd5\u903b\u8f91\uff1f","text":"<p>Frida \u7684\u5185\u6838\u662f\u7528 C \u8bed\u8a00\u7f16\u5199\u7684\uff0c\u5b83\u5c06 QuickJS \u6ce8\u5165\u76ee\u6807\u8fdb\u7a0b\uff0c\u5728\u76ee\u6807\u8fdb\u7a0b\u4e2d\uff0c JS \u53ef\u4ee5\u5b8c\u5168\u8bbf\u95ee\u5185\u5b58\u3001\u6302\u94a9\u51fd\u6570\uff0c\u751a\u81f3\u8c03\u7528\u8fdb\u7a0b\u5185\u7684\u672c\u5730\u51fd\u6570\u3002Python\u5e94\u7528\u7a0b\u5e8f\u4e0e\u76ee\u6807\u8fdb\u7a0b\u5185\u8fd0\u884c\u7684 JavaScript \u4e4b\u95f4\u6709\u4e00\u4e2a\u53cc\u5411\u901a\u4fe1\u901a\u9053\u3002</p> <p>\u4f7f\u7528 Python \u548c JS \u53ef\u4ee5\u5feb\u901f\u5f00\u53d1\u65e0\u98ce\u9669\u7684 API\u3002Frida \u53ef\u4ee5\u5e2e\u52a9\u60a8\u8f7b\u677e\u6355\u6349 JS \u4e2d\u7684\u9519\u8bef\uff0c\u5e76\u63d0\u4f9b\u5f02\u5e38\u800c\u4e0d\u662f\u5d29\u6e83\u3002</p> <p>\u4e5f\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u8bed\u8a00\uff0c\u751a\u81f3\u76f4\u63a5\u7528C</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M2%20%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/","title":"M2 \u5feb\u901f\u4e0a\u624b","text":"<p>Quick-start guide | Frida \u2022 A world-class dynamic instrumentation toolkit</p> <pre><code>#include &lt;stdio.h&gt;\nint main() {\n    printf(\"Hello, World!\\n\");\n    return 0;\n}\n</code></pre> <pre><code>gcc helloworld.c -o helloworld.o\npip install frida-tools\nfrida-trace -i \"puts\" -f helloworld.o\n</code></pre> <pre><code>\u276f frida-trace -i \"puts\" -f helloworld.o\nInstrumenting...\nputs: Loaded handler at \"/mnt/d/Documents/SZPOJP/__handlers__/libc.so.6/puts.js\"\nHello, World!\nStarted tracing 1 function. Press Ctrl+C to stop.\n           /* TID 0x56e6e */\n    10 ms  puts(s=\"Hello, World!\")\nProcess terminated\n</code></pre> <p>\u6253\u5f00 <code>__handlers__\\libc.so.6\\puts.js</code> \u628a</p> <pre><code>  onEnter(log, args, state) {\n    log(`puts(s=\"${args[0].readUtf8String()}\")`);\n  },\n</code></pre> <p>\u6539\u6210</p> <pre><code>  onEnter(log, args, state) {\n    log(`puts(s=\"${args[0].readUtf8String()}\") rax=${this.context.rax}`);\n  },\n</code></pre> <p>\u518d\u6b21\u8fd0\u884c</p> <pre><code>frida-trace -i \"puts\" -f helloworld.o\n</code></pre> <pre><code>Started tracing 1 function. Press Ctrl+C to stop.\n           /* TID 0x56f9f */\n     8 ms  puts(s=\"Hello, World!\") rax=0x559e0313e004\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M3%20%E5%AE%89%E8%A3%85/","title":"M3 \u5b89\u88c5","text":"<p>Installation | Frida \u2022 A world-class dynamic instrumentation toolkit</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M3%20%E5%AE%89%E8%A3%85/#_1","title":"\u524d\u7f6e","text":"<ul> <li>Python 3.x</li> <li>Windows, macOS or GNU/Linux</li> </ul>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M3%20%E5%AE%89%E8%A3%85/#pip","title":"pip\u5b89\u88c5","text":"<pre><code>pip install frida-tools\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/Frida/M3%20%E5%AE%89%E8%A3%85/#_2","title":"\u68c0\u9a8c\u5b89\u88c5","text":"<pre><code>rpc.exports.test = () =&gt; {\n    return Process.enumerateModules();\n}\n</code></pre> <pre><code>import frida\n\nsession = frida.attach(\"cat\")\nscript = session.create_script(open(\"m3.js\").read())\nscript.on(\"message\", lambda message, data: print(message))\nscript.load()\nprint([m[\"name\"] for m in script.exports.test()])\n</code></pre> <p>\u8fd0\u884c <code>cat</code></p> <pre><code>\u276f python m3.py\n/mnt/d/Documents/SZPOJP/Projects/Frida/m3.py:10: DeprecationWarning: Script.exports will become asynchronous in the future, use the explicit Script.exports_sync instead\n  print([m[\"name\"] for m in script.exports.test()])\n['cat', 'linux-vdso.so.1', 'libc.so.6', 'ld-linux-x86-64.so.2', 'libdl.so.2', 'librt.so.1', 'libm.so.6', 'libpthread.so.0']\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr00-03/","title":"Angr00 03","text":"<pre><code>pip install angr setuptools\n</code></pre> <ul> <li>Angr\u5165\u95e8\uff08\u4e8c\uff09- \u4e00\u4e9bCTF\u7684Angr\u5206\u6790_angr ctf-CSDN\u535a\u5ba2</li> <li>angr - CTF Wiki (ctf-wiki.org)</li> <li>jakespringer/angr_ctf (github.com) \uff08\u5df2\u8fc7\u65f6\uff09</li> <li>ZERO-A-ONE/AngrCTF_FITM</li> <li>CTF-RE \u9898\u7684\u795e\u5668 angr - \u300e\u8131\u58f3\u7834\u89e3\u533a\u300f - \u543e\u7231\u7834\u89e3</li> </ul> <p>\u5b89\u88c5</p> <pre><code>pip install angr\n</code></pre> <p>\u4e0b\u8f7d angr_ctf </p> <pre><code>git clone git@github.com:oldkingOK/AngrCTF_FITM.git\ncd AngrCTF_FITM\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr00-03/#00_angr_find","title":"00_angr_find","text":"<p>\u7528 ipython</p> <pre><code>import angr\nproj = angr.Project(\"00_angr_find\")\ninit_state = proj.factory.entry_state()\nsimulation = proj.factory.simgr(init_state)\nsimulation.explore(find=0x08048678)\n</code></pre> <pre><code>&lt;SimulationManager with 1 active, 16 deadended, 1 found&gt;\n</code></pre> <pre><code>found_state = simulation.found[0]\nfound_state.posix.dumps(0) # \u6807\u51c6\u8f93\u5165\nfound_state.posix.dumps(1) # \u6807\u51c6\u8f93\u51fa\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr00-03/#01_angr_avoid","title":"01_angr_avoid","text":"<p>\u6240\u4ee5\u52a0\u4e00\u4e2aavoid\u53c2\u6570\uff1a</p> <pre><code>simulation.explore(find=0x080485E5, avoid=0x080485A8)\n</code></pre> <p>\u5982\u679c\u4e0d\u52a0avoid\uff0c\u6839\u672c\u8dd1\u4e0d\u51fa\u6765</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr00-03/#02_angr_find_condition","title":"02_angr_find_condition","text":"<p>\u53ef\u4ee5\u4e0d\u6307\u5b9a\u5730\u5740\uff0c\u4ee5\u8f93\u51fa\u6d41\u5224\u65ad</p> <pre><code>def is_good(state):\n    return (b\"Good Job\" in state.posix.dumps(1))\n\ndef is_bad(state):\n    return (b\"Try again\" in state.posix.dumps(1))\n\nsimulation.explore(find=is_good, avoid=is_bad)\nif simulation.found:\n    found_state = simulation.found[0]\n    print(found_state.posix.dumps(0))\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr00-03/#03_angr_symbolic_registers","title":"03_angr_symbolic_registers","text":"<p>\u8001\u7248\u672cangr\u4e0d\u652f\u6301\u8bc6\u522bscanf\uff0c\u73b0\u5728\u652f\u6301\u4e86\u3002</p> <p>\u8fd9\u4e2a\u9898\u76ee\u4fdd\u7559\u4e86\u4e0b\u6765\uff0c\u5bf9\u4e8e\u5b66\u4e60\u7075\u6d3b\u4f7f\u7528angr\u662f\u6709\u5f88\u5927\u5e2e\u52a9\u7684</p> <p>\u5728 <code>user_input</code> \u51fd\u6570</p> <p></p> <p></p> <p>\u7531\u4e8eangr\u4e0d\u652f\u6301scanf\uff0c\u6240\u4ee5\u5f97\u60f3\u529e\u6cd5\u8df3\u8fc7 <code>scanf</code> \u51fd\u6570</p> <p>\u6839\u636e\u8c03\u7528\u7ea6\u5b9a\uff0c\u6700\u540e\u4e00\u4e2a <code>push</code> \u7684\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u628a\u4e09\u4e2a\u6570\u5b58\u5230\u4e86 <code>eax</code> <code>ebx</code> <code>edx</code></p> <p>\u56de\u5230 <code>main</code> \u51fd\u6570</p> <p></p> <p>\u628a\u4e09\u4e2a\u5bc4\u5b58\u5668\u653e\u8fdb\u4e86\u5c40\u90e8\u53d8\u91cf\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece <code>08048980</code> \u5f00\u59cb\u6267\u884c\uff0c\u5c06 eax ebx edx \u4f5c\u4e3a\u7b26\u53f7\u5411\u91cf</p> <p>\u9700\u8981\u6539\u7684\u51e0\u4e2a\u70b9\uff1a</p> <ul> <li><code>proj.factory.blank_state(addr=start_addr)</code> \u6307\u5b9a\u5f00\u59cb\u5730\u5740</li> <li><code>import claripy</code> <code>pass3 = claripy.BVS(\"pass3\", 32) # BitVec</code> \u65b0\u5efa\u7b26\u53f7\u5411\u91cf</li> <li><code>init_state.regs.eax = pass1</code> \u8bbe\u7f6e\u5bc4\u5b58\u5668\u4e3a\u7b26\u53f7\u5411\u91cf\uff08\u7b26\u53f7\u5316\uff09</li> <li><code>password1 = found_state.solver.eval(pass1)</code> \u7b97\u51fa\u7b26\u53f7\u5411\u91cf</li> </ul> <pre><code>import angr\nimport sys\nimport claripy\n\ndef main(argv):\n    bin_path = argv[1]\n    proj = angr.Project(bin_path)\n\n    start_addr = 0x08048980\n    init_state = proj.factory.blank_state(addr=start_addr)\n\n    # \u65b0\u5efa\u7b26\u53f7\u5411\u91cf\n    pass1 = claripy.BVS(\"pass1\", 32) # BitVec Symbol\n    pass2 = claripy.BVS(\"pass2\", 32) # BitVec Symbol\n    pass3 = claripy.BVS(\"pass3\", 32) # BitVec Symbol\n\n    init_state.regs.eax = pass1\n    init_state.regs.ebx = pass2\n    init_state.regs.edx = pass3\n\n    sm = proj.factory.simgr(init_state)\n\n    is_ok = lambda state: b\"Good Job.\" in state.posix.dumps(1)\n    not_ok = lambda state: b\"Try again.\" in state.posix.dumps(1)\n    sm.explore(find=is_ok, avoid=not_ok)\n\n    if sm.found:\n        found_state = sm.found[0]\n\n        password1 = found_state.solver.eval(pass1)\n        password2 = found_state.solver.eval(pass2)\n        password3 = found_state.solver.eval(pass3)\n\n        print(\"Solution is {:x} {:x} {:x}\".format(password1, password2, password3))\n\n    else:\n        print(\"Oh Damn Fuxk !\")\n\nif __name__ == \"__main__\":\n    main(sys.argv)\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr04-06/","title":"Angr04","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr04-06/#04_angr_symbolic_stack","title":"04_angr_symbolic_stack","text":"<p>\u7b26\u53f7\u5316 \u6808</p> <p></p> <p>\u8fd9\u91cc\u4e5f\u662f\u4e24\u4e2a\u53d8\u91cf var_C \u548c var_10\uff0c\u8981\u4ece <code>scanf</code> \u4e4b\u540e\u7684 <code>mov eax, [ebp + var_C]</code> \u5f00\u59cb</p> <p>\u56e0\u4e3a <code>add esp, 10h</code> \u662f\u4e2a\u56de\u6536\u6808\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u4ece <code>08048697</code> \u5f00\u59cb</p> <p>\u8fd9\u91cc\u9700\u8981\u628a\u6808\u7b26\u53f7\u5316</p> <ol> <li><code>init_state.solver.BVS(\"pass1\", 32)</code> \u8fd9\u91cc\u4e0d\u7528claripy\u7684BVS\u4e86\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf</li> <li><code>init_state.stack_push(pass1)</code> \u628a\u5411\u91cf\u63a8\u5165\u6808</li> <li><code>p1 = found_state.solver.eval(pass1)</code> \u8ba1\u7b97\u51fap1</li> </ol> <pre><code>import angr\nimport sys\n\ndef main(argv):\n    bin_path = argv[1]\n    proj = angr.Project(bin_path)\n\n    start_addr = 0x8048697\n    init_state = proj.factory.blank_state(addr=start_addr)\n\n    padding_size = 8\n\n    init_state.stack_push(init_state.regs.ebp)\n    init_state.regs.ebp = init_state.regs.esp\n\n    init_state.regs.esp -= padding_size\n\n    pass1 = init_state.solver.BVS(\"pass1\", 32)\n    pass2 = init_state.solver.BVS(\"pass2\", 32)\n\n    init_state.stack_push(pass1)\n    init_state.stack_push(pass2)\n\n    sm = proj.factory.simgr(init_state)\n    sm.explore(find=0x080486E4)\n\n    if sm.found:\n        found_state = sm.found[0]\n        p1 = found_state.solver.eval(pass1)\n        p2 = found_state.solver.eval(pass2)\n        print(\"{} {}\".format(p1, p2))\n    else:\n        print(\"Oh Damn Fuxk !\")\n\nif __name__ == \"__main__\":\n    main(sys.argv)\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr04-06/#05_angr_symbolic_memory","title":"05_angr_symbolic_memory","text":"<p>\u7b26\u53f7\u5316\u5185\u5b58</p> <ol> <li><code>init_state.memory.store(p1_addr, p1)</code> \u628a\u5411\u91cf\u653e\u5165\u5bf9\u5e94\u5185\u5b58</li> </ol> <pre><code>import angr\nimport sys\n\ndef main(argv):\n    bin_path = argv[1]\n\n    proj = angr.Project(bin_path)\n\n    start_addr = 0x08048601\n    init_state = proj.factory.blank_state(addr=start_addr)\n\n    p1 = init_state.solver.BVS(\"p1\", 64)\n    p2 = init_state.solver.BVS(\"p2\", 64)\n    p3 = init_state.solver.BVS(\"p3\", 64)\n    p4 = init_state.solver.BVS(\"p4\", 64)\n\n    p1_addr = 0xA1BA1C0\n    p2_addr = 0xA1BA1C8\n    p3_addr = 0xA1BA1D0\n    p4_addr = 0xA1BA1D8\n\n    init_state.memory.store(p1_addr, p1)\n    init_state.memory.store(p2_addr, p2)\n    init_state.memory.store(p3_addr, p3)\n    init_state.memory.store(p4_addr, p4)\n\n    sim = proj.factory.simgr(init_state)\n    sim.explore(find=0x804866D) # print good\n\n    if sim.found:\n        found_state = sim.found[0]\n        pass1 = found_state.solver.eval(p1, cast_to=bytes)\n        pass2 = found_state.solver.eval(p2, cast_to=bytes)\n        pass3 = found_state.solver.eval(p3, cast_to=bytes)\n        pass4 = found_state.solver.eval(p4, cast_to=bytes)\n        print(\"{} {} {} {}\".format(pass1.decode(), pass2.decode(),pass3.decode(),pass4.decode()))\n\n    else:\n        print(\"Oh Damn Fuxk!\")\n\nif __name__ == \"__main__\":\n    main(sys.argv)\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/angr/Angr04-06/#06_angr_symbolic_dynamic_memory","title":"06_angr_symbolic_dynamic_memory","text":"<p>\u7b26\u53f7\u5316 \u52a8\u6001\u5185\u5b58</p> <p></p> <p>\u56e0\u4e3a\u4e0d\u786e\u5b9amalloc\u62ff\u5230\u7684\u5185\u5b58\u5728\u54ea\uff0c\u6240\u4ee5\u76f4\u63a5\u8df3\u8fc7malloc\uff0c\u7528angr\u7ed9\u4e00\u5757\u5185\u5b58</p> <p></p> <p>\u4ece <code>08048699</code> \u5f00\u59cb</p> <ul> <li><code>buffer0 = 0x7fff0000 - 0x100</code> \u6307\u5b9a\u6307\u9488</li> <li><code>init_state.memory.store(buffer0_addr, buffer0, endness=proj.arch.memory_endness)</code> \u9ed8\u8ba4\u5927\u7aef\u5199\uff0c\u8fd9\u91cc\u8981\u6307\u5b9a\u5c0f\u7aef\uff1a<code>endness</code></li> </ul> <pre><code>import angr\nimport sys\n\ndef main(argv):\n    bin_path = argv[1]\n\n    start_addr = 0x08048699\n\n    proj = angr.Project(bin_path)\n    init_state = proj.factory.blank_state(addr=start_addr)\n\n    print(f\"ESP: {init_state.regs.esp}\") # 0x7fff0000\n\n    buffer0 = 0x7fff0000 - 0x100\n    buffer1 = 0x7fff0000 - 0x200\n\n    buffer0_addr = 0xABCC8A4\n    buffer1_addr = 0xABCC8AC\n\n    init_state.memory.store(buffer0_addr, buffer0, endness=proj.arch.memory_endness)\n    init_state.memory.store(buffer1_addr, buffer1, endness=proj.arch.memory_endness)\n\n    p1 = init_state.solver.BVS(\"p1\", 64)\n    p2 = init_state.solver.BVS(\"p2\", 64)\n\n    init_state.memory.store(buffer0, p1)\n    init_state.memory.store(buffer1, p2)\n\n    sm = proj.factory.simgr(init_state)\n    sm.explore(find=0x08048759)\n\n    if sm.found:\n        found_state = sm.found[0]\n        pp1 = found_state.solver.eval(p1, cast_to=bytes)\n        pp2 = found_state.solver.eval(p2, cast_to=bytes)\n\n        print(\"{} {}\".format(pp1.decode(), pp2.decode()))\n    else:\n        print(\"Oh Damn Shit!\")\n\nif __name__ == \"__main__\":\n    main(sys.argv)\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/","title":"MacOS\u865a\u62df\u673a","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_1","title":"\u5b8c\u6574\u6559\u7a0b","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#iso","title":"\u4e0b\u8f7dISO","text":"<p>\u9ed1\u82f9\u679c\u7cfb\u7edf\u955c\u50cf-\u9ed1\u82f9\u679c\u661f\u7403 (heipg.cn)</p> <p>\u63a8\u8350\u4e0b\u8f7d 10.15 \u7684\uff0c\u5176\u4ed6\u4eb2\u6d4b\u5f88\u96be\u88c5\u4e0a</p> <p>\u53ef\u4ee5\u7528\u90ae\u7bb1\u767b\u5f55\uff0c\u5df2\u7ecf\u6709\u4f1a\u5458\u4e86</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#unlock","title":"Unlock","text":"<p>Releases \u00b7 paolo-projects/auto-unlocker (github.com)</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_2","title":"\u521b\u5efa\u865a\u62df\u673a","text":"<p>\u9009\u62e9\u201c\u7a0d\u540e\u5b89\u88c5\u201d\uff0c\u7136\u540e\u9009\u62e9\u63d2\u5165\u78c1\u76d8iso</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_3","title":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<p>\u7528vscode\u6253\u5f00 <code>macOS 14.vmx</code></p> <p>\u4fee\u6539</p> <ul> <li><code>board-id.reflectHost = \"FALSE\"</code></li> <li><code>ethernet0.virtualDev = \"vmxnet3\"</code></li> </ul> <p>\u7c98\u8d34</p> <pre><code>board-id = \"Mac-AA95B1DDAB278B95\"  \nhw.model.reflectHost = \"FALSE\"  \nhw.model = \"MacBookPro19,1\"  \nserialNumber.reflectHost = \"FALSE\"  \nserialNumber = \"C01234567890\"\nsmc.version = \"0\"\ncpuid.0.eax = \"0000:0000:0000:0000:0000:0000:0000:1011\"\ncpuid.0.ebx = \"0111:0101:0110:1110:0110:0101:0100:0111\"\ncpuid.0.ecx = \"0110:1100:0110:0101:0111:0100:0110:1110\"\ncpuid.0.edx = \"0100:1001:0110:0101:0110:1110:0110:1001\"\ncpuid.1.eax = \"0000:0000:0000:0001:0000:0110:0111:0001\"\ncpuid.1.ebx = \"0000:0010:0000:0001:0000:1000:0000:0000\"\ncpuid.1.ecx = \"1000:0010:1001:1000:0010:0010:0000:0011\"\ncpuid.1.edx = \"0000:0111:1000:1011:1111:1011:1111:1111\"\nfeatureCompat.enable = \"TRUE\"\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_4","title":"\u53c2\u8003","text":"<ol> <li>Running a MacOS 13 Ventura VM in VMware (i12bretro.github.io)</li> <li>VMware\u5b89\u88c5macOS\u62a5\u5df2\u7981\u7528 CPU \u9519\u8bef - \u77e5\u4e4e (zhihu.com)</li> <li>\u5728 Windows \u4e0b\u4f7f\u7528 VMware Workstation \u5b89\u88c5 macOS \u7684\u8be6\u7ec6\u6559\u7a0b-\u9ed1\u82f9\u679c\u661f\u7403 (heipg.cn)</li> </ol>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_5","title":"\u4f18\u5316","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#_6","title":"\u4f18\u5316\u4e09\u90e8\u66f2","text":""},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#app","title":"\u5b89\u88c5\u4efb\u610f\u6765\u6e90APP","text":"<pre><code>sudo spctl --master-disable\n</code></pre> <p>\u9ed1\u82f9\u679c\u4f18\u5316\u4e09\u90e8\u66f2\uff1a\u65f6\u95f4\u540c\u6b65/\u53bb\u9664\u8dd1\u7801\u6a21\u5f0f/\u5b89\u88c5\u4efb\u610f\u6765\u6e90APP - \u77e5\u4e4e (zhihu.com)</p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/MacOS/#share","title":"Share\u6587\u4ef6\u5939","text":"<p>\u8fb9\u5b66\u8fb9\u5e72\u6298\u817e\u8bb0\u2014\u2014VMware\u865a\u62df\u5316\u8f6f\u4ef6+MacOS\u865a\u62df\u673a+\u661f\u7a7a\u7ec4\u7f512/2 - \u77e5\u4e4e (zhihu.com)</p> <pre><code>sh -c \"$(curl -fsSL https://html.sqlsec.com/hidpi.sh)\"\n</code></pre>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/QemuSystem%E7%9A%84%E9%85%8D%E7%BD%AE/","title":"QemuSystem\u7684\u914d\u7f6e","text":"<p>Boot ARM64 virtual machines on QEMU | Ubuntu</p> <p>\u4f7f\u7528QEMU\u914d\u7f6e\u9f99\u82af\u65b0\u4e16\u754c\u73af\u5883 - \u77e5\u4e4e (zhihu.com)</p> <p>\u5efa\u8bae\u4e0d\u8981\u4f7f\u7528wsl\uff0c\u4f1a\u6709==\u5947\u602a\u7684\u3001\u65e0\u6cd5\u89e3\u51b3==\u7684\u7f51\u7edc\u95ee\u9898\uff0c\u7528Windows\u7684\u5c31\u884c\uff08msys2 UCRT64\uff09</p> <pre><code>sudo apt install qemu-system-loongarch64\n# \u7f51\u7edc\u4e0d\u597d\u8bb0\u5f97\u6362\u8282\u70b9\n</code></pre> <p>\u5728\u5317\u5927\u6e90\u4e0b\u8f7d\u955c\u50cf</p> <p>\u6587\u4ef6-\u5317\u4eac\u5927\u5b66\u5f00\u6e90\u955c\u50cf\u7ad9 (pku.edu.cn)</p> <ul> <li>images/QEMU_EFI_8.1.fd</li> <li>iso/latest/archlinux-loong64.iso</li> </ul> <pre><code>mkdir -p ~/VMs/loongarch/\nqemu-img create -f qcow2 ~/VMs/loongarch/archlinux-loongarch-test.qcow2 20G\n</code></pre> <pre><code>qemu-system-loongarch64 \\\n    -m 5G \\\n    -cpu la464-loongarch-cpu \\\n    -machine virt \\\n    -smp 4 \\\n    -bios ~/VMs/loongarch/QEMU_EFI_8.1.fd \\\n    -serial stdio \\\n    -device virtio-gpu-pci \\\n    -net user -net nic \\\n    -device nec-usb-xhci,id=xhci,addr=0x1b \\\n    -device usb-tablet,id=tablet,bus=xhci.0,port=1 \\\n    -device usb-kbd,id=keyboard,bus=xhci.0,port=2 \\\n    -hda ~/VMs/loongarch/archlinux-loongarch-test.qcow2 \\\n    -cdrom ~/archlinux-2024.03.30-loong64.iso \\\n    -boot once=d\n</code></pre> <p>\u7b49\u5f85</p> <ol> <li>\u78c1\u76d8\u9700\u8981\u914d\u7f6e\uff0c\u5efa\u8bae\u4f7f\u7528ext4</li> <li>\u7f51\u7edc\u9700\u8981\u3010\u624b\u52a8\u914d\u7f6e\u3011\uff0c\u4e00\u76f4\u9ed8\u8ba4\u5373\u53ef</li> </ol> <pre><code>pacman -S neofetch vim sudo networkmanager zsh openssh\n</code></pre> <p></p>"},{"location":"%E9%80%86%E5%90%91%E5%B7%A5%E5%85%B7/%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/QemuSystem%E7%9A%84%E9%85%8D%E7%BD%AE/#ssh","title":"\u914d\u7f6e ssh","text":"<pre><code>systemctl status sshd # \u5982\u679c inactive\nsystemctl start sshd\nsystemctl\u00a0enable\u00a0sshd # \u8bbe\u7f6e\u81ea\u52a8\u542f\u52a8\nip\u00a0a # \u83b7\u53d6ip\n</code></pre>"},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/reverse/","title":"Reverse","text":""},{"location":"blog/category/hello/","title":"Hello","text":""},{"location":"blog/category/world/","title":"World","text":""}]}